{"version":3,"sources":["containers/report-version-comparison/utils.ts","containers/report-version-comparison/report-version-comparison.tsx"],"names":["compose","require","parseReport","list","join","map","key","equals","__","length","pathOr","questions","mapIndexed","idx","setting","s","inline","div","document","createElement","innerHTML","replace","textContent","innerText","hasPath","o","text","keys","Diff","Diff2html","ReportVersionComparison","useTitle","useBreadcrumb","name","useForm","form","latestItem","useReportItem","previousItem","latestList","useReportTemplate","data","snippetList","previousList","diffHtml","html","createTwoFilesPatch","inputFormat","showFiles","drawFileList","matching","outputFormat","md","xs","className","Item","label","color","gutter","span","readOnly","bordered","value","dangerouslySetInnerHTML","__html"],"mappings":"gcAKQA,EAAYC,EAAQ,IAApBD,QAED,SAASE,EAAYC,GA0C1B,MAzCU,YACVH,EACAI,YAAK,IACLC,aAAI,SAACC,GACH,GAAIN,EAAQO,YAAOC,IAAI,GAAIC,IAAQC,YAAO,GAAI,CAACJ,IAA3CN,CAAkDG,GACpD,MAAM,KAAN,OACJG,EADI,YAKF,IAAIK,EAAS,YACfX,EACAI,YAAK,MACLQ,aAAW,WAAkCC,GAAiB,IAAhDC,EAA+C,EAA/CA,QAAYC,EAAmC,2BAC3D,GAAIA,EAAEC,OAAQ,CACZ,IAAMC,EAAMC,SAASC,cAAc,OAEnC,OADAF,EAAIG,UAAYpB,EAAQqB,YAAQ,YAAa,IAAKX,YAAO,GAAI,CAAC,SAA9CV,CAAwDe,GAClE,IAAN,OAAWF,EAAM,EAAjB,aAAuBI,EAAIK,aAAeL,EAAIM,WAAa,GAA3D,MAEF,OAAIC,YAAQ,CAAC,WAATA,CAAqBV,GAChBd,EACLI,YAAK,MACLC,aAAI,SAACoB,GAAD,uBAAoBA,EAAEC,SAC1BhB,YAAO,GAAI,CAAC,YAHPV,CAILc,GAEE,IAAN,OAAWD,EAAM,EAAjB,aAAuBC,EAAQY,MAAQ,qCAEzChB,YAAO,GAAI,CAACJ,IAjBZN,CAkBAG,GAnBe,YAsBb,MAAM,KAAN,OACFG,EADE,aAEFK,EAFE,eAKFgB,IApCA3B,CAqCAG,GAtCU,UCGZ,IAAMyB,EAAO3B,EAAQ,MACf4B,EAAY5B,EAAQ,MAEX,SAAS6B,IACtBC,YAAS,4BAETC,YAAc,CAAC,CAAEC,KAAM,4BAAU,CAAEA,KAAM,8BAHO,MAKjC,IAAKC,UAAbC,EALyC,oBAS1CC,EAAaC,YAAc,wCAC3BC,EAAeD,YAAc,wCAEdE,EAAeC,YAAkB,CAAEC,KAAML,IAAtDM,YACaC,EAAiBH,YAAkB,CACtDC,KAAMH,IADAI,YAIFE,EAAWf,EAAUgB,KACzBjB,EAAKkB,oBACH,OACA,OACA5C,EAAYyC,GACZzC,EAAYqC,IAEd,CACEQ,YAAa,OACbC,WAAW,EACXC,cAAc,EACdC,SAAU,QACVC,aAAc,iBAIlB,OACE,kBAAC,IAAD,KACE,uBAAMhB,KAAMA,GACV,2BACE,uBAAKiB,GAAI,GAAIC,GAAI,IACf,yBAAKC,UAAU,qDACb,wBAAIA,UAAU,uBAAd,4BACA,uBAASA,UAAU,oBACnB,yBAAKA,UAAU,QACb,sBAAMC,KAAN,CAAWC,MAAM,2BAAOF,UAAU,SAChC,kBAAC,IAAD,CAAOA,UAAU,yBAEnB,kBAAC,IAAD,CAAQG,MAAM,UAAUH,UAAU,QAAlC,gBAGA,kBAAC,IAAD,CAAQG,MAAM,UAAUH,UAAU,QAAlC,oBAOR,2BACE,uBAAKF,GAAI,GAAIC,GAAI,IACf,yBAAKC,UAAU,gDACb,wBAAIA,UAAU,uBAAd,4BACA,uBAASA,UAAU,oBACnB,uBAAKI,OAAQ,IACX,uBAAKC,KAAM,IACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,IACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,YAI9C,uBAAKJ,OAAQ,IACX,uBAAKC,KAAM,IACT,sBAAMJ,KAAN,CAAWC,MAAM,sBACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,IACT,sBAAMJ,KAAN,CAAWC,MAAM,sBACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,eAOpD,2BACE,uBAAKH,KAAM,IACT,yBAAKL,UAAU,qDACb,wBAAIA,UAAU,uBAAd,4BACA,uBAASA,UAAU,oBAFrB,sDAOJ,2BACE,uBAAKK,KAAM,IACT,yBAAKL,UAAU,wCACb,wBAAIA,UAAU,uBAAd,wCACA,uBAASA,UAAU,oBACnB,uBAAKI,OAAQ,IACX,uBAAKC,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,YAI9C,uBAAKJ,OAAQ,IACX,uBAAKC,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,cAMlD,uBAAKH,KAAM,IACT,yBAAKL,UAAU,wCACb,wBAAIA,UAAU,uBAAd,wCACA,uBAASA,UAAU,oBACnB,uBAAKI,OAAQ,IACX,uBAAKC,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,YAI9C,uBAAKJ,OAAQ,IACX,uBAAKC,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,WAG5C,uBAAKH,KAAM,GACT,sBAAMJ,KAAN,CAAWC,MAAM,4BACf,kBAAC,IAAD,CAAOI,UAAQ,EAACC,UAAU,EAAOC,MAAO,eAOpD,2BACE,uBAAKH,KAAM,IACT,yBAAKL,UAAU,YACb,wBAAIA,UAAU,iCAAd,wCACA,yBAAKS,wBAAyB,CAAEC,OAAQpB","file":"static/js/18.f1a99347.chunk.js","sourcesContent":["import { pathOr, keys, map, equals, length, __, join, replace } from 'ramda'\nimport { mapIndexed, hasPath } from '@/utils/webHelper'\nimport { SnippetProps, Snippets } from '@/constants/types'\nimport { Option } from '@/components/snippet-template-selection-modal'\n\nconst { compose } = require('ramda')\n\nexport function parseReport(list: Snippets) {\n  let output = `\n${compose(\n  join(''),\n  map((key: string) => {\n    if (compose(equals(__, 0), length, pathOr([], [key]))(list)) {\n      return `\n${key}\n      `\n    }\n\n    let questions = `\n${compose(\n  join('\\n'),\n  mapIndexed(({ setting, ...s }: SnippetProps, idx: number) => {\n    if (s.inline) {\n      const div = document.createElement('div')\n      div.innerHTML = compose(replace(/\\r?\\n|\\r/g, ''), pathOr('', ['html']))(s)\n      return ` ${idx + 1}. ${div.textContent || div.innerText || ''}\\n`\n    }\n    if (hasPath(['options'])(setting)) {\n      return compose(\n        join('\\n'),\n        map((o: Option) => ` ・${o.text}`),\n        pathOr([], ['options'])\n      )(setting)\n    }\n    return ` ${idx + 1}. ${setting.text || '未輸入題目'}`\n  }),\n  pathOr([], [key])\n)(list)}\n      `\n\n    return `\n${key}\n${questions}\n      `\n  }),\n  keys\n)(list)}\n    `\n\n  return output\n}\n","import React from 'react'\nimport { Form, Row, Col, Divider } from 'antd'\nimport useTitle from '@/hooks/useTitle'\nimport { useBreadcrumb } from '@/hooks/useApp'\nimport { Page } from '@/components/layout'\nimport Button from '@/components/button'\nimport Input from '@/components/input'\nimport { useReportItem } from '@/services/report'\nimport { useReportTemplate } from '@/services/reportTemplate'\nimport { parseReport } from './utils'\n\nconst Diff = require('diff')\nconst Diff2html = require('diff2html')\n\nexport default function ReportVersionComparison() {\n  useTitle('版本比較')\n\n  useBreadcrumb([{ name: '清單查詢' }, { name: '版本比較' }])\n\n  const [form] = Form.useForm()\n\n  // const [keyword, setKeyword] = React.useState<string>()\n\n  const latestItem = useReportItem('a95006d8-4b65-48ba-9cb2-20e994bca84b')\n  const previousItem = useReportItem('fc12c07e-7d1d-4cb9-938f-32b758285018')\n\n  const { snippetList: latestList } = useReportTemplate({ data: latestItem })\n  const { snippetList: previousList } = useReportTemplate({\n    data: previousItem,\n  })\n\n  const diffHtml = Diff2html.html(\n    Diff.createTwoFilesPatch(\n      'file',\n      'file',\n      parseReport(previousList),\n      parseReport(latestList)\n    ),\n    {\n      inputFormat: 'diff',\n      showFiles: false,\n      drawFileList: false,\n      matching: 'lines',\n      outputFormat: 'side-by-side',\n    }\n  )\n\n  return (\n    <Page>\n      <Form form={form}>\n        <Row>\n          <Col md={24} xs={24}>\n            <div className=\"p-4 px-6 pb-6 mb-3 rounded-lg shadow-2xl bg-white\">\n              <h2 className=\"text-lg font-normal\">版本比較</h2>\n              <Divider className=\"w-1/2 my-2 mb-4\" />\n              <div className=\"flex\">\n                <Form.Item label=\"申請序號\" className=\"w-1/3\">\n                  <Input className=\"inline-block w-full\" />\n                </Form.Item>\n                <Button color=\"primary\" className=\"ml-6\">\n                  送出\n                </Button>\n                <Button color=\"outline\" className=\"ml-6\">\n                  重設\n                </Button>\n              </div>\n            </div>\n          </Col>\n        </Row>\n        <Row>\n          <Col md={24} xs={24}>\n            <div className=\"p-4 px-6 mb-3 rounded-lg shadow-2xl bg-white\">\n              <h2 className=\"text-lg font-normal\">醫囑內容</h2>\n              <Divider className=\"w-1/2 my-2 mb-4\" />\n              <Row gutter={16}>\n                <Col span={12}>\n                  <Form.Item label=\"申請序號\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={12}>\n                  <Form.Item label=\"病患姓名\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n              </Row>\n              <Row gutter={16}>\n                <Col span={12}>\n                  <Form.Item label=\"病理號\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={12}>\n                  <Form.Item label=\"病歷號\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n              </Row>\n            </div>\n          </Col>\n        </Row>\n        <Row>\n          <Col span={24}>\n            <div className=\"p-4 px-6 mb-3 pb-6 rounded-lg shadow-2xl bg-white\">\n              <h2 className=\"text-lg font-normal\">比對結果</h2>\n              <Divider className=\"w-1/2 mt-4 mb-4\" />\n              比對報告內容相同\n            </div>\n          </Col>\n        </Row>\n        <Row>\n          <Col span={12}>\n            <div className=\"p-4 px-6 pb-6 rounded-tl-lg bg-white\">\n              <h2 className=\"text-lg font-normal\">最新版本報告</h2>\n              <Divider className=\"w-1/2 mt-4 mb-4\" />\n              <Row gutter={12}>\n                <Col span={8}>\n                  <Form.Item label=\"輸入人員\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"審核醫師\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"輸入時間\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n              </Row>\n              <Row gutter={12}>\n                <Col span={8}>\n                  <Form.Item label=\"複審人員\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"複審醫師\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"複審時間\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n              </Row>\n            </div>\n          </Col>\n          <Col span={12}>\n            <div className=\"p-4 px-6 pb-6 rounded-tr-lg bg-white\">\n              <h2 className=\"text-lg font-normal\">比較版本報告</h2>\n              <Divider className=\"w-1/2 mt-4 mb-4\" />\n              <Row gutter={12}>\n                <Col span={8}>\n                  <Form.Item label=\"輸入人員\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"審核醫師\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"輸入時間\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n              </Row>\n              <Row gutter={12}>\n                <Col span={8}>\n                  <Form.Item label=\"複審人員\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"複審醫師\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n                <Col span={8}>\n                  <Form.Item label=\"複審時間\">\n                    <Input readOnly bordered={false} value={'xxxx'} />\n                  </Form.Item>\n                </Col>\n              </Row>\n            </div>\n          </Col>\n        </Row>\n        <Row>\n          <Col span={24}>\n            <div className=\"bg-white\">\n              <h2 className=\"pl-6 mb-6 text-lg font-normal\">報告比對結果</h2>\n              <div dangerouslySetInnerHTML={{ __html: diffHtml }} />\n            </div>\n          </Col>\n        </Row>\n      </Form>\n    </Page>\n  )\n}\n"],"sourceRoot":""}
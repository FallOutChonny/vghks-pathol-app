(this["webpackJsonpvghks-pathol-app"]=this["webpackJsonpvghks-pathol-app"]||[]).push([[12],{1135:function(e,t,a){"use strict";a.d(t,"e",(function(){return O})),a.d(t,"d",(function(){return v})),a.d(t,"c",(function(){return j})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return h}));var n=a(3),r=a(11),c=a(0),o=a.n(c),i=(a(272),a(104),a(44)),l=a(414),d=a(29),u=(a(79),a(111)),s=a(204),m=a(18),b=a(22),p=a(37),f=a(27).compose;function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.division,a=(void 0===t&&b.a.PATH,Object(r.a)(e,["division"])),c=Object(p.b)(),o=c.user,i=Object(u.a)("/api/v1/c2/getC2DoctorList/{division}",{variables:Object(n.a)({division:o.division},a)}),d=i.data,s=void 0===d?[]:d,m=Object(r.a)(i,["data"]),f=null===s||void 0===s?void 0:s.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{id:e.doctorId})})),O={};return Object(l.a)((function(e){return O[e.doctorId]=e}),f),Object(n.a)(Object(n.a)({},m),{},{doctorById:O,data:f,doctorEnums:f})}function v(e){var t=O(),a=t.data,n=t.loading;return o.a.createElement(s.a,Object.assign({disabled:n,loading:n},e),f(Object(d.a)((function(e){return o.a.createElement(s.a.Option,{key:e.id,value:e.doctor},e.doctor)})),Object(i.a)([],[]))(a))}function j(e){var t=function(){var e=Object(u.a)("/api/v1/b1/getBodyParts"),t=e.data,a=void 0===t?[]:t,c=Object(r.a)(e,["data"]),o=null===a||void 0===a?void 0:a.map((function(e){return{id:Object(m.n)(),name:e}}));return Object(n.a)(Object(n.a)({},c),{},{data:o})}().data;return o.a.createElement(s.a,e,t.map((function(e){return o.a.createElement(s.a.Option,{key:e.id,value:e.name},e.name)})))}function g(e){var t=function(){var e=Object(u.a)("/api/v1/b1/getWards"),t=e.data,a=void 0===t?[]:t,c=Object(r.a)(e,["data"]),o=null===a||void 0===a?void 0:a.map((function(e){return{id:Object(m.n)(),name:e}}));return Object(n.a)(Object(n.a)({},c),{},{data:o})}().data;return o.a.createElement(s.a,e,t.map((function(e){return o.a.createElement(s.a.Option,{key:e.id,value:e.name},e.name)})))}function h(e){var t=function(){var e=Object(u.a)("/api/v1/b1/getAppointmentTypes"),t=e.data,a=void 0===t?[]:t,c=Object(r.a)(e,["data"]),o=null===a||void 0===a?void 0:a.map((function(e){return{id:Object(m.n)(),name:e}}));return Object(n.a)(Object(n.a)({},c),{},{data:o})}().data;return o.a.createElement(s.a,e,t.map((function(e){return o.a.createElement(s.a.Option,{key:e.id,value:e.name},e.name)})))}},1138:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(127),o=a(211),i=a(36),l=a(49),d=a(45),u=a(46),s=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),a}(r.a.Component),m=a(163),b={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"};function p(e){var t=e.initialOffset,a=e.currentOffset;if(!t||!a)return{display:"none"};var n=a.x,r=a.y,c="translate(".concat(n,"px, ").concat(r,"px)");return{transform:c,WebkitTransform:c}}t.a=Object(c.DragLayer)((function(e){return{item:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}}))((function(e){var t=e.itemType,a=e.isDragging,n=e.currentOffset;if(!a)return null;if(!n)return null;var c=document.elementFromPoint(n.x,n.y),i=!1;return c&&(i=Object(m.a)(c)),r.a.createElement("div",{className:"report-template-builder__drag-layer",style:b},r.a.createElement("div",{style:p(e)},function(e){var a=e.canDrop;switch(t){case o.a.BOARD:case o.a.SNIPPET:return r.a.createElement(s,{canDrop:a});default:return null}}({canDrop:i})))}))},1201:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return ve}));a(432);var n=a(345),r=a.n(n),c=(a(201),a(64)),o=a.n(c),i=(a(100),a(20)),l=a.n(i),d=(a(202),a(41)),u=a.n(d),s=a(74),m=a(67),b=a(11),p=(a(346),a(125)),f=a.n(p),O=a(3),v=a(9),j=(a(440),a(310)),g=a.n(j),h=a(0),y=a.n(h),E=a(102),D=a.n(E),x=a(414),k=a(44),N=a(309),w=a(94),C=a(131),I=a(29),S=a(434),P=a(170),T=a(436),Y=a(433),_=a(61),M=a(1138),z=a(435),A=a(189),B=a(42),R=a(111),L=a(79),q=a(18),F=a(27).compose;var H=a(1135),J=a(36),W=a(49),G=a(45),K=a(46),Q=a(127),U=a(587),V="CARD",X=Object(Q.DragSource)(V,{beginDrag:function(e){return Object(O.a)({},e.item)},canDrag:function(){return!0}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(function(e){Object(G.a)(a,e);var t=Object(K.a)(a);function a(){var e;Object(J.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){var t=e.props.connectDragPreview;t&&t(Object(U.a)())},e}return Object(W.a)(a,[{key:"render",value:function(){var e=this.props,t=e.item,a=e.className,n=e.style,r=e.connectDragSource,c=void 0===r?function(e){return e}:r,o=e.connectDragPreview,i=void 0===o?function(e){return e}:o,l=e.isDragging,d=Object(O.a)(Object(O.a)({},n),{},{border:"1px ".concat(l?"dashed":"solid"," #ddd")});return c(i(y.a.createElement("div",{key:t.id,className:a,style:d},"\u91ab\u5e2b ",t.doctor)))}}]),a}(y.a.Component)),Z=a(4),$=a.n(Z),ee=a(1104),te=a(12),ae=a(446),ne=a(416),re=a(157),ce=a(81),oe=a(135),ie=a(340),le=a(419),de=a(27).compose,ue=te.d.div.attrs({className:"px-6 py-4 block-placeholder"}).withConfig({displayName:"image-scheduler-calendar__BlockPlaceHolder",componentId:"sc-11y9ykq-0"})(["display:flex;align-items:center;border:rgba(225,225,225,0.9) 2px dashed;background-color:transparent;"]),se=Object(Q.DropTarget)(V,{drop:function(e,t,a){var n=e.index,r=t.getItem();a.handleDoctorDrop(r,n)},canDrop:function(e,t){var a=e.doctors,n=t.getItem();return Object(ae.a)([de(Object(ne.a)(re.a,2),ce.a),de(oe.a,Object(ie.a)(Object(le.a)("id",n.id)))])(a)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),didDrop:t.didDrop(),draggingItem:t.getItem()}})),me=Object(te.d)("div").withConfig({displayName:"image-scheduler-calendar___StyledDiv",componentId:"sc-11y9ykq-1"})((function(e){return{height:e._css,marginBottom:"0.1rem"}})),be=function(e){Object(G.a)(a,e);var t=Object(K.a)(a);function a(){var e;Object(J.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleDoctorDrop=function(t,a){e.props.onDoctorDrop(Object(O.a)(Object(O.a)({},t),{},{index:a}))},e.handleDoctorRemove=function(t){return function(){e.props.onDoctorRemove(t)}},e}return Object(W.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.connectDropTarget,n=t.isOver,r=t.canDrop,c=t.doctors,o=void 0===c?[]:c,i=t.className,l=t.style,d="".concat(100/(o.length>0?2:1),"%");return a(y.a.createElement("div",{className:$()("w-full",i),style:Object(O.a)({height:"100%"},l)},o.map((function(t){return y.a.createElement(me,{key:"scheduled-doctor-".concat(t.id),className:"bg-login-cyan text-white flex items-center justify-center px-6 py-4 relative",_css:d},y.a.createElement("div",null,t.doctor,y.a.createElement(ee.a,{onClick:e.handleDoctorRemove(t),style:{position:"absolute",right:5,top:9,fontSize:12,cursor:"pointer"}})))})),n&&r&&y.a.createElement(ue,{style:{height:d}})))}}]),a}(y.a.Component),pe=de(se)(be),fe=a(27).compose,Oe=g.a.MonthPicker;function ve(){Object(S.a)("\u5f71\u50cf\u6392\u73ed"),Object(P.a)([{name:"\u5f71\u50cf\u6392\u73ed"}]);var e=Object(T.a)("/"),t=y.a.useState(D()()),a=Object(v.a)(t,2),n=a[0],c=a[1],i=y.a.useState({}),d=Object(v.a)(i,2),p=d[0],j=d[1],g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.lazy,a=e.onCompleted,n=e.onError,r=Object(b.a)(e,["lazy","onCompleted","onError"]),c=Object(R.a)("/api/v1/d1/getDoctorShift/{date}",{variables:r,onCompleted:a,onError:n,lazy:t}),o=c.data,i=Object(b.a)(c,["data"]),l={};return F(Object(x.a)((function(e){l[e.date]?l[e.date].push(e):l[e.date]=[e]})),Object(k.a)([],[]))(o),Object(O.a)(Object(O.a)({},i),{},{shiftById:l,data:o})}({date:n.format("YYYY-MM"),lazy:!0,onCompleted:function(e){var t={};fe(Object(x.a)((function(e){var a=Object(O.a)(Object(O.a)({},e),{},{id:"".concat(e.date).concat(e.period),index:e.date});t[e.date]?t[e.date].push(a):t[e.date]=[a]})),Object(k.a)([],[]))(e),j(t)}}),h=g.refetch,E=g.loading,J=g.called,W=g.revalidate,G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(L.e)("/api/v1/d1/createShift",Object(O.a)(Object(O.a)({},e),{},{method:"POST"})),a=t.loading,n=t.mutate,r=function(e){var t=F(A.a,Object(I.a)((function(t){return F(Object(q.f)((function(a,n){return{date:+t,year_month:e.date.format("YYYY-MM"),period:0===n?"00:00~1200":"12:00~24:00",doctor:a.doctor}})),Object(k.a)([],["doctorList",t]))(e)})),B.a,Object(k.a)({},["doctorList"]))(e);return n(t)};return[a,r]}({onCompleted:function(e){W(),f.a.success("\u5132\u5b58\u6210\u529f")}}),K=Object(v.a)(G,2),Q=K[0],U=K[1];Object(P.c)(y.a.createElement("div",{className:"inline-flex"},y.a.createElement(_.a,{color:"outline",className:"ml-6 bg-transparent text-white border-white",onClick:function(){U({date:n,doctorList:p})}},"\u5132\u5b58"),y.a.createElement(_.a,{color:"outline",className:"ml-6 bg-transparent text-white border-white",onClick:e},"\u653e\u68c4")));var V=Object(H.e)().doctorEnums,Z=function(e){var t=e.index,a=Object(b.a)(e,["index"]);j((function(e){var n=Object(k.a)([],[t])(e);return Object(O.a)(Object(O.a)({},e),{},Object(s.a)({},t,[].concat(Object(m.a)(n),[Object(O.a)({index:t},a)])))}))},$=function(e){var t=e.index,a=Object(b.a)(e,["index"]);j((function(e){var n=Object(k.a)([],[t])(e);return Object(O.a)(Object(O.a)({},e),{},Object(s.a)({},t,n.filter((function(e){return e.id!==a.id}))))}))},ee=[];return fe(Object(x.a)((function(e){ee.push(y.a.createElement(u.a,{key:"calendar-".concat(e),span:3},y.a.createElement("div",{className:"py-4 bg-gray-300 text-center"},n.month()+1,"/",e+1),y.a.createElement("div",{className:"h-20 border border-gray-300"},y.a.createElement(pe,{index:e,doctors:Object(k.a)([],[e])(p),onDoctorDrop:Z,onDoctorRemove:$}))))})),Object(N.a)(w.a),Object(C.a)(0,"daysInMonth")())(n),y.a.createElement(z.a,null,y.a.createElement(M.a,null),y.a.createElement(r.a,{spinning:E||Q},y.a.createElement(Y.a,null,y.a.createElement(o.a,{className:"mb-6"},y.a.createElement(u.a,{span:24},y.a.createElement("div",{className:"rounded-xl p-4 bg-white"},y.a.createElement(l.a,{layout:"inline",colon:!1},y.a.createElement(l.a.Item,{label:"\u6392\u73ed\u5e74\u6708"},y.a.createElement(Oe,{allowClear:!1,value:n,onChange:function(e){e&&c(e)}})),y.a.createElement(_.a,{color:"primary",className:"ml-4",onClick:function(){h({date:n.format("YYYY-MM")})}},"\u67e5\u8a62"))))),J&&y.a.createElement(y.a.Fragment,null,y.a.createElement(o.a,{className:"mb-6"},y.a.createElement(u.a,{span:24},y.a.createElement("h2",{className:"text-base font-normal"},"\u91ab\u5e2b\u5217\u8868"),y.a.createElement("div",{className:"bg-white rounded-xl p-4"},y.a.createElement(o.a,{gutter:8},Object(I.a)((function(e){return y.a.createElement(u.a,{span:3,key:e.id},y.a.createElement(X,{draggable:!0,item:e,className:"bg-login-cyan text-white flex items-center justify-center px-6 py-4 mb-2 cursor-move"}))}),V))))),y.a.createElement(o.a,null,y.a.createElement(u.a,{span:24},y.a.createElement("h2",{className:"text-base font-normal"},"\u6392\u73ed\u5217\u8868"),y.a.createElement("div",{className:"bg-white rounded-xl p-4"},y.a.createElement(o.a,null,ee))))))))}}}]);
//# sourceMappingURL=12.b0e49abb.chunk.js.map
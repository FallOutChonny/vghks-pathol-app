(this["webpackJsonpvghks-pathol-app"]=this["webpackJsonpvghks-pathol-app"]||[]).push([[11],{2540:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(134),o=a(228),i=a(33),l=a(47),s=a(40),u=a(41),d=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),a}(r.a.Component),m=a(209),p={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"};function b(e){var t=e.initialOffset,a=e.currentOffset;if(!t||!a)return{display:"none"};var n=a.x,r=a.y,c="translate(".concat(n,"px, ").concat(r,"px)");return{transform:c,WebkitTransform:c}}t.a=Object(c.DragLayer)((function(e){return{item:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}}))((function(e){var t=e.itemType,a=e.isDragging,n=e.currentOffset;if(!a)return null;if(!n)return null;var c=document.elementFromPoint(n.x,n.y),i=!1;return c&&(i=Object(m.a)(c)),r.a.createElement("div",{className:"report-template-builder__drag-layer",style:p},r.a.createElement("div",{style:b(e)},function(e){var a=e.canDrop;switch(t){case o.a.BOARD:case o.a.SNIPPET:return r.a.createElement(d,{canDrop:a});default:return null}}({canDrop:i})))}))},2599:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Oe}));a(678);var n=a(679),r=a.n(n),c=(a(256),a(67)),o=a.n(c),i=(a(105),a(15)),l=a.n(i),s=(a(257),a(43)),u=a.n(s),d=a(84),m=a(69),p=a(14),b=(a(677),a(258)),f=a.n(b),g=a(5),O=a(9),v=(a(444),a(323)),j=a.n(v),h=a(0),y=a.n(h),E=a(95),D=a.n(E),x=a(420),N=a(103),w=a(322),k=a(130),C=a(138),S=a(48),I=a(438),Y=a(185),P=a(441),T=a(439),_=a(60),M=a(2540),z=a(440),R=a(341),A=a(50),B=a(106),L=a(96),q=a(26),F=a(24).compose;var J=a(442),H=a(33),W=a(47),G=a(40),K=a(41),Q=a(134),U=a(538),V="CARD",X=Object(Q.DragSource)(V,{beginDrag:function(e){return Object(g.a)({},e.item)},canDrag:function(){return!0}},(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(function(e){Object(G.a)(a,e);var t=Object(K.a)(a);function a(){var e;Object(H.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){var t=e.props.connectDragPreview;t&&t(Object(U.a)())},e}return Object(W.a)(a,[{key:"render",value:function(){var e=this.props,t=e.item,a=e.className,n=e.style,r=e.connectDragSource,c=void 0===r?function(e){return e}:r,o=e.connectDragPreview,i=void 0===o?function(e){return e}:o,l=e.isDragging,s=Object(g.a)(Object(g.a)({},n),{},{border:"1px ".concat(l?"dashed":"solid"," #ddd")});return c(i(y.a.createElement("div",{key:t.id,className:a,style:s},"\u91ab\u5e2b ",t.doctor)))}}]),a}(y.a.Component)),Z=a(3),$=a.n(Z),ee=a(2511),te=a(13),ae=a(453),ne=a(460),re=a(334),ce=a(146),oe=a(164),ie=a(431),le=a(463),se=a(24).compose,ue=te.default.div.attrs({className:"px-6 py-4 block-placeholder"}).withConfig({displayName:"image-scheduler-calendar__BlockPlaceHolder",componentId:"sc-11y9ykq-0"})(["display:flex;align-items:center;border:rgba(225,225,225,0.9) 2px dashed;background-color:transparent;"]),de=Object(Q.DropTarget)(V,{drop:function(e,t,a){var n=e.index,r=t.getItem();a.handleDoctorDrop(r,n)},canDrop:function(e,t){var a=e.doctors,n=t.getItem();return Object(ae.a)([se(Object(ne.a)(re.a,2),ce.a),se(oe.a,Object(ie.a)(Object(le.a)("id",n.id)))])(a)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),didDrop:t.didDrop(),draggingItem:t.getItem()}})),me=Object(te.default)("div").withConfig({displayName:"image-scheduler-calendar___StyledDiv",componentId:"sc-11y9ykq-1"})((function(e){return{height:e._css,marginBottom:"0.1rem"}})),pe=function(e){Object(G.a)(a,e);var t=Object(K.a)(a);function a(){var e;Object(H.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleDoctorDrop=function(t,a){e.props.onDoctorDrop(Object(g.a)(Object(g.a)({},t),{},{index:a}))},e.handleDoctorRemove=function(t){return function(){e.props.onDoctorRemove(t)}},e}return Object(W.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.connectDropTarget,n=t.isOver,r=t.canDrop,c=t.doctors,o=void 0===c?[]:c,i=t.className,l=t.style,s="".concat(100/(o.length>0?2:1),"%");return a(y.a.createElement("div",{className:$()("w-full",i),style:Object(g.a)({height:"100%"},l)},o.map((function(t){return y.a.createElement(me,{key:"scheduled-doctor-".concat(t.id),className:"bg-login-cyan text-white flex items-center justify-center px-6 py-4 relative",_css:s},y.a.createElement("div",null,t.doctor,y.a.createElement(ee.a,{onClick:e.handleDoctorRemove(t),style:{position:"absolute",right:5,top:9,fontSize:12,cursor:"pointer"}})))})),n&&r&&y.a.createElement(ue,{style:{height:s}})))}}]),a}(y.a.Component),be=se(de)(pe),fe=a(24).compose,ge=j.a.MonthPicker;function Oe(){Object(I.a)("\u5f71\u50cf\u6392\u73ed"),Object(Y.a)([{name:"\u5f71\u50cf\u6392\u73ed"}]);var e=Object(P.a)("/"),t=y.a.useState(D()()),a=Object(O.a)(t,2),n=a[0],c=a[1],i=y.a.useState({}),s=Object(O.a)(i,2),b=s[0],v=s[1],j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.lazy,a=e.onCompleted,n=e.onError,r=Object(p.a)(e,["lazy","onCompleted","onError"]),c=Object(B.a)("/api/v1/d1/getDoctorShift/{date}",{variables:r,onCompleted:a,onError:n,lazy:t}),o=c.data,i=Object(p.a)(c,["data"]),l={};return F(Object(x.a)((function(e){l[e.date]?l[e.date].push(e):l[e.date]=[e]})),Object(N.a)([],[]))(o),Object(g.a)(Object(g.a)({},i),{},{shiftById:l,data:o})}({date:n.format("YYYY-MM"),lazy:!0,onCompleted:function(e){var t={};fe(Object(x.a)((function(e){var a=Object(g.a)(Object(g.a)({},e),{},{id:"".concat(e.date).concat(e.period),index:e.date});t[e.date]?t[e.date].push(a):t[e.date]=[a]})),Object(N.a)([],[]))(e),v(t)}}),h=j.refetch,E=j.loading,H=j.called,W=j.revalidate,G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(L.e)("/api/v1/d1/createShift",Object(g.a)(Object(g.a)({},e),{},{method:"POST"})),a=t.loading,n=t.mutate,r=function(e){var t=F(R.a,Object(S.a)((function(t){return F(Object(q.f)((function(a,n){return{date:+t,year_month:e.date.format("YYYY-MM"),period:0===n?"00:00~1200":"12:00~24:00",doctor:a.doctor}})),Object(N.a)([],["doctorList",t]))(e)})),A.a,Object(N.a)({},["doctorList"]))(e);return n(t)};return[a,r]}({onCompleted:function(e){W(),f.a.success("\u5132\u5b58\u6210\u529f")}}),K=Object(O.a)(G,2),Q=K[0],U=K[1];Object(Y.c)(y.a.createElement("div",{className:"inline-flex"},y.a.createElement(_.a,{color:"outline",className:"ml-6 bg-transparent text-white border-white",onClick:function(){U({date:n,doctorList:b})}},"\u5132\u5b58"),y.a.createElement(_.a,{color:"outline",className:"ml-6 bg-transparent text-white border-white",onClick:e},"\u653e\u68c4")));var V=Object(J.b)().doctorEnums,Z=function(e){var t=e.index,a=Object(p.a)(e,["index"]);v((function(e){var n=Object(N.a)([],[t])(e);return Object(g.a)(Object(g.a)({},e),{},Object(d.a)({},t,[].concat(Object(m.a)(n),[Object(g.a)({index:t},a)])))}))},$=function(e){var t=e.index,a=Object(p.a)(e,["index"]);v((function(e){var n=Object(N.a)([],[t])(e);return Object(g.a)(Object(g.a)({},e),{},Object(d.a)({},t,n.filter((function(e){return e.id!==a.id}))))}))},ee=[];return fe(Object(x.a)((function(e){ee.push(y.a.createElement(u.a,{key:"calendar-".concat(e),span:3},y.a.createElement("div",{className:"py-4 bg-gray-300 text-center"},n.month()+1,"/",e+1),y.a.createElement("div",{className:"h-20 border border-gray-300"},y.a.createElement(be,{index:e,doctors:Object(N.a)([],[e])(b),onDoctorDrop:Z,onDoctorRemove:$}))))})),Object(w.a)(k.a),Object(C.a)(0,"getDate")(),Object(C.a)(0,"toDate")())(n),y.a.createElement(z.a,null,y.a.createElement(M.a,null),y.a.createElement(r.a,{spinning:E||Q},y.a.createElement(T.a,null,y.a.createElement(o.a,{className:"mb-6"},y.a.createElement(u.a,{span:24},y.a.createElement("div",{className:"rounded-xl p-4 bg-white"},y.a.createElement(l.a,{layout:"inline",colon:!1},y.a.createElement(l.a.Item,{label:"\u6392\u73ed\u5e74\u6708"},y.a.createElement(ge,{allowClear:!1,value:n,onChange:function(e){e&&c(e)}})),y.a.createElement(_.a,{color:"primary",className:"ml-4",onClick:function(){h({date:n.format("YYYY-MM")})}},"\u67e5\u8a62"))))),H&&y.a.createElement(y.a.Fragment,null,y.a.createElement(o.a,{className:"mb-6"},y.a.createElement(u.a,{span:24},y.a.createElement("h2",{className:"text-base font-normal"},"\u91ab\u5e2b\u5217\u8868"),y.a.createElement("div",{className:"bg-white rounded-xl p-4"},y.a.createElement(o.a,{gutter:8},Object(S.a)((function(e){return y.a.createElement(u.a,{span:3,key:e.id},y.a.createElement(X,{draggable:!0,item:e,className:"bg-login-cyan text-white flex items-center justify-center px-6 py-4 mb-2 cursor-move"}))}),V))))),y.a.createElement(o.a,null,y.a.createElement(u.a,{span:24},y.a.createElement("h2",{className:"text-base font-normal"},"\u6392\u73ed\u5217\u8868"),y.a.createElement("div",{className:"bg-white rounded-xl p-4"},y.a.createElement(o.a,null,ee))))))))}}}]);
//# sourceMappingURL=11.24a8462a.chunk.js.map
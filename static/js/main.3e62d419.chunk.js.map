{"version":3,"sources":["bootstrap.ts","utils/createPack.tsx","components/error-boundary.tsx","components/exception.tsx","components/loading.tsx","components/breadcrumb.tsx","components/logout-confirm-modal.tsx","components/app-header.tsx","containers/home/index.ts","app.tsx","serviceWorker.ts","index.tsx","hooks/useSWR.tsx","components/checkbox.tsx","components/modal.tsx","utils/message.tsx","components/collapse.ts","services/report.ts","components/snippet-utils.tsx","hooks/useApp.ts","theme.ts","utils/webHelper.ts","hooks/useVisible.ts","hooks/useQuery.ts","components/select.tsx","constants/item-types.ts","components/datepicker.tsx","constants/enums.ts","components/radio.tsx","data/useUser.ts","components/query-table.tsx","components/input.tsx","utils/get-display-name.ts","components/table.tsx","hooks/useTableRowSelection.ts","components/snippet-template-wrapper.tsx","components/snippet-toolbar.tsx","components/withTinyMCE.js","components/snippet.tsx","components/tabs.ts","components/draggable-tabs.js","hooks/useAuth.tsx","containers/report-template-editor/index.ts","containers/report-template-list/index.ts","containers/report-inquiry/index.ts","containers/report-typing/autoHeight.tsx","containers/report-typing/report-typing-header.tsx","containers/report-typing/components.tsx","containers/report-typing/pie.tsx","containers/report-typing/report-typing-medical-order.tsx","containers/report-typing/report-typing-preview.tsx","containers/report-typing/report-typing-affix.tsx","containers/report-typing/report-typing-sidemenu.tsx","containers/report-typing/phrase-list-modal.tsx","containers/report-typing/useLayout.tsx","containers/report-typing/useReport.tsx","containers/report-typing/report-typing.tsx","containers/report-typing/index.ts","containers/report-list/index.ts","containers/radiol-report-list/index.ts","containers/yellow-card-inquiry/index.ts","containers/blood-bank-review/index.ts","containers/medical-order/index.ts","containers/phrase-list/index.ts","containers/report-version-comparison/index.ts","containers/image-scheduler/index.ts","containers/image-viewer-tutorial/index.ts","constants/routes.ts","components/layout.tsx","hooks/useTitle.ts","components/withScroll.js","components/snippet-scrollable-container.tsx","hooks/useRouteLeaveConfirm.ts","hooks/useMobile.tsx","services/phrase.ts","components/snippet-block-placeholder.ts","components/snippets-container.tsx","components/snippet-list-menu-item.tsx","components/snippet-list-menu.tsx","constants/env.ts","components/app-footer.tsx","../theme.js","hooks/useDelete.tsx","services/report-template.tsx","components/button.tsx","components/snippet-template-modal.tsx","components/form.tsx","components/radlex-list-modal.tsx","services/radlex.tsx","components/snippet-template-input-text.tsx","components/input-number.tsx","components/snippet-template-input-number.tsx","components/editable-table.tsx","components/snippet-template-selection-modal.tsx","components/snippet-template-multiple-selection.tsx","components/snippet-template-single-selection.tsx","components/snippet-template-date.tsx","components/snippet-template-time.tsx","components/snippet-template-select.tsx","components/snippet-template-section-header.tsx","components/snippet-template-cloze.tsx","components/snippet-template-list.tsx","utils/form.ts","utils/camelcase.ts","utils/request.ts","utils/history.ts"],"names":["dayjs","extend","isSameOrBefore","isSameOrAfter","advancedFormat","customParseFormat","weekYear","weekOfYear","isMoment","localeData","badMutable","weekday","locale","pack","children","components","length","Component","rest","React","type","props","ErrorFallbackWrapper","styled","div","ErrorFallback","error","componentStack","resetErrorBoundary","role","className","message","onClick","initialState","info","ErrorBoundary","state","args","onReset","setState","this","onError","prevProps","resetKeys","a","b","some","item","index","Object","is","changedArray","onResetKeysChange","fallbackRender","FallbackComponent","fallback","isValidElement","Error","Exception","ExceptionWrapper","style","backgroundImage","envStore","publicUrl","to","color","Wrapper","memo","justify","Loading3QuartersOutlined","spin","StyledBreadcrumb","StyledModal","Modal","LogoutConfirmModal","onOk","onCancel","visible","centered","closable","bodyStyle","paddingTop","width","footer","key","minWidth","marginRight","ExclamationCircleFilled","fontSize","AppHeader","useBreadcrumbState","items","content","useHeaderContentValue","setUser","useUser","useAuth","logout","user","isMobile","useMobile","useState","history","location","pathname","current","setCurrentPath","useVisible","isOpen","setIsOpen","logoutModalVisible","handleLogoutModalVisible","handleLogoClick","isAdmin","prev","viewDivision","push","handleTo","getMenuClassName","targetUrl","cx","includes","renderMenu","mode","Item","MenuItem","SubItem","SubMenu","showMenu","borderBottom","lineHeight","borderRight","division","Divisions","PATH","routes","SettingOutlined","RAD","popupOffset","popupClassName","title","CaretDownOutlined","display","isClinician","onCompleted","window","href","oauthUrl","placement","paddingLeft","onClose","Header","MenuOutlined","Logo","src","alt","name","LogoutOutlined","useOAuth","bordered","placeholder","suffixIcon","defaultValue","onChange","value","Option","CLINICIAN","UserOutlined","separator","minHeight","alignItems","HomeOutlined","top","map","x","idx","p","theme","primary","purple150","lazy","GlobalStyles","createGlobalStyle","App","isAuthenticated","setIsAuthenticated","useRoutes","renderRouteItem","useCallback","path","param","exact","id","component","renderRoute","data","hide","queryString","search","useEffect","userid","loginUser","expiredAt","Date","Store","set","JSON","stringify","Suspense","Home","Boolean","hostname","match","redirect","EnhancedApp","createPack","zhTW","initializeState","suspense","fetcher","request","revalidateOnFocus","DndProvider","backend","HTML5Backend","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","console","useSWR","variables","fetchOptions","config","fn","query","setQuery","called","setIsCalled","val","useRef","_fn","ifElse","isNil","always","url","throwable","identity","_key","String","format","fullUrl","params","toQueryString","_useSWR","dedupingInterval","shouldRetryOnError","onSuccess","refetch","Promise","resolve","undefined","loading","isValidating","CheckboxGroup","Group","StyledCheckbox","darkGrey","CheckboxComponent","forwardRef","ref","displayName","ModalComponent","confirm","success","marginTop","marginBottom","modalDefaultProps","icon","okText","cancelText","autoFocusButton","okButtonProps","cancelButtonProps","StyledCollapse","compose","require","atom","default","setComponentByTab","get","useReportList","equals","__","useQuery","method","isRad","sortBy","ordate","hhisnum","pathOr","useYellowCards","useReport","Array","head","useMedicalOrder","orreqno","setORReqno","_url","body","ORREQNO","_refetch","loadingM","orstatuscode","orstatus","reportStatus","FINISH","CANCEL","TYPED","UNTYPE","useCreateOrUpdateReportAPI","options","useRequest","mutate","useReports","dataSource","s","uuid","total","totalPages","Math","floor","isoRe","RegExp","useConvertData","convertData","useConvertReportTemplate","report","status","find","propEq","reportStatusEnums","mergeAll","filter","cond","v","and","or","test","moment","isValid","toISOString","T","flatten","values","_data","template","of","omit","cloze","topic","useReportItem","loadingData","useReportComparision","_head","_last","last","latest","previous","useMakeRequestPayload","getHtmlValue","html","$","cheerio","load","results","each","_","el","setting","inline","clozeId","encodeURIComponent","topicId","toolTip","tooltip","tab","categoryName","keys","useCreateOrUpdateReport","makeRequestPayload","hanlder","log","useReportJson","json","useExportReportJson","handler","filename","response","downloadAsJson","defaultOptions","text","selected","freetext","hasClassName","nodes","n","canMoveSnippet","element","elem","parentNode","unshift","getPlaceHolderIndex","clientOffset","overSnippet","findSnippet","classList","contains","parentElement","elementFromPoint","y","snippetIndex","dataset","placeholderIndex","Number","isOverSnippet","padding","renderSnippets","snippetList","mapIndexed","wrapperId","draggable","tabSize","dangerouslySetInnerHTML","__html","breadcrumbState","useRecoilState","useBreadcrumb","setter","useSetRecoilState","headerContentState","useHeaderContent","node","useRecoilValue","forEach","addIndex","isEmpty","either","not","RisNil","URLSearchParams","result","d","now","performance","replace","c","r","random","toString","hasPath","namedPath","getRangeDate","date","dateFormat","startDate","stopDate","valueOf","toThousandSeparator","number","isNaN","toLocaleString","getNumberFromString","str","isEnvDev","appBaseName","appUrl","dataStr","downloadAnchorNode","createElement","setAttribute","appendChild","click","remove","readFile","file","reject","fileReader","FileReader","addEventListener","onerror","readAsText","toMoment","toDateString","m","sorter","field","localeCompare","onRequestOpen","setVisible","handleVisible","evt","handleClose","StyledSelect","secondary","SelectComponent","CARD","BOARD","SNIPPET","borderLess","css","RangePicker","StyledDatePicker","StyledTimePicker","DatePickerComponent","ActionTypes","reportAnnotations","reportTemplateStatusEnums","DRAFT","reportTemplateStatusNameEnums","f","StyledRadio","RadioComponent","userState","setUserState","setAuthUser","updater","QueryTable","columns","pageNum","rowSelection","pagination","_pageNum","setPageNum","paginationConfig","mergeDeepRight","pageSize","showSizeChanger","rowKey","StyledInput","TextArea","getDisplayName","StyledTable","TableComponent","editable","onAddRowClick","isRowDeletable","onDeleteRowClick","isCanEdit","_columns","useMemo","canEdit","Column","useRowSelection","limit","defaultRowKeys","defaultRows","multiple","selectedRowKeys","setSelectedRowKeys","selectedRows","setSelectedRows","onSelectChange","rowKeys","rows","takeLast","concat","isDeletable","useDelete","deleteItem","onAfterDelete","handleConfirm","selectedRowCount","clearSelection","StyledCard","SnippetTemplateWrapper","onDelete","onEdit","titleVisible","bodyVisible","useReportPreview","isPreview","Icon","FontColorsOutlined","ToolbarWrapper","SHIFT_TYPES","SnippetToolbar","tabIndex","onShift","handleShift","shift","hidden","LeftOutlined","RightOutlined","EditOutlined","DeleteOutlined","defaultConfig","block_formats","menubar","external_plugins","dropdown","inputtext","env","fontsize_formats","force_br_newlines","force_p_newlines","forced_root_block","plugins","tinymce","link_title","table_toolbar","textcolor_cols","content_security_policy","allow_unsafe_link_target","relative_urls","convert_urls","valid_elements","valid_children","toolbar1","withDragSource","DragSource","ItemTypes","beginDrag","fromMenu","originalIndex","canDrag","connect","monitor","connectDragSource","dragSource","connectDragPreview","dragPreview","isDragging","Snippet","componentDidMount","getEmptyImage","shiftSnippet","handleRemove","removeSnippet","handleEditModalVisible","editModalVisible","_onMouseOver","_onMouseOut","styles","mergeRight","isFocus","borderRadius","border","outlineColor","cursor","position","marginLeft","getItemStyles","Children","child","cloneElement","onMouseOver","onMouseOut","data-index","snippetTypes","CLOZE","HEADER","ComposedComponent","withTinyMCE","editor","toolbarMouseOver","toolbarVisible","_addEventListeners","dom","select","target","innerHTML","removeAttribute","triggerSave","childNodes","HTMLElement","innerText","hasAttribute","initialize","snippet","_get","_config","clone","init","selector","language_url","setup","on","onBlur","onFocus","Function","execInit","setContent","init_instance_callback","undoManager","add","getContent","e","updateSnippet","prevState","defaultProps","hoist","bg","TabNode","connectDropTarget","isOver","draggingItem","moveTabNode","withDropTarget","DropTarget","drop","dragKey","getItem","hoverKey","dropTarget","WrapTabNode","DraggableTabs","order","newOrder","slice","indexOf","dragIndex","hoverIndex","splice","renderTabBar","DefaultTabBar","TabPane","Tabs","AuthContext","createContext","_user","AuthProvider","Provider","context","useContext","computeHeight","parseInt","getComputedStyle","height","paddingBottom","autoHeight","menuState","WrappedComponent","computedHeight","root","handleRoot","h","getAutoHeight","StyledAnchor","PieChart","chartWidth","legendWidth","ReactFitText","DataView","Pie","legendData","legendBlock","requestRef","chart","getG2Instance","requestAnimationFrame","getLegendData","resize","handleLegendClick","i","newItem","checked","filteredLegendData","l","Debounce","hasLegend","clientWidth","removeEventListener","passive","preProps","cancelAnimationFrame","cancel","valueFormat","subTitle","forceFit","percent","inner","animate","lineWidth","pieClassName","classNames","propsData","propsSelected","parseFloat","dv","source","transform","dimension","as","maxFontSize","scale","range","min","autoFit","onGetG2Instance","showTitle","innerRadius","stroke","toFixed","adjust","label","backgroundColor","PureComponent","html2pdf","isExport","readOnly","onToggleExport","useRouteLeaveConfirm","REPORT_INQUIRY","exporting","setIsExporting","exportingJson","handleExportJson","handleExport","querySelector","opt","margin","image","quality","html2canvas","jsPDF","unit","orientation","from","save","viewerUrl","radiolViewerUrl","open","ReportMedicalOrder","onToggle","activeKey","expandIcon","Panel","header","DoubleRightOutlined","left","orworkno","hnamec","hsex","csect","hnursta","hbed","hbirthdt","hbirthd2","orproced","noStyle","rules","required","defaultChecked","formItemLayout","createFormItemLayout","shortFormItemLayout","FormItem","Divider","SnippetPreviewWrapper","ReportTypingPreview","medical","getHtmlText","valuesJson","$el","replaceWith","getValue","textContent","_snippetList","useCode","span","gutter","cfinancl","orword","maxWidth","whiteSpace","gt","textOnly","_idx","Tag","renderReport","Link","Anchor","ReportTypingAffix","affixed","offsetTop","showInkInFixed","affix","getAnchorStyles","background","borderBottomLeftRadius","borderBottomRightRadius","ReportTypingSideMenu","onLayoutChnage","onReportChange","onTabChange","onPhraseListModalVisible","category","templateName","setIsAffixed","defaultActiveKey","DoubleLeftOutlined","right","initialValue","link","preventDefault","join","split","scroll","behavior","BulbOutlined","PhraseListModal","usePhraseList","useTableRowSelection","paddingRight","pluck","keyboard","maskClosable","size","dataIndex","col","ReportTyping","useToggleReportPreview","useTitle","useForm","form","exportable","handleExportable","VISIBLE_LEFT","VISIBLE_RIGHT","visibleLayouts","setVisibleLayouts","handleLayoutChange","toggleLeftMenu","toggleRightMenu","leftContentVisible","rightContentVisible","useLayout","onExportableChange","qs","doctor","setFieldsValue","setCurrentTemplateName","medicalorder","useReportTemplate","shouldFetch","errorMsg","templateId","reportTemplate","setReportTemplate","_loading","handleReportTemplateChange","handleTabEdit","handleTabChange","handleTabMove","handleTabNameChange","handleSnippetUpdate","handleKeyPress","ctrlKey","toUpper","stopPropagation","handleOk","handlePhraseListModalVisible","phraseListModalVisible","REPORT_EDIT","creating","handleCreateOrUpdate","templateByName","useAllReportTemplates","validateFields","maxCount","percentage","setPercentage","handlePercentageChange","sum","isAnswer","round","handleValuesChange","changedValues","toPairs","list","update","getFieldsValue","colSpan","morder","newList","spinning","labelAlign","onValuesChange","tabBarGutter","contentEditable","suppressContentEditableWarning","spellCheck","renderORWord","onSnippetUpdate","renderCategory","PhraseList","PhraseEdit","REPORT_TEMPLATE_LIST","REPORT_INPUT","REPORT_TEMPLATE_EDIT","REPORT_TEMPLATE_CREATE","REPORT_VERSION_COMPARISON","REPORT_LIST","PHRASE_LIST","PHRASE_CREATE","PHRASE_EDIT","BLOOD_BANK_REVIEW","YELLOW_CARD_INQUIRY","MEDICAL_ORDER","IMAGE_SCHEDULER","IMAGE_VIEWER_TUTORIAL","isPATH","isRAD","isUsePATH","viewPath","viewRad","ImageScheduler","ReportList","RadiolReportList","ReportInquiry","ReportVersionComparison","YellowCardInquiry","BloodBankReview","MedicalOrder","ReportTemplateList","ReportTemplateBuilder","ImageViewerTutorial","Page","Content","DEFAULT_USE_TITLE_OPTIONS","restoreOnUnmount","prevTitleRef","appTitle","_title","noop","intBetween","max","createVerticalStrength","_buffer","point","w","buffer","defaultHorizontalStrength","defaultVerticalStrength","ScrollableComponent","ScrollingComponent","ctx","handleEvent","dragging","attached","attach","updateScrolling","throttle","container","getBoundingClientRect","box","coords","changedTouches","clientX","clientY","getCoords","scaleX","horizontalStrength","scaleY","verticalStrength","frame","startScrolling","trailing","useScroll","_initial","findDOMNode","wrappedInstance","clearMonitorSubscription","dragDropManager","getMonitor","subscribeToStateChange","handleMonitorChange","_remove","stopScrolling","tick","strengthMultiplier","onScrollChange","scrollLeft","scrollTop","scrollWidth","scrollHeight","clientHeight","raf","detach","contextType","DndContext","withScroll","vStrength","ReactDndProvider","mobile","setIsMobile","handleResize","currentViewport","innerWidth","innerHeight","setComponent","no","description","templateDescription","decodeURIComponent","statusName","createdAt","createDate","createdAtStr","updatedAt","updateDate","updatedAtStr","useUserPhraseTemplates","useCreateOrUpdatePhraseTemplateAPI","useDeletePhraseTemplateAPI","useCreateOrUpdatePhrase","userId","useRemovePhrase","TemplateName","usePhraseItem","phraseTemplate","setPhraseTemplate","author","setSnippetList","snippetById","usePhraseTemplate","attrs","canDrop","handleSnippetDrop","handleSnippetMove","getClientOffset","hover","hoverBoundingRect","hoverMiddleY","bottom","didDrop","SnippetsContainer","atIndex","handleFindSnippet","isPlaced","droppedItem","nextIndex","insert","handleSnippetRemove","handleSnippetShift","lt","isPlaceHold","cardList","onUpdate","withRouter","endDrag","SnippetListMenuItem","SnippetListMenuWrapper","comp","SnippetListMenu","snippetTemplateList","apiBaseUrl","process","REACT_APP_TITLE","protocol","host","REACT_APP_FAKE_API_ROOT","check","userAgent","vendor","opera","substr","AppFooter","Footer","module","exports","danger","cornblue","comet","btn","sider","login","cyan","modal","onRequestDelete","onBeforeDelete","refetchQueries","modalProps","onAfterDeleteResolve","currentTarget","handleConfirmDeletion","handleDeleteFailure","Gross","Microscopy","Comparison","Notes","Findings","References","Impression","snippetCategoryOfReportState","PROCEDURE_INFORMATION","CLINICAL_INFORMATION","COMPARISON","FINDINGS","IMPRESSION","PATHOLOGICAL_DIAGNOSIS","GROSS","MICROSCOPY","NOTES","REFERENCES","useDefaultSnippetOfReport","snippetCategoryOfReport","defaultSnippetsOfReport","snippetTemplateById","tryCatch","invoker","anyPass","templateJson","parse","units","sort","uniq","useCreateReportTemplateAPI","useUpdateReportTemplateAPI","useDeleteReportTemplateAPI","useUpdateSnippet","setSetting","newSetting","useReportTemplates","useUserReportTemplates","ReportTemplateSelect","onSearch","keyword","setKeyword","pick","filterReportTemplates","toLowerCase","showSearch","filterOption","disabled","_shouldFetch","handleUpdateReportTemplate","assoc","isEmptyReport","newData","categoryCountById","categoryCount","useQueryReportTemplate","categoryState","setCategory","handleTabAdd","inc","Rlast","handleTabRemove","targetKey","action","snippetKeys","orderA","orderB","newTabName","useCreateTemplate","useUpdateTemplate","useDeleteTemplate","TemplateNAME","useExportTemplate","reportPreviewState","setIsPreview","StyledButton","ButtonComponent","actionType","TemplateModal","useRadlex","Radlex","onSelect","radlexModalVisible","handleRadlexModalVisible","radlexCode","RadlexListModal","radlex","code","LinkOutlined","useLazyQuery","useRadlexes","_dataSource","InputTextModal","handleSelect","initialValues","valuePropName","StyledInputNumber","ThousandSeprartorInput","thosandSeprartor","CurrencyInput","currency","PercentInput","InputNumberModal","EditableTable","onRowAdd","onRowDelete","triggerChange","changedValue","SnippetTemplateSelectionModal","freetextVisible","align","SnippetTemplateMultipleSelection","SnippetTemplateSingleSelection","InputDateModal","allowClear","picker","InputTimeModal","SnippetTemplateCloze","TEXT","NUMBER","SELECT","MULTIPLE_SELECTION","SINGLE_SELECTION","DATE","TIME","BoldOutlined","FontSizeOutlined","inputProps","multipleLine","autoSize","minRows","NumberOutlined","formatter","parser","DatabaseOutlined","UnorderedListOutlined","TemplateMultipleSelection","OrderedListOutlined","TemplateSingleSelection","CalendarOutlined","ClockCircleOutlined","Cloze","wrapper","labelCol","xs","sm","wrapperCol","account","pattern","password","preserveCamelCase","string","isLastCharLower","isLastCharUpper","isLastLastCharUpper","character","toUpperCase","camelCase","input","isArray","TypeError","assign","pascalCase","postProcess","charAt","trim","hasUpperCase","p1","regex","_params","propName","replacedValue","paramsObject","useMeta","setIsLoading","_options","withMeta","setData","setError","contentTypeIs","convertObjectKeys","object","keypath","o","reduce","acc","nestedKeyPath","camelcase","headers","msg","withToken","successMessage","endpoint","fetch","FormData","merge","Authorization","Accept","statusText","ok","blob","err","allPass","createHashHistory","basename"],"mappings":"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","file":"static/js/main.3e62d419.chunk.js","sourcesContent":["import dayjs from 'dayjs'\nimport customParseFormat from 'dayjs/plugin/customParseFormat'\nimport weekOfYear from 'dayjs/plugin/weekOfYear'\nimport weekday from 'dayjs/plugin/weekday'\nimport isMoment from 'dayjs/plugin/isMoment'\nimport badMutable from 'dayjs/plugin/badMutable'\nimport localeData from 'dayjs/plugin/localeData'\nimport advancedFormat from 'dayjs/plugin/advancedFormat'\nimport weekYear from 'dayjs/plugin/weekYear'\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore'\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter'\nimport 'dayjs/locale/zh-tw'\nimport 'leaflet/dist/leaflet.css'\nimport 'leaflet-draw/dist/leaflet.draw.css'\nimport '@/data/useUser'\n\ndayjs.extend(isSameOrBefore)\ndayjs.extend(isSameOrAfter)\ndayjs.extend(advancedFormat)\ndayjs.extend(customParseFormat)\ndayjs.extend(weekYear)\ndayjs.extend(weekOfYear)\ndayjs.extend(isMoment)\ndayjs.extend(localeData)\ndayjs.extend(badMutable)\ndayjs.extend(weekday)\n\ndayjs.locale('zh-tw')\n","import * as React from 'react'\n\nexport interface WithChildrenProps {\n  children: React.ReactNode\n}\n\nexport type PackComponentType<\n  T extends WithChildrenProps = WithChildrenProps\n> = React.ElementType<T>\n\nexport function pack(\n  children: React.ReactNode = null,\n  ...components: PackComponentType[]\n) {\n  if (!components.length) {\n    return children as JSX.Element\n  }\n\n  const [Component, ...rest] = components\n\n  if (React.isValidElement(Component)) {\n    return (\n      <Component.type {...Component.props}>\n        {pack(children, ...rest)}\n      </Component.type>\n    )\n  }\n\n  return <Component>{pack(children, ...rest)}</Component>\n}\n\nexport function createPack(...components: any[]) {\n  return function PackComponent({ children }: WithChildrenProps) {\n    return pack(children, ...components)\n  }\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport Button from '@/components/button'\n\ntype ErrorInfo = {\n  componentStack: string\n}\n\ntype FallbackProps = {\n  error?: Error\n  componentStack?: string\n  resetErrorBoundary: () => void\n}\n\ntype ErrorBoundaryProps = {\n  onResetKeysChange?: (\n    prevResetKeys: Array<any> | undefined,\n    resetKeys: Array<any> | undefined\n  ) => void\n  onReset?: (...args: any) => void\n  onError?: (error: Error, componentStack: string) => void\n  resetKeys?: Array<any>\n  FallbackComponent?: React.ComponentType<FallbackProps>\n  fallbackRender?: (props: FallbackProps) => React.ReactElement<any, any> | null\n  fallback?: React.ReactElement<any, any> | null\n}\n\ntype ErrorBoundaryState = {\n  hasError?: boolean\n  error?: Error | null\n  info?: ErrorInfo | null\n}\n\nconst ErrorFallbackWrapper = styled.div`\n  width: 100%;\n  height: 100vh;\n  margin: 0 auto;\n  padding: 50px;\n`\n\nfunction ErrorFallback({\n  error,\n  componentStack,\n  resetErrorBoundary,\n}: FallbackProps) {\n  return (\n    <ErrorFallbackWrapper role=\"alert\">\n      <p className=\"text-xl\">Something went wrong:</p>\n      <pre className=\"text-sm\">{error?.message}</pre>\n      <pre className=\"text-sm\">{componentStack}</pre>\n      <Button onClick={resetErrorBoundary}>Try again</Button>\n    </ErrorFallbackWrapper>\n  )\n}\n\nconst changedArray = (a: any[] | undefined = [], b: any[] | undefined = []) =>\n  a.length !== b.length || a.some((item, index) => !Object.is(item, b[index]))\n\nconst initialState = { error: null, info: null }\nexport default class ErrorBoundary extends React.Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = initialState\n\n  resetErrorBoundary = (...args: any) => {\n    this.props.onReset?.(...args)\n    this.setState(initialState)\n  }\n\n  componentDidCatch(error: Error, info: ErrorInfo) {\n    this.props.onError?.(error, info?.componentStack)\n    this.setState({ error, info })\n  }\n\n  componentDidUpdate(prevProps: ErrorBoundaryProps) {\n    const { error } = this.state\n    const { resetKeys } = this.props\n    if (error !== null && changedArray(prevProps.resetKeys, resetKeys)) {\n      this.props.onResetKeysChange?.(prevProps.resetKeys, resetKeys)\n      this.setState(initialState)\n    }\n  }\n\n  render() {\n    const { error, info } = this.state\n    const {\n      fallbackRender,\n      FallbackComponent = ErrorFallback,\n      fallback,\n    } = this.props\n\n    if (error !== null) {\n      const props = {\n        componentStack: info?.componentStack,\n        error,\n        resetErrorBoundary: this.resetErrorBoundary,\n      }\n      if (React.isValidElement(fallback)) {\n        return fallback\n      } else if (typeof fallbackRender === 'function') {\n        return fallbackRender(props)\n      } else if (FallbackComponent) {\n        return <FallbackComponent {...props} />\n      } else {\n        throw new Error(\n          'react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop'\n        )\n      }\n    }\n\n    return this.props.children\n  }\n}\n\nfunction withErrorBoundary<P>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps: ErrorBoundaryProps\n) {\n  function Wrapped(props: any) {\n    return (\n      <ErrorBoundary {...errorBoundaryProps}>\n        <Component {...props} />\n      </ErrorBoundary>\n    )\n  }\n\n  // Format for display in DevTools\n  const name = Component.displayName || Component.name || 'Unknown'\n  Wrapped.displayName = `withErrorBoundary(${name})`\n\n  return Wrapped\n}\n\nfunction useErrorHandler<P = Error>(givenError?: P) {\n  const [error, setError] = React.useState(null)\n  if (givenError) throw givenError\n  if (error) throw error\n  return setError\n}\n\nexport { ErrorBoundary, withErrorBoundary, useErrorHandler }\n","import React from 'react'\nimport { Link } from 'react-router-dom'\nimport styled from 'styled-components'\nimport Button from '@/components/button'\nimport { envStore } from '@/constants/env'\n\ntype Props = {\n  type?: number | string | 404\n}\n\nexport default function Exception({ type = 404 }: Props) {\n  return (\n    <ExceptionWrapper>\n      <div className=\"exception\">\n        <div className=\"exception__imgBlock\">\n          <div\n            className=\"exception__imgEle\"\n            style={{\n              backgroundImage: `url(\"${envStore.publicUrl}/images/${type}.svg\")`,\n            }}\n          />\n        </div>\n        <div className=\"exception__content\">\n          <h1>404</h1>\n          <div className=\"exception__desc\">抱歉，你訪問的頁面不存在</div>\n          <div className=\"exception__actions\">\n            <Link to=\"/\">\n              <Button color=\"primary\">回首頁</Button>\n            </Link>\n          </div>\n        </div>\n      </div>\n    </ExceptionWrapper>\n  )\n}\n\nconst ExceptionWrapper = styled.div`\n  height: 100%;\n  margin-right: -24px;\n  background: #f9f9fb;\n  border-radius: 4px;\n\n  .exception {\n    display: flex;\n    align-items: center;\n    height: 100%;\n  }\n\n  .exception .exception__imgBlock {\n    flex: 0 0 62.5%;\n    width: 62.5%;\n    padding-right: 152px;\n    zoom: 1;\n  }\n\n  .exception .exception__imgEle {\n    float: right;\n    width: 100%;\n    max-width: 430px;\n    height: 360px;\n    background-repeat: no-repeat;\n    background-position: 50% 50%;\n    background-size: contain;\n  }\n\n  .exception .exception__content {\n    flex: auto;\n  }\n\n  .exception .exception__content h1 {\n    margin-bottom: 24px;\n    color: #434e59;\n    font-weight: 600;\n    font-size: 72px;\n    line-height: 72px;\n  }\n\n  .exception .exception__content .exception__desc {\n    margin-bottom: 24px;\n    color: rgba(0, 0, 0, 0.45);\n    font-size: 20px;\n    line-height: 28px;\n  }\n`\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Row, Col } from 'antd'\nimport { Loading3QuartersOutlined } from '@ant-design/icons'\n\ntype PropTypes = {\n  className?: string\n  style?: React.CSSProperties\n}\n\nconst Wrapper = styled.div`\n  .ant-spin {\n    &--inner {\n      margin: 0 auto;\n    }\n  }\n`\n\nexport function Loading(props: PropTypes) {\n  return <Loading3QuartersOutlined {...props} />\n}\n\nexport default React.memo(function Loading({\n  className,\n  style,\n  ...props\n}: PropTypes) {\n  return (\n    <Wrapper className=\"bg-greyF9\">\n      <Row justify=\"center\" className={className}>\n        <Col className=\"ant-spin--inner\">\n          <Loading3QuartersOutlined spin style={style} />\n        </Col>\n      </Row>\n    </Wrapper>\n  )\n})\n","import { Breadcrumb } from 'antd'\nimport styled from 'styled-components'\n\nconst StyledBreadcrumb = styled(Breadcrumb)`\n  &.ant-breadcrumb {\n    font-size: 16px;\n\n    .ant-breadcrumb-link {\n      cursor: pointer;\n    }\n\n    .ant-breadcrumb-link,\n    a {\n      color: #fff;\n    }\n\n    .anticon {\n      font-size: 16px;\n    }\n\n    .ant-breadcrumb-link:hover,\n    a:hover {\n      text-decoration: underline;\n    }\n\n    .ant-breadcrumb-separator {\n      margin: 0 16px;\n      color: #fff;\n    }\n\n    > span:last-child {\n      color: #fff;\n      text-decoration: underline;\n    }\n  }\n`\n\nexport default StyledBreadcrumb\n","import React from 'react'\nimport { ModalProps } from 'antd/lib/modal'\nimport styled from 'styled-components'\nimport { ExclamationCircleFilled } from '@ant-design/icons'\nimport Modal from '@/components/modal'\nimport Button from '@/components/button'\n\ninterface Props extends ModalProps {}\n\nconst StyledModal = styled(Modal)`\n  .ant-modal-footer {\n    border-top: none;\n  }\n`\n\nexport default function LogoutConfirmModal({\n  onOk,\n  onCancel,\n  ...props\n}: Props) {\n  return (\n    <StyledModal\n      {...props}\n      visible\n      centered\n      closable={false}\n      bodyStyle={{ paddingTop: 48 }}\n      width={350}\n      footer={[\n        <div\n          key=\"logout-modal-footer\"\n          className=\"flex items-center justify-center mb-4\">\n          <Button\n            key=\"btn-ok\"\n            color=\"primary\"\n            style={{ minWidth: 120, marginRight: 16 }}\n            onClick={onOk}>\n            確定\n          </Button>\n          <Button\n            key=\"btn-cancel\"\n            color=\"outline\"\n            style={{ minWidth: 120 }}\n            onClick={onCancel}>\n            取消\n          </Button>\n        </div>,\n      ]}>\n      <div className=\"text-center\">\n        <ExclamationCircleFilled\n          className=\"mb-6\"\n          style={{ fontSize: 48, color: '#e53e3e' }}\n        />\n        <div className=\"text-lg font-medium text-darkGrey mb-4\">\n          請問是否確定要登出？\n        </div>\n      </div>\n    </StyledModal>\n  )\n}\n","import React from 'react'\nimport cx from 'classnames'\nimport { Layout, Menu, Select, Drawer } from 'antd'\nimport { MenuProps } from 'antd/lib/menu'\nimport {\n  SettingOutlined,\n  HomeOutlined,\n  CaretDownOutlined,\n  MenuOutlined,\n  LogoutOutlined,\n  UserOutlined,\n} from '@ant-design/icons'\nimport styled from 'styled-components'\nimport Breadcrumb from '@/components/breadcrumb'\nimport LogoutConfirmModal from '@/components/logout-confirm-modal'\nimport { useBreadcrumbState, useHeaderContentValue } from '@/hooks/useApp'\nimport useAuth from '@/hooks/useAuth'\nimport useVisible from '@/hooks/useVisible'\nimport history from '@/utils/history'\nimport useMobile from '@/hooks/useMobile';\nimport { envStore } from '@/constants/env'\nimport * as routes from '@/constants/routes'\nimport { Divisions } from '@/constants/enums'\nimport { useUser } from '@/data/useUser'\nimport { User } from '@/constants/types'\n\nexport default function AppHeader() {\n  const [items] = useBreadcrumbState()\n  const content = useHeaderContentValue()\n  const setUser = useUser()\n\n  const { logout, user } = useAuth()\n  const isMobile = useMobile()\n\n  const [current, setCurrentPath] = React.useState(history.location.pathname)\n\n  const [isOpen, setIsOpen] = useVisible()\n  const [logoutModalVisible, handleLogoutModalVisible] = useVisible()\n\n  const handleLogoClick = () => {\n    if (user.isAdmin) {\n      setUser((prev: any) => ({ ...prev, viewDivision: false }))\n    }\n    history.push('/')\n  }\n\n  const handleTo = (pathname?: string) => () => {\n    if (pathname) {\n      setCurrentPath(pathname)\n      history.push(pathname)\n    }\n  }\n\n  const getMenuClassName = (targetUrl: string) => {\n    return cx({\n      'is--currentt': current !== '/' && targetUrl.includes(current),\n    })\n  }\n\n  const handleUserChange = (value: string) => {\n    const isClinician = value === Divisions.CLINICIAN\n\n    setUser(\n      (prev: User | null) =>\n        ({\n          ...prev,\n          isClinician,\n          division: isClinician ? prev?.division : value,\n        } as any)\n    )\n\n    if (isClinician) {\n      history.push('/')\n    }\n  }\n\n  const handleRoleChange = (value: number) => {\n    setUser(\n      (prev: User | null) =>\n        ({\n          ...prev,\n          isAdmin: !!value,\n          viewDivision: false,\n        } as any)\n    )\n    history.push('/')\n  }\n\n  const handleLogout = () => {\n    logout({\n      onCompleted: () => {\n        window.location.href = envStore.oauthUrl\n      },\n    })\n  }\n\n  const renderMenu = ({ mode = 'horizontal' }: MenuProps = {}) => {\n    let Item = isMobile ? Menu.Item : MenuItem\n    let SubItem = isMobile ? Menu.SubMenu : SubMenu\n\n    if (!showMenu) {\n      return (\n        <Menu\n          mode={mode}\n          className=\"bg-transparent ml-3\"\n          style={{ borderBottom: 'none', lineHeight: '46px' }}>\n          <Item\n            key={routes.REPORT_LIST}\n            onClick={handleTo(routes.REPORT_LIST)}\n            className={getMenuClassName(routes.REPORT_LIST)}>\n            <div className=\"flex items-center text-base\">\n              <SettingOutlined />\n              報告查詢\n            </div>\n          </Item>\n        </Menu>\n      )\n    }\n\n    return (\n      <Menu\n        mode={mode}\n        className=\"bg-transparent ml-3\"\n        style={{\n          borderBottom: 'none',\n          lineHeight: '46px',\n          borderRight: 'none',\n        }}>\n        {user.division === Divisions.PATH && (\n          <Item\n            key={routes.IMAGE_SCHEDULER}\n            onClick={handleTo(routes.IMAGE_SCHEDULER)}\n            className={getMenuClassName(routes.IMAGE_SCHEDULER)}>\n            <div className=\"flex items-center text-base\">\n              <SettingOutlined />\n              報告排班\n            </div>\n          </Item>\n        )}\n        {user.division === Divisions.RAD && (\n          <Item\n            key={routes.REPORT_LIST}\n            onClick={handleTo(routes.REPORT_LIST)}\n            className={getMenuClassName(routes.REPORT_LIST)}>\n            <div className=\"flex items-center text-base\">\n              <SettingOutlined />\n              報告查詢\n            </div>\n          </Item>\n        )}\n        {user.division === Divisions.PATH && (\n          <SubItem\n            key={routes.REPORT_LIST}\n            className={getMenuClassName(routes.REPORT_LIST)}\n            popupOffset={[-14, 0]}\n            popupClassName=\"rounded\"\n            title={\n              <div className=\"flex items-center text-base\">\n                <SettingOutlined />\n                報告查詢\n                {!isMobile && <CaretDownOutlined className=\"ml-2 mr-0\" />}\n              </div>\n            }>\n            <Menu.Item\n              key={routes.REPORT_LIST}\n              onClick={handleTo(routes.REPORT_LIST)}\n              className={getMenuClassName(routes.REPORT_LIST)}>\n              <div className=\"flex items-center text-sm\">\n                <SettingOutlined />\n                報告查詢\n              </div>\n            </Menu.Item>\n            <Menu.Item\n              key={routes.REPORT_VERSION_COMPARISON}\n              onClick={handleTo(routes.REPORT_VERSION_COMPARISON)}\n              className={getMenuClassName(routes.REPORT_VERSION_COMPARISON)}>\n              <div className=\"flex items-center text-sm\">\n                <SettingOutlined />\n                版本比較\n              </div>\n            </Menu.Item>\n            <Menu.Item\n              key={routes.YELLOW_CARD_INQUIRY}\n              onClick={handleTo(routes.YELLOW_CARD_INQUIRY)}\n              className={getMenuClassName(routes.YELLOW_CARD_INQUIRY)}>\n              <div className=\"flex items-center text-sm\">\n                <SettingOutlined />\n                黃卡新檢索\n              </div>\n            </Menu.Item>\n            <Menu.Item\n              key={routes.BLOOD_BANK_REVIEW}\n              onClick={handleTo(routes.BLOOD_BANK_REVIEW)}\n              className={getMenuClassName(routes.BLOOD_BANK_REVIEW)}\n              style={{ display: 'none' }}>\n              <div className=\"flex items-center text-sm\">\n                <SettingOutlined />\n                血庫備血審查作業\n              </div>\n            </Menu.Item>\n          </SubItem>\n        )}\n        <Item\n          key={routes.REPORT_INQUIRY}\n          onClick={handleTo(routes.REPORT_INQUIRY)}\n          className={getMenuClassName(routes.REPORT_INQUIRY)}>\n          <div className=\"flex items-center text-base\">\n            <SettingOutlined />\n            輸入報告\n          </div>\n        </Item>\n        <SubItem\n          key={routes.REPORT_TEMPLATE_LIST}\n          className={getMenuClassName(routes.REPORT_TEMPLATE_LIST)}\n          popupOffset={[-14, 0]}\n          popupClassName=\"rounded\"\n          title={\n            <div className=\"flex items-center text-base\">\n              <SettingOutlined />\n              報告模版\n              {!isMobile && <CaretDownOutlined className=\"ml-2 mr-0\" />}\n            </div>\n          }>\n          <Menu.Item\n            key={routes.REPORT_TEMPLATE_LIST}\n            onClick={handleTo(routes.REPORT_TEMPLATE_LIST)}\n            className={getMenuClassName(routes.REPORT_TEMPLATE_LIST)}>\n            <div className=\"flex items-center text-sm\">\n              <SettingOutlined />\n              結構式報告模版\n            </div>\n          </Menu.Item>\n          <Menu.Item\n            key={routes.PHRASE_LIST}\n            onClick={handleTo(routes.PHRASE_LIST)}\n            className={getMenuClassName(routes.PHRASE_LIST)}>\n            <div className=\"flex items-center text-sm\">\n              <SettingOutlined />\n              片語模版\n            </div>\n          </Menu.Item>\n        </SubItem>\n        <Item\n          key={routes.IMAGE_VIEWER_TUTORIAL}\n          onClick={handleTo(routes.IMAGE_VIEWER_TUTORIAL)}\n          className={getMenuClassName('outside')}>\n          <div className=\"flex items-center text-base\">\n            <SettingOutlined />\n            醫學影像教學平台\n          </div>\n        </Item>\n      </Menu>\n    )\n  }\n\n  const showMenu = !user.isClinician\n\n  return (\n    <>\n      {logoutModalVisible && (\n        <LogoutConfirmModal\n          onOk={handleLogout as any}\n          onCancel={handleLogoutModalVisible}\n        />\n      )}\n      {isOpen && (\n        <Drawer\n          visible\n          placement=\"left\"\n          bodyStyle={{ paddingLeft: 0 }}\n          closable={false}\n          onClose={setIsOpen}>\n          {renderMenu({ mode: 'vertical' })}\n        </Drawer>\n      )}\n      <Header>\n        <div className=\"flex items-center justify-between\">\n          {isMobile && (\n            <>\n              <MenuOutlined\n                className=\"text-white text-2xl\"\n                onClick={setIsOpen}\n              />\n              <Logo onClick={handleLogoClick}>\n                <img\n                  src={`${envStore.publicUrl}/images/logo-sm@2x.png`}\n                  alt=\"app-logo\"\n                  className=\"cursor-pointer\"\n                />\n              </Logo>\n              <div className=\"flex items-center text-white\">\n                <div>Hi, {user.name}</div>\n                <LogoutOutlined\n                  className=\"text-white text-base ml-2\"\n                  onClick={handleLogoutModalVisible}\n                  style={{ marginRight: 0 }}\n                />\n              </div>\n            </>\n          )}\n          {!isMobile && (\n            <>\n              <div className=\"flex items-center\">\n                <Logo onClick={handleLogoClick}>\n                  <img\n                    src={`${envStore.publicUrl}/images/logo-sm@2x.png`}\n                    alt=\"app-logo\"\n                    className=\"cursor-pointer\"\n                  />\n                </Logo>\n                {renderMenu()}\n              </div>\n              <div className=\"flex items-center\">\n                {!envStore.useOAuth && (\n                  <>\n                    <Select\n                      bordered={false}\n                      placeholder=\"管理者\"\n                      className=\"text-white\"\n                      style={{ width: 96, marginRight: -30 }}\n                      suffixIcon={false}\n                      defaultValue={user.isAdmin ? 1 : 0}\n                      onChange={handleRoleChange}>\n                      <Select.Option value={1}>管理者</Select.Option>\n                      <Select.Option value={0}>使用者</Select.Option>\n                    </Select>\n                    <Select\n                      bordered={false}\n                      placeholder=\"切換身分\"\n                      className=\"text-white\"\n                      style={{ width: 100, marginRight: -20 }}\n                      suffixIcon={false}\n                      defaultValue={user.division}\n                      onChange={handleUserChange}>\n                      <Select.Option value={Divisions.RAD}>\n                        放射科\n                      </Select.Option>\n                      <Select.Option value={Divisions.PATH}>\n                        病理科\n                      </Select.Option>\n                      <Select.Option value={Divisions.CLINICIAN}>\n                        臨床\n                      </Select.Option>\n                    </Select>\n                  </>\n                )}\n                <div className=\"flex items-center text-white\">\n                  <div className=\"mr-2\">Hi, {user.name}</div>\n                  <UserOutlined\n                    className=\"text-white text-xl\"\n                    style={{ marginRight: 0 }}\n                    onClick={handleLogoutModalVisible}\n                  />\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n        <div className=\"mt-3 ml-4 pb-0 flex justify-between\">\n          <Breadcrumb\n            separator=\">\"\n            style={{ minHeight: 32, display: 'flex', alignItems: 'center' }}>\n            <Breadcrumb.Item onClick={handleTo('/')}>\n              <HomeOutlined className=\"relative\" style={{ top: -4 }} />\n            </Breadcrumb.Item>\n            {items.map((x, idx) => (\n              <Breadcrumb.Item\n                key={`breadcrumb-${idx}`}\n                onClick={handleTo(x.href)}>\n                {x.name}\n              </Breadcrumb.Item>\n            ))}\n          </Breadcrumb>\n          {content}\n        </div>\n      </Header>\n    </>\n  )\n}\n\nconst Header = styled(Layout.Header)`\n  &.ant-layout-header {\n    height: auto;\n    padding: 16px 1.7rem 10px 2.1rem;\n    background: ${p => `linear-gradient(-90deg, #42c2b8, ${p.theme.primary})`};\n    color: ${p => p.theme.primary};\n    box-shadow: 0 0 20px ${p => p.theme.purple150};\n  }\n\n  .anticon {\n    cursor: pointer;\n  }\n`\n\nconst MenuItem = styled(Menu.Item)`\n  &.ant-menu-item {\n    margin: 0 2px !important;\n    padding: 0 10px !important;\n    border-radius: 6px;\n    border-bottom: none !important;\n    color: #fff;\n\n    &.is--current,\n    &:hover {\n      color: #fff !important;\n      background: rgba(24, 144, 138, 1) !important;\n    }\n  }\n\n  &.ant-menu-item-selected {\n    color: #fff !important;\n  }\n`\n\nconst SubMenu = styled(Menu.SubMenu)`\n  &.ant-menu-submenu {\n    margin: 0 5px !important;\n    padding: 0 15px !important;\n    border-radius: 6px;\n    border-bottom: none !important;\n\n    .ant-menu-submenu-title {\n      color: #fff;\n    }\n\n    &.is--current,\n    &:hover {\n      background: rgba(24, 144, 138, 1) !important;\n    }\n  }\n`\n\nconst Logo = styled.div``\n","import React from 'react'\n\nexport default React.lazy(() => import('./home'))\n\nexport const Home = React.lazy(() => import('./home'))\n","import React from 'react'\nimport { Switch, Route } from 'react-router-dom'\nimport Store from 'store'\nimport { Layout } from 'antd'\nimport { createGlobalStyle } from 'styled-components'\nimport ErrorBoundary from '@/components/error-boundary'\nimport Exception from '@/components/exception'\nimport Loading from '@/components/loading'\nimport AppHeader from '@/components/app-header'\nimport { useRoutes, RouteItem } from '@/constants/routes'\nimport { User } from '@/constants/types'\nimport Home from '@/containers/home'\n// import Login from '@/containers/login'\nimport useAuth from '@/hooks/useAuth'\nimport { queryString } from '@/utils/webHelper'\nimport history from '@/utils/history'\n\nconst GlobalStyles = createGlobalStyle`\n  body {\n    font-family: Roboto, '微軟正黑體', 'Microsoft JhengHei', sans-serif,\n      -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\n      Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',\n      'Segoe UI Symbol', 'Noto Color Emoji';\n    font-size: 1rem;\n    background: #f9f9fb;\n    color: #777;\n    line-height: 1.5;\n    padding: 0;\n  }\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    font-weight: 600;\n    font-family: Roboto, '微軟正黑體', 'Microsoft JhengHei', sans-serif,\n      -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\n      Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',\n      'Segoe UI Symbol', 'Noto Color Emoji';\n    margin-bottom: 0.75rem;\n  }\n\n  .ant-btn.c-btn {\n    border-radius: 4px;\n    font-weight: 500;\n  }\n\n  .c-btn.is--danger {\n    color: #d74c4c;\n    border: 1.3px solid #d74c4c;\n    background: #fff;\n  }\n\n  .c-btn.is--danger:focus,\n  .c-btn.is--danger:active,\n  .c-btn.is--danger:hover {\n    color: #fff;\n    background: #d74c4c;\n    border: 1.3px solid #d74c4c;\n  }\n\n  .c-btn.is--primary {\n    color: #fff;\n    border-color: #2d3159;\n    background: #2d3159;\n  }\n\n  .c-btn.is--primary:hover,\n  .c-btn.is--primary:focus,\n  .c-btn.is--primary:active {\n    color: #fff;\n    background: #2d3159;\n    border-color: #2d3159;\n  }\n\n  .c-btn.is--outline {\n    color: #2d3159;\n    border-color: #2d3159;\n    background: transparent;\n  }\n\n  .c-btn.is--outline:hover,\n  .c-btn.is--outline:focus,\n  .c-btn.is--outline:active {\n    color: #fff;\n    background: #2d3159;\n    border-color: transparent;\n  }\n\n  .ant-modal,\n  .ant-modal-confirm {\n    animation-duration: 0s !important;\n    transition: none !important;\n  }\n\n  .ant-picker-header-view button:hover,\n  .anticon.c-icon:hover,\n  .ant-picker-today-btn {\n    color: #38a8a9 !important;\n  }\n\n  .ant-picker-cell-in-view.ant-picker-cell-today .ant-picker-cell-inner::before {\n    border-color: #38a8a9 !important;\n  }\n\n  .ant-picker-ok .ant-btn-primary,\n  .ant-picker-cell-in-view.ant-picker-cell-selected .ant-picker-cell-inner,\n  .ant-picker-cell-in-view.ant-picker-cell-range-start .ant-picker-cell-inner,\n  .ant-picker-cell-in-view.ant-picker-cell-range-end .ant-picker-cell-inner {\n    border-color: #38a8a9 !important;\n    background: #38a8a9 !important;\n  }\n\n  .ant-picker-ok .ant-btn-primary {\n    color: #fff !important;\n  }\n\n  .ant-menu.ant-menu-submenu-popup .ant-menu-item:hover {\n    color: #38a8a9 !important;\n  }\n\n  .ant-menu.ant-menu-submenu-popup\n    .ant-menu:not(.ant-menu-horizontal)\n    .ant-menu-item-selected {\n    background: rgba(5, 124, 147, 0.6) !important;\n    color: #fff !important;\n  }\n\n  .DraggableItem.draggable div {\n    cursor: grab !important;\n  }\n\n  .DraggableItem.draggable.dragging div {\n    cursor: grabbing !important;\n  }\n\n  .DraggableArea {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n  }\n\n  .DraggableArea .Overlay {\n    position: fixed;\n    z-index: 999;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    background: rgba(0, 0, 0, 0.1);\n  }\n\n  .is--hide {\n    transition: opacity 0.5s ease-out;\n    opacity: 0;\n    height: 0;\n    overflow: hidden;\n  }\n\n  .is--visible {\n    transition: opacity 0.5s ease-out;\n    opacity: 1;\n    height: auto;\n  }\n\n  .d2h-file-header {\n    display: none;\n  }\n\n  .d2h-file-name-wrapper {\n    background: #fff;\n  }\n\n  .d2h-file-wrapper {\n    border: none;\n    border-radius: 0;\n    border-bottom-right-radius: 0.5rem;\n    border-bottom-left-radius: 0.5rem;\n  }\n\n  select[class='template-cloze__select'] {\n    color: #9e9e9e !important;\n  }\n\n  select[class='template-cloze__select'] option:not(:first-of-type) {\n    color: black !important;\n  }\n\n  .mce-ico.mce-i-far,\n  .mce-ico.mce-i-fas {\n    display: inline-block;\n    font-family: 'Font Awesome 5 Free';\n    font-weight: 900;\n    text-rendering: auto;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n`\n\nfunction App() {\n  const { isAuthenticated, setUser, setIsAuthenticated } = useAuth()\n\n  const routes = useRoutes()\n\n  const renderRouteItem = React.useCallback((item: RouteItem) => {\n    const path = `${item.path}${item.param ? `/${item.param}` : ''}`\n\n    return (\n      <Route\n        exact\n        key={item.id}\n        path={path}\n        component={\n          item.component ? item.component : () => <h1> {item.title} </h1>\n        }\n      />\n    )\n  }, [])\n\n  const renderRoute: any = React.useCallback(\n    (data: RouteItem[]) => {\n      return data.map((item: RouteItem) => {\n        return [\n          renderRouteItem(item),\n          item.children && renderRoute(item.children),\n          item.hide && renderRoute(item.hide),\n        ]\n      })\n    },\n    [renderRouteItem]\n  )\n\n  const user = queryString(history.location.search)\n\n  React.useEffect(() => {\n    if (user.userid) {\n      const loginUser = {\n        ...user,\n        id: user.userid,\n        name: user.user,\n        isClinician: user.division === 'guest',\n        isAdmin: user.division === 'MANAGER',\n        viewDivision: false,\n        expiredAt: new Date(),\n      } as User\n\n      setIsAuthenticated(true)\n      setUser(loginUser)\n\n      Store.set('vghks_user', loginUser)\n      history.push('/')\n    }\n  }, [JSON.stringify(user)]) // eslint-disable-line\n\n  return (\n    <ErrorBoundary>\n      <GlobalStyles />\n      {!isAuthenticated && (\n        <div className=\"flex items-center justify-center\">\n          <Loading className=\"mr-2\" />\n          <div className=\"relative\" css={{ top: 3 }}>\n            登入中...\n          </div>\n        </div>\n      )}\n      {isAuthenticated && (\n        <Layout>\n          <AppHeader />\n          <React.Suspense fallback={<Loading />}>\n            <Switch>\n              <Route exact path=\"/\" component={Home} />\n              {renderRoute(routes)}\n              <Route component={Exception} />\n            </Switch>\n          </React.Suspense>\n        </Layout>\n      )}\n    </ErrorBoundary>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import './bootstrap'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Router } from 'react-router-dom'\nimport { DndProvider } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\nimport { RecoilRoot, MutableSnapshot } from 'recoil'\nimport { ConfigProvider } from 'antd'\nimport zhTW from 'antd/lib/locale/zh_TW'\nimport { ThemeProvider } from 'styled-components'\nimport { SWRConfig } from 'swr'\nimport request from '@/utils/request'\nimport history from '@/utils/history'\nimport { createPack } from '@/utils/createPack'\nimport { redirect } from '@/utils/webHelper'\nimport { AuthProvider, useAuth } from '@/hooks/useAuth'\nimport App from './app'\nimport theme from './theme'\nimport * as serviceWorker from './serviceWorker'\nimport './index.css'\n\nredirect()\n\nconst initializeState = ({ set }: MutableSnapshot) => {\n  const { user } = (useAuth as any)()\n  set({ key: 'userState' } as any, user)\n  // for(const [key, value] of Storage.entries()) {\n  //   set(myLookupOfAtomWithKey(key), JSON.parse(value).value);\n  // }\n}\n\nconst EnhancedApp = createPack(\n  <ThemeProvider theme={theme} />,\n  <ConfigProvider locale={zhTW} />,\n  <AuthProvider />,\n  <RecoilRoot initializeState={initializeState} />,\n  <SWRConfig\n    value={{ suspense: true, fetcher: request, revalidateOnFocus: false }}\n  />,\n  <DndProvider backend={HTML5Backend} />,\n  <Router history={history} />\n)\n\n// ReactDOM.unstable_createRoot(document.getElementById('root') as any).render(\n//   <EnhancedApp>\n//     <App />\n//   </EnhancedApp>\n// )\nReactDOM.render(\n  <EnhancedApp>\n    <App />\n  </EnhancedApp>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import React from 'react'\nimport { is, isNil, identity, always, ifElse } from 'ramda'\nimport _useSWR from 'swr'\nimport {\n  keyInterface,\n  fetcherFn,\n  ConfigInterface,\n  responseInterface,\n} from 'swr/dist/types'\nimport { QueryVariables } from '@/constants/types'\nimport { request, RequestInit, format, toQueryString } from '@/utils/request'\n\ninterface Response<Data = any, Error = any>\n  extends responseInterface<Data, Error> {\n  loading: boolean\n  called: boolean\n  refetch(variables?: QueryVariables): Promise<any>\n}\n\ninterface Config<Data = any, Error = any> extends ConfigInterface<Data, Error> {\n  variables?: { [key: string]: any }\n  lazy?: boolean\n  fetchOptions?: RequestInit\n  onCompleted?: (data: Data) => void\n  onError?: (error: Error) => void\n}\n\nexport default function useSWR<Data = any, Error = any>(\n  key: keyInterface,\n  {\n    variables,\n    onCompleted,\n    onError,\n    lazy = false,\n    fetchOptions,\n    ...config\n  }: Config<Data, Error> = {},\n  fn?: fetcherFn<Data>\n): Response<Data, Error> {\n  const [query, setQuery] = React.useState(variables)\n\n  const [called, setIsCalled] = React.useState(!lazy)\n\n  const val = React.useRef<Data>()\n\n  const _fn = ifElse(\n    isNil,\n    always((url: any) => request(url, { throwable: true, ...fetchOptions })),\n    identity\n  )(fn)\n\n  let _key = key\n  if (is(String, key)) {\n    const { fullUrl, params } = format(key as string, query)\n    _key = `${fullUrl}?${toQueryString(params)}`\n  }\n  if (!called) {\n    _key = null\n  }\n\n  const { data, ...rest } = _useSWR(_key, _fn, {\n    ...config,\n    dedupingInterval: 0,\n    revalidateOnFocus: false,\n    shouldRetryOnError: false,\n    suspense: false,\n    onSuccess: data => {\n      if (onCompleted) {\n        onCompleted(data)\n      }\n    },\n    onError: error => {\n      if (onError) {\n        onError(error)\n      }\n    },\n  })\n\n  const refetch = (variables: QueryVariables = {}) => {\n    setQuery(prev => ({ ...prev, ...variables }))\n    setIsCalled(true)\n\n    return Promise.resolve<any>({})\n  }\n\n  if (data !== undefined) {\n    val.current = data\n  }\n\n  return {\n    ...rest,\n    loading: rest.isValidating,\n    data: val.current,\n    refetch,\n    called,\n  }\n}\n","import React from 'react'\nimport { Checkbox } from 'antd'\nimport { CheckboxProps } from 'antd/lib/checkbox'\nimport styled from 'styled-components'\nimport { RefProps } from '@/constants/types'\n\nconst CheckboxGroup = Checkbox.Group\n\nconst StyledCheckbox = styled(Checkbox)`\n  .ant-checkbox-checked .ant-checkbox-inner {\n    background-color: ${p => p.theme.primary};\n    border-color: ${p => p.theme.primary};\n  }\n\n  &.ant-checkbox-wrapper:hover .ant-checkbox-inner,\n  .ant-checkbox:hover .ant-checkbox-inner,\n  .ant-checkbox-input:focus + .ant-checkbox-inner {\n    border-color: ${p => p.theme.primary};\n  }\n\n  .ant-checkbox-checked .ant-checkbox-inner:after {\n    border: 2px solid #fff;\n    border-top: 0;\n    border-left: 0;\n  }\n\n  .ant-checkbox-inner {\n    border: 1px solid ${p => p.theme.darkGrey};\n  }\n\n  &.is--normal {\n    font-size: 14px !important;\n    font-weight: normal !important;\n  }\n`\n\ntype Props = RefProps & CheckboxProps\n\nconst CheckboxComponent: React.ElementType<Props> = React.forwardRef<\n  typeof StyledCheckbox,\n  Props\n>(({ ...props }, ref) => <StyledCheckbox forwardRef={ref} {...props} />)\n\nCheckboxComponent.displayName = 'Checkbox'\n\nexport { CheckboxComponent as Checkbox, CheckboxGroup }\n\nexport default CheckboxComponent\n","import React from 'react'\nimport styled from 'styled-components'\nimport { Modal } from 'antd'\nimport { ModalProps } from 'antd/lib/modal'\n\nconst StyledModal = styled(Modal)`\n  animation-duration: 0s !important;\n  transition: none !important;\n\n  .ant-modal-header--border-none {\n    border-bottom: none;\n  }\n\n  .ant-modal-footer {\n    padding-top: 14px;\n    padding-bottom: 14px;\n  }\n`\n\nexport default class ModalComponent extends React.Component<ModalProps, any> {\n  static confirm = Modal.confirm\n  static error = Modal.error\n  static success = Modal.success\n  static info = Modal.info\n\n  render() {\n    return <StyledModal {...this.props}>{this.props.children}</StyledModal>\n  }\n}\n","import React from 'react'\nimport { Modal } from 'antd'\nimport { ModalProps, ModalFuncProps } from 'antd/lib/modal'\n\nexport const modalDefaultProps = (\n  content?: React.ReactNode,\n  props?: ModalProps\n): ModalFuncProps => ({\n  content: (\n    <div\n      className=\"text-darkGrey font-medium\"\n      css={{ marginTop: 16, marginBottom: 30 }}>\n      {content}\n    </div>\n  ),\n  icon: null,\n  width: 440,\n  okText: '刪除',\n  cancelText: '取消',\n  centered: true,\n  // maskStyle: {\n  //   background: theme.modal.maskDarken,\n  // },\n  autoFocusButton: null,\n  okButtonProps: {\n    className: 'c-btn is--danger',\n    style: { minWidth: 80, marginRight: 24 },\n  },\n  cancelButtonProps: {\n    className: 'c-btn is--outline mr-0 float-right',\n    style: { minWidth: 80 },\n  },\n  ...props,\n})\n\nexport const success = ({\n  onOk,\n  onCancel,\n  content = '資料已儲存',\n  ...props\n}: ModalFuncProps) => {\n  Modal.info({\n    ...modalDefaultProps(),\n    ...props,\n    onOk: () => {\n      if (onOk) {\n        onOk()\n      }\n    },\n    onCancel() {\n      if (onCancel) {\n        onCancel()\n      }\n    },\n  })\n}\n\nexport const confirm = ({\n  onOk,\n  onCancel,\n  content = '刪除後將無法還原，確認繼續？',\n  ...props\n}: ModalFuncProps) => {\n  Modal.confirm({\n    ...modalDefaultProps(content),\n    ...props,\n    onOk: () => {\n      if (onOk) {\n        onOk()\n      }\n    },\n    onCancel() {\n      if (onCancel) {\n        onCancel()\n      }\n    },\n  })\n}\n","import { Collapse } from 'antd'\nimport styled from 'styled-components'\n\nconst borderRadius = '8px'\n\nconst StyledCollapse = styled(Collapse)`\n  &.ant-collapse {\n    border-radius: ${borderRadius};\n    border-bottom: none;\n\n    > .ant-collapse-item > .ant-collapse-header {\n      padding-left: 0;\n      background: ${p => p.theme.primary};\n      color: #fff;\n    }\n\n    &.header-pl-clear > .ant-collapse-item > .ant-collapse-header {\n      padding-left: 16px;\n    }\n\n    > .ant-collapse-item:first-child > .ant-collapse-header {\n      border-top-left-radius: ${borderRadius};\n      border-top-right-radius: ${borderRadius};\n    }\n\n    > .ant-collapse-item:last-child {\n      border-bottom: none;\n    }\n\n    > .ant-collapse-item:last-child > .ant-collapse-content {\n      border-bottom-left-radius: ${borderRadius};\n      border-bottom-right-radius: ${borderRadius};\n    }\n\n    > .ant-collapse-item.ant-collapse-item-active:last-child {\n      border-bottom: 1px solid #d9d9d9;\n    }\n\n    > .ant-collapse-item:not(.ant-collapse-item-active):last-child\n      > .ant-collapse-header {\n      border-bottom-left-radius: ${borderRadius};\n      border-bottom-right-radius: ${borderRadius};\n    }\n  }\n`\n\nexport default StyledCollapse\n","import React from 'react'\nimport { atom } from 'recoil'\nimport moment from 'moment'\nimport Store from 'store'\nimport {\n  cond,\n  T,\n  isNil,\n  path,\n  length,\n  keys,\n  pathOr,\n  map,\n  is,\n  mergeAll,\n  flatten,\n  values,\n  equals,\n  __,\n  ifElse,\n  head,\n  always,\n  of,\n  omit,\n  sortBy,\n  last,\n  find,\n  propEq,\n  identity,\n  filter,\n  or,\n  and,\n} from 'ramda'\nimport cheerio from 'cheerio'\nimport {\n  Mutation,\n  MutationOptions,\n  SnippetProps,\n  QueryVariables,\n  ReportTemplate,\n  MedicalOrder,\n  ReportClozeTemplateQueryResult,\n  ReportTopicTemplateQueryResult,\n} from '@/constants/types'\nimport { useConvertReportTemplate } from '@/services/report-template'\nimport useAuth from '@/hooks/useAuth'\nimport useSWR from '@/hooks/useSWR'\nimport useQuery from '@/hooks/useQuery'\nimport { setComponentByTab } from '@/components/snippet-template-list'\nimport { uuid, downloadAsJson } from '@/utils/webHelper'\nimport { useRequest, request } from '@/utils/request'\nimport { Divisions, reportStatus, reportStatusEnums } from '@/constants/enums'\nconst { compose } = require('ramda')\n\n/**\n * POST /api/v1/b21/getPathologyInfoByORREQNO 醫囑 \n   POST /api/v1/b21/getPathReportInfoByORREQNO 報告明細 C-2-1 C-2-1-1\n   POST /api/v1/b31/getRpphhistResult 黃卡檢索\n   POST /api/v1/c21/createPathReport 新增報告\n   POST /api/v1/c/getCodeBooksByKeyword 取得編碼清單\n   POST /api/v1/c21/createPathReport\n */\nexport type Report = {\n  csect: string\n  hbed: string\n  hhisnum: string\n  hnamec: string\n  hnursta: string\n  hsex: string\n  ordclnm: string\n  orreqno: string\n  orstatus: string\n  orworkno: string\n  zrsregord: string\n}\n\nexport type ReportDetailQueryResult = {\n  topic: ReportTopicTemplateQueryResult\n  cloze: ReportClozeTemplateQueryResult\n  csect: string\n  hbed: string\n  hhisnum: string\n  hnamec: string\n  hnursta: string\n  hsex: string\n  orreqno: number\n  orword: string\n  orworkno: string\n  rsverno: number\n  templateId: number\n  templateName: string\n}\n\nexport const reportListState = atom({\n  key: 'reportListState',\n  default: setComponentByTab(Store.get('reportListState') || []),\n})\n\n// 輸入報告清單\nexport function useReportList(variables: QueryVariables = {}) {\n  const { user } = useAuth()\n\n  // 放射 點選欄位中的三角形圖案排序該欄位。預設排序欄位為檢查日期 ordate\n  // 病理 點選欄位中的三角形符號，可排序該欄位，預設以病歷號排序 hhisnum\n\n  const url = ifElse(\n    equals(__, Divisions.PATH),\n    always('/api/v1/b2/getPathologyResult'),\n    always('/api/v1/b1/getRdReportList')\n  )(user.division)\n\n  const { data, ...rest } = useQuery(url, {\n    method: 'POST',\n    variables,\n  })\n\n  const isRad = user.division === Divisions.RAD\n\n  return {\n    ...rest,\n    data: compose(\n      sortBy(x => (isRad ? x.ordate : x.hhisnum)),\n      pathOr([], [])\n    )(data) as Report[],\n  }\n}\n\nexport function useYellowCards(variables: QueryVariables = {}) {\n  const { data, ...rest } = useQuery(`/api/v1/b31/getRpphhistResult`, {\n    method: 'POST',\n    variables,\n  })\n\n  return {\n    ...rest,\n    data: pathOr([], [], data) as Report[],\n  }\n}\n\nexport function useReport(variables: QueryVariables = {}) {\n  const { user } = useAuth()\n\n  const url = ifElse(\n    equals(__, Divisions.PATH),\n    always('/api/v1/b21/getPathReportInfoByORREQNO'),\n    always('/api/v1/b1/getRdReport/{ORREQNO}')\n  )(user.division)\n\n  const { data, ...rest } = useQuery(url, {\n    method: user.division === Divisions.PATH ? 'POST' : 'GET',\n    lazy: false,\n    variables,\n  })\n\n  return {\n    ...rest,\n    data: compose(\n      pathOr({}, []),\n      ifElse(is(Array), head, identity),\n      pathOr([], [])\n    )(data) as ReportDetailQueryResult,\n  }\n}\n\nexport function useMedicalOrder({ id }: QueryVariables = {}) {\n  const [orreqno, setORReqno] = React.useState(id)\n\n  const { user } = useAuth()\n  const url = `/api/v1/b21/getPathologyInfoByORREQNO`\n\n  const fetcher = (_url: string, ...args: any) =>\n    request(_url, {\n      ...args,\n      method: 'POST',\n      body: {\n        ORREQNO: orreqno,\n      },\n    })\n\n  const { data, refetch, ...rest } = useSWR(\n    orreqno && user.division === Divisions.PATH ? url : null,\n    {},\n    fetcher\n  )\n\n  const _refetch = (orreqno: string) => {\n    setORReqno(orreqno)\n    refetch({ ORREQNO: orreqno })\n  }\n\n  return {\n    ...rest,\n    refetch: _refetch,\n    loadingM: rest.loading,\n    data: compose(\n      (val: MedicalOrder) => ({\n        ...val,\n        orstatuscode:\n          val?.orstatus === '完成'\n            ? reportStatus.FINISH\n            : val?.orstatus === '取消'\n            ? reportStatus.CANCEL\n            : val?.orstatus === '已輸入'\n            ? reportStatus.TYPED\n            : reportStatus.UNTYPE,\n      }),\n      head,\n      pathOr([], [])\n    )(data) as MedicalOrder | null,\n  }\n}\n\nexport function useCreateOrUpdateReportAPI(options: MutationOptions = {}) {\n  const { user } = useAuth()\n\n  const url = ifElse(\n    equals(__, Divisions.PATH),\n    always('/api/v1/c21/createPathReport'),\n    always('/api/v1/c11/creactRdReport')\n  )(user.division)\n\n  const { loading, mutate } = useRequest(url, {\n    ...options,\n    lazy: true,\n    method: 'POST',\n  })\n\n  return [loading, mutate] as Mutation\n}\n\nexport const useReports = (variables: QueryVariables = {}) => {\n  const { data, ...rest } = useReportList(variables)\n\n  const dataSource = {\n    content: ifElse(\n      is(Array),\n      map((s: Report) => ({ ...s, id: uuid() })),\n      always([])\n    )(data),\n    total: length(data),\n    totalPages: Math.floor(length(data) / 10) + 1,\n  }\n\n  return {\n    ...rest,\n    dataSource,\n    data: dataSource,\n  }\n}\n\nconst isoRe = new RegExp(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}Z$/)\n\nconst useConvertData = () => {\n  const convertData = useConvertReportTemplate()\n\n  return compose(\n    (report: ReportTemplate) => ({\n      ...report,\n      status: compose(\n        pathOr(undefined, ['id']),\n        find(propEq('name', report.orstatus))\n      )(reportStatusEnums),\n      data: compose(\n        mergeAll,\n        filter(Boolean),\n        map((x: SnippetProps) => ({\n          [x.id]: compose(\n            cond([\n              [isNil, always(undefined)],\n              [equals(__, 'undefined'), always(undefined)],\n              [\n                v =>\n                  and(\n                    or(x.type === 'TemplateDate', x.type === 'TemplateTime'),\n                    or(\n                      isoRe.test(v),\n                      moment(v, 'YYYY/MM/DD HH:mm:ss').isValid()\n                    )\n                  ),\n                v => always(moment(new Date(v as any).toISOString())),\n              ],\n              [T, identity],\n            ]),\n            path(['value'])\n          )(x),\n        })),\n        flatten,\n        values,\n        pathOr({}, ['setting'])\n      )(report),\n    }),\n    convertData,\n    (_data: ReportDetailQueryResult) => ({\n      data: {\n        template: of({\n          ...omit(['topic', 'cloze'])(_data),\n          id: _data?.orreqno,\n        }),\n        cloze: _data.cloze,\n        topic: _data.topic,\n      },\n    })\n  )\n}\n\nexport function useReportItem({ id, ...props }: QueryVariables = {}) {\n  const { data, ...rest } = useReport({\n    ...props,\n    ORREQNO: id,\n  })\n\n  const convertData = useConvertData()\n\n  const _data = convertData(data) as ReportTemplate\n\n  return {\n    ...rest,\n    loadingData: rest.loading,\n    data: _data,\n    item: _data,\n  }\n}\n\nexport function useReportComparision() {\n  const { data, ...rest } = useSWR(\n    `/api/v1/b22/getCompareReportVersionByORREQNO/{orreqno}`,\n    {\n      lazy: true,\n    }\n  )\n\n  const convertData = useConvertData()\n  const _head = compose(pathOr({}, []), head, pathOr([], []))\n  const _last = compose(pathOr({}, []), last, pathOr([], []))\n\n  const latest = compose(convertData, _head)(data)\n  const previous = compose(convertData, _last)(data)\n\n  return {\n    ...rest,\n    data,\n    previous: previous as ReportTemplate,\n    latest: latest as ReportTemplate,\n  }\n}\n\nconst useMakeRequestPayload = () => {\n  const { user } = useAuth()\n\n  const getHtmlValue = (html: string) => {\n    const $ = cheerio.load(html)\n\n    const results: string[] = []\n\n    $('input').each((_, el) => results.push($(el).val()))\n    $('select').each((_, el) => results.push($(el).val()))\n\n    // return result.join(',')\n    return results\n  }\n\n  return ({ setting, data, ...values }: any) => ({\n    ...values,\n    // data, // we won't save data into db.\n    status: values.status || reportStatus.TYPED, // 60 means already typed\n    user: user.name,\n    template: compose(\n      flatten,\n      map((key: string) =>\n        compose(\n          map((s: SnippetProps) => ({\n            ...s,\n            ...s.setting,\n            ...(s.inline\n              ? {\n                  clozeId: s.id,\n                  html: encodeURIComponent(s.html),\n                  values: compose(\n                    map((value: string) => ({ value })),\n                    getHtmlValue,\n                    pathOr('', ['html'])\n                  )(s),\n                }\n              : {\n                  topicId: s.id,\n                  toolTip: s.setting.tooltip,\n                  value: s.setting.value,\n                }),\n            tab: key,\n            categoryName: s.inline ? 'cloze' : 'topic',\n          })),\n          pathOr([], [key])\n        )(setting)\n      ),\n      keys\n    )(setting),\n  })\n}\n\nexport const useCreateOrUpdateReport = (options: MutationOptions = {}) => {\n  const [loading, mutate] = useCreateOrUpdateReportAPI(options)\n  const makeRequestPayload = useMakeRequestPayload()\n\n  const hanlder = (values: any) => {\n    // console.log(makeRequestPayload(values))\n    // return Promise.resolve({})\n    console.log(values)\n    return mutate(makeRequestPayload(values))\n  }\n\n  return [loading, hanlder] as Mutation\n}\n\nexport const useReportJson = (variables: QueryVariables = {}) => {\n  const { user } = useAuth()\n\n  const { data, ...rest } = useQuery(\n    (variables.orreqno ? '/api/v1/c/getJsonDownloadInfo' : null) as any,\n    {\n      variables: {\n        ...variables,\n        division: user.division,\n      },\n      method: 'POST',\n      lazy: false,\n    }\n  )\n\n  const convertData = useConvertData()\n\n  const _data = compose(\n    convertData,\n    pathOr({}, []),\n    ifElse(is(Array), head, identity),\n    pathOr([], [])\n  )(data) as ReportTemplate\n\n  return {\n    ...rest,\n    loadingData: rest.loading,\n    data: _data,\n    item: _data,\n    json: _data,\n  }\n}\n\nexport const useExportReportJson = (options: MutationOptions = {}) => {\n  const { loading, mutate } = useRequest(`/api/v1/c/getJsonDownloadInfo`, {\n    ...options,\n    method: 'POST',\n    lazy: true,\n  })\n\n  const handler = async ({\n    filename,\n    ...values\n  }: {\n    filename: string\n    orreqno: string\n    divison: string\n  }) => {\n    const response = await mutate(values)\n\n    downloadAsJson({\n      filename: `${filename}_${moment().format('YYYYMMDDHHmmss')}`,\n      json: response,\n    })\n\n    return response\n  }\n\n  return [loading, handler] as Mutation\n}\n","import React from 'react'\nimport { includes, pathOr } from 'ramda'\nimport { XYCoord } from 'react-dnd'\nimport { isNil, mapIndexed, uuid } from '@/utils/webHelper'\nimport Snippet from '@/components/snippet'\nimport { SnippetProps } from '@/constants/types'\n\nconst { compose } = require('ramda')\n\nexport const defaultOptions = [\n  {\n    id: uuid(),\n    text: 'default option 1',\n    selected: true,\n    freetext: false,\n  },\n  {\n    id: uuid(),\n    text: 'default option 2',\n    selected: true,\n    freetext: false,\n  },\n  {\n    id: uuid(),\n    text: 'default option 3',\n    selected: true,\n    freetext: false,\n  },\n]\n\n/* prettier-ignore */\nconst REPORT_TEMPLATE_BUILDER_CLASSNAME = 'report-template-builder__main-content'\nconst UI_DRAGGABLE_CLASSNAME = 'ui-draggable'\n\nconst hasClassName = (nodes: Element[], className: string) => {\n  return nodes.find(\n    n => !isNil(n.className) && includes(className)(n.className)\n  )\n}\n\nexport function canMoveSnippet(\n  element: Element | null,\n  className = REPORT_TEMPLATE_BUILDER_CLASSNAME\n) {\n  let elem = element\n\n  const nodes: Element[] = []\n  nodes.push(elem as Element)\n\n  while (elem?.parentNode) {\n    nodes.unshift(elem.parentNode as Element)\n    elem = elem.parentNode as Element\n  }\n\n  if (\n    hasClassName(nodes, 'report-template-builder-contentarea--fixed-layout') ||\n    hasClassName(nodes, 'snippet-drawer-menu')\n  ) {\n    return false\n  }\n  if (\n    hasClassName(nodes, className) ||\n    hasClassName(nodes, UI_DRAGGABLE_CLASSNAME)\n  ) {\n    return true\n  }\n\n  return false\n}\n\nfunction findSnippet(\n  element: HTMLElement,\n  className = UI_DRAGGABLE_CLASSNAME\n): HTMLElement | null {\n  if (element.classList.contains(className)) {\n    return element\n  }\n  return element.parentElement && findSnippet(element.parentElement, className)\n}\n\nexport function getPlaceHolderIndex(clientOffset: XYCoord) {\n  const hoverElement = document.elementFromPoint(clientOffset.x, clientOffset.y)\n\n  // find ui-draggable classname\n  const overSnippet = findSnippet(hoverElement as NonNullable<HTMLElement>)\n\n  const snippetIndex = overSnippet && overSnippet.dataset.index\n  const placeholderIndex = overSnippet ? Number(overSnippet.dataset.index) : -1\n\n  const isOverSnippet = !isNil(snippetIndex)\n\n  return {\n    overSnippet,\n    placeholderIndex,\n    isOverSnippet: isOverSnippet,\n  }\n}\n\nexport function renderSnippets(props: { [key: string]: any } = {}) {\n  return (snippetList?: SnippetProps[]) =>\n    compose(\n      mapIndexed((item: SnippetProps, idx: number) => (\n        <Snippet\n          {...props}\n          key={item.id}\n          wrapperId={`${item.id}`}\n          item={item}\n          draggable={false}\n          tabSize={item.tabSize}>\n          {item.inline ? (\n            <div\n              id={`${item.id}`}\n              className={`${item.id}`}\n              css={{ padding: 16 }}\n              dangerouslySetInnerHTML={{ __html: item.html }}\n            />\n          ) : (\n            <item.Component\n              id={item.id}\n              className={item.id}\n              item={item}\n              index={idx}\n            />\n          )}\n        </Snippet>\n      )),\n      pathOr([], [])\n    )(snippetList)\n}\n","import React from 'react'\nimport { atom, useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil'\n\ntype BreadcrumbItem = {\n  href?: string\n  name: string\n}\n\nexport const breadcrumbState = atom<BreadcrumbItem[]>({\n  key: 'breadcrumbState',\n  default: [],\n})\n\nexport function useBreadcrumbState() {\n  const state = useRecoilState(breadcrumbState)\n  return state\n}\n\nexport function useBreadcrumb(items: BreadcrumbItem[] = []) {\n  const setter = useSetRecoilState(breadcrumbState)\n\n  React.useEffect(() => {\n    setter(items)\n  }, []) // eslint-disable-line\n\n  return setter\n}\n\nexport const headerContentState = atom<React.ReactNode>({\n  key: 'headerContentState',\n  default: null,\n})\n\nexport function useHeaderContentState() {\n  return useRecoilState(headerContentState)\n}\n\nexport function useHeaderContent(node?: React.ReactNode) {\n  const setter = useSetRecoilState(headerContentState)\n\n  React.useEffect(() => {\n    setter(node)\n\n    return () => {\n      setter(null)\n    }\n  }, [node]) // eslint-disable-line\n}\n\nexport function useHeaderContentValue() {\n  const value = useRecoilValue(headerContentState)\n  return value\n}\n","export { default } from '../theme'\n","import moment from 'moment'\nimport Store from 'store'\nimport { envStore } from '@/constants/env'\nimport { User } from '@/constants/types'\nconst {\n  forEach,\n  addIndex,\n  map,\n  isEmpty,\n  either,\n  compose,\n  not,\n  isNil: RisNil,\n  path,\n  is,\n} = require('ramda')\n\nexport function queryString(search?: string): { [key: string]: any } {\n  if (!search) {\n    search = window.location.search\n  }\n\n  const params = new URLSearchParams(search)\n\n  let result: object | any = {}\n\n  params.forEach((value: string, key: string) => (result[key] = value))\n\n  return result\n}\n\nexport function uuid() {\n  let d = Date.now()\n  if (\n    typeof performance !== 'undefined' &&\n    typeof performance.now === 'function'\n  ) {\n    d += performance.now()\n  }\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    const r = (d + Math.random() * 16) % 16 | 0\n    d = Math.floor(d / 16)\n    return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16)\n  })\n}\n\nexport function isUUID(uuid: string) {\n  return /^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(\n    uuid\n  )\n}\n\nexport const forEachIndexed = addIndex(forEach)\nexport const mapIndexed: any = addIndex(map)\n\nexport const isNil = either(isEmpty, RisNil)\n\nexport const hasPath = (namedPath: Array<string | number>) =>\n  compose(not, isNil, path(namedPath))\n\nexport const getRangeDate = (\n  date: [moment.Moment, moment.Moment],\n  dateFormat?: string\n) => {\n  const [startDate, stopDate] = date\n\n  return [\n    startDate\n      ? dateFormat\n        ? startDate.format(dateFormat)\n        : startDate.valueOf()\n      : undefined,\n    stopDate\n      ? dateFormat\n        ? stopDate.format(dateFormat)\n        : stopDate.valueOf()\n      : undefined,\n  ]\n}\n\nexport const toThousandSeparator = (number: number | string) => {\n  if (number && (typeof number === 'number' || isNaN(number as any))) {\n    return number.toLocaleString()\n  }\n  return number\n}\n\nexport const capitalize = (s: string) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nexport function getNumberFromString(str?: string) {\n  if (!str) {\n    return str\n  }\n  return str.replace(/[^\\d.]/g, '')\n}\n\nexport const redirect = () => {\n  const user = Store.get('vghks_user') as User\n\n  if (\n    !envStore.isEnvDev &&\n    window.location.pathname === '/' &&\n    envStore.appBaseName !== ''\n  ) {\n    window.location.href = envStore.appUrl\n    return\n  }\n\n  if (envStore.useOAuth && !user) {\n    window.location.href = envStore.oauthUrl\n    return\n  }\n}\n\nexport function downloadAsJson({\n  json,\n  filename,\n}: {\n  json: object\n  filename: string\n}) {\n  const dataStr =\n    'data:text/json;charset=utf-8,' +\n    encodeURIComponent(JSON.stringify(json, null, 2))\n  const downloadAnchorNode = document.createElement('a')\n  downloadAnchorNode.setAttribute('href', dataStr)\n  downloadAnchorNode.setAttribute('download', filename + '.json')\n  document.body.appendChild(downloadAnchorNode) // required for firefox\n  downloadAnchorNode.click()\n  downloadAnchorNode.remove()\n\n  return json\n}\n\nexport function selectFile({\n  accept = '*',\n  callback,\n}: {\n  accept?: string\n  callback?: (files: FileList | null) => any\n}) {\n  const input = document.createElement('input')\n  input.setAttribute('type', 'file')\n  input.setAttribute('class', 'hidden')\n  input.setAttribute('accept', accept)\n\n  if (callback) {\n    input.addEventListener('change', () => callback(input.files))\n  }\n\n  input.click()\n}\n\nexport async function readFile<T = any>(file: File): Promise<T> {\n  return new Promise((resolve, reject) => {\n    const fileReader = new FileReader()\n    fileReader.addEventListener('load', () => resolve(fileReader.result as any))\n    fileReader.onerror = reject\n    fileReader.readAsText(file)\n  })\n}\n\nexport const toMoment = (data: any) => {\n  if (!data) {\n    return data\n  }\n\n  if (moment.isMoment(data)) {\n    return data\n  }\n\n  let result\n\n  if (is(Number, data) || is(String, data) || is(Date, data)) {\n    result = moment(data)\n  }\n\n  if (result?.isValid()) {\n    return result\n  }\n\n  return data\n}\n\nexport const toDateString = (\n  data: any,\n  format: string = 'YYYY.MM.DD HH:mm:ss'\n) => {\n  const m = toMoment(data)\n\n  if (moment.isMoment(m)) {\n    return m.format(format)\n  }\n\n  return ''\n}\n\nexport const sorter = (field: string) => (a: any, b: any) =>\n  `${a[field]}`.localeCompare(b[field])\n","import React from 'react'\n\ntype Props = {\n  /**\n   * 開關 Modal 時希望處理的事情\n   */\n  onRequestOpen?: () => any\n}\n\nexport default function useVisible({ onRequestOpen }: Props = {}) {\n  const [visible, setVisible] = React.useState(false)\n\n  const handleVisible: any = (evt: React.MouseEvent<HTMLElement>) => {\n    setVisible(prev => !prev)\n\n    if (onRequestOpen) {\n      onRequestOpen()\n    }\n  }\n\n  const handleClose = () => {\n    setVisible(false)\n  }\n\n  return [visible, handleVisible, handleClose]\n}\n","import React from 'react'\nimport { mergeAll, map, filter, keys } from 'ramda'\nimport { QueryVariables } from '@/constants/types'\nimport useSWR from '@/hooks/useSWR'\nimport { request } from '@/utils/request'\nconst { compose } = require('ramda')\n\nexport default function useQuery<T = any>(\n  url: string | null,\n  {\n    lazy = true,\n    method = 'POST',\n    variables: { onCompleted, onError, ...variables } = {},\n  }: {\n    method?: 'POST' | 'GET'\n    variables?: QueryVariables\n    lazy?: boolean\n  }\n) {\n  const [query, setQuery] = React.useState(variables)\n\n  const fetcher = (_url: string, ...args: any) => {\n    return request(_url, {\n      ...args,\n      method,\n      // remove nil or undefined key/value\n      ...(method === 'POST'\n        ? {\n            body: compose(\n              mergeAll,\n              map((key: string) => ({ [key]: query[key] })),\n              filter(\n                (key: string) =>\n                  query[key] !== null &&\n                  query[key] !== undefined &&\n                  query[key] !== ''\n              ),\n              keys\n            )(query),\n          }\n        : {}),\n      throwable: true,\n    })\n  }\n\n  const { data, refetch, ...rest } = useSWR<T>(\n    url,\n    {\n      lazy,\n      onCompleted,\n      onError,\n      variables,\n    },\n    fetcher\n  )\n\n  const _refetch = (variables: QueryVariables = {}) => {\n    setQuery(variables)\n    refetch(variables)\n  }\n\n  return {\n    ...rest,\n    refetch: _refetch,\n    data,\n  }\n}\n","import React from 'react'\nimport { Select } from 'antd'\nimport { SelectProps } from 'antd/lib/select'\nimport styled from 'styled-components'\n\nconst StyledSelect: any = styled(Select)`\n  &.ant-select {\n    &.ant-select-single:not(.ant-select-customize-input) .ant-select-selector,\n    .ant-select-selection:hover,\n    .ant-select-selection:active,\n    .ant-select-selection:focus {\n      border-color: #d9d9d9;\n    }\n\n    .ant-select-selection {\n      border-color: ${p => p.theme.secondary};\n    }\n\n    .ant-select-selection:active,\n    .ant-select-selection:focus {\n      box-shadow: none;\n    }\n\n    .ant-select-arrow {\n      color: ${p => p.theme.primary};\n    }\n\n    .ant-select-arrow-icon {\n      position: relative;\n      top: -1px;\n      font-size: 14px;\n    }\n\n    &.ant-select-borderless .ant-select-selector {\n      position: relative;\n      bottom: 1px;\n      border: 0;\n      border-bottom: 1px #d9d9d9 solid !important;\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n  }\n\n  &.ant-select.is--outline {\n    > .ant-select-selector {\n      background: transparent;\n      border: 1px solid #fff;\n      color: #fff;\n\n      &:active,\n      &:focus,\n      &:hover {\n        border: 1px solid #fff;\n      }\n    }\n\n    .ant-select-selection-placeholder,\n    .ant-select-arrow {\n      color: #fff;\n    }\n\n    .ant-select-selection-placeholder {\n      opacity: 1;\n      left: 30%;\n    }\n  }\n\n  &.ant-select.is--transparent {\n    &.ant-select-focused > .ant-select-selector {\n      border: 1px solid #666a8f;\n    }\n\n    > .ant-select-selector {\n      background: transparent;\n      border: 1px solid #666a8f;\n      color: #a9b6d8;\n\n      &:active,\n      &:focus,\n      &:hover {\n        border: 1px solid #666a8f;\n      }\n    }\n\n    .ant-select-arrow {\n      color: #a9b6d8;\n    }\n  }\n`\n\nclass SelectComponent<T = any> extends React.Component<SelectProps<T>, any> {\n  public static Option = Select.Option\n\n  public static displayName = 'Select'\n\n  render() {\n    return <StyledSelect {...this.props}>{this.props.children}</StyledSelect>\n  }\n}\n\nexport default SelectComponent\n","export default {\n  CARD: 'card',\n  BOARD: 'board',\n  SNIPPET: 'snippet',\n}\n","import React from 'react'\nimport styled, { css } from 'styled-components'\nimport { DatePicker, TimePicker } from 'antd'\nimport { DatePickerProps } from 'antd/lib/date-picker'\n\nconst borderLess = css`\n  &.ant-picker-borderless {\n    border: none;\n    border-bottom: 1px solid #d9d9d9 !important;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n\n  &.ant-picker-focused:not(.ant-picker-borderless) {\n    box-shadow: 0 0 0 1px ${p => p.theme.primary};\n  }\n`\n\nconst RangePicker = styled(DatePicker.RangePicker)`\n  &.ant-picker {\n    border: 1px solid #d9d9d9;\n\n    &:hover,\n    &:focus {\n      border-color: ${p => p.theme.secondary};\n    }\n\n    &.ant-picker-focused {\n      box-shadow: 0 0 0 1px ${p => p.theme.primary};\n    }\n  }\n`\n\nconst StyledDatePicker: any = styled(DatePicker)`\n  &.ant-picker {\n    border: 1px solid #d9d9d9;\n\n    &:hover,\n    &:focus {\n      border-color: ${p => p.theme.secondary};\n    }\n\n    .ant-picker-suffix {\n      color: ${p => p.theme.primary};\n    }\n\n    ${borderLess};\n  }\n`\n\nconst StyledTimePicker = styled(TimePicker)`\n  &.ant-picker {\n    border: 1px solid #d9d9d9;\n\n    &:hover,\n    &:focus {\n      border-color: ${p => p.theme.secondary};\n    }\n\n    .ant-picker-suffix {\n      color: ${p => p.theme.primary};\n    }\n\n    ${borderLess};\n  }\n`\n\nfunction DatePickerComponent(props: DatePickerProps) {\n  return <StyledDatePicker {...props} />\n}\n\nexport {\n  DatePickerComponent as DatePicker,\n  RangePicker,\n  StyledTimePicker as TimePicker,\n}\n\nexport default DatePickerComponent\n","export enum ActionTypes {\n  DELETABLE = 'deletable',\n  UPDATABLE = 'updatable',\n  CREATABLE = 'creatable',\n  READABLE = 'readable',\n}\n\nexport const reportAnnotations = [\n  '檢體不適當',\n  '不符合',\n  '通知惡性或疑似',\n  '通知癌前病灶',\n  '其他危險值',\n  '肺結核',\n  '是否保留',\n]\n\nexport const reportTemplateStatusEnums = {\n  FINISH: 's',\n  DRAFT: 'f',\n}\n\nexport const reportTemplateStatusNameEnums = {\n  f: '草稿',\n  s: '完成',\n}\n\nexport const reportStatusEnums = [\n  {\n    id: 82,\n    name: '取消',\n  },\n  {\n    id: 63,\n    name: '完成',\n  },\n  {\n    id: 60,\n    name: '已輸',\n  },\n  {\n    id: 38,\n    name: '未輸',\n  },\n]\n\nexport const reportStatus = {\n  FINISH: 63,\n  CANCEL: 82,\n  TYPED: 60,\n  UNTYPE: 38,\n}\n\nexport enum Divisions {\n  'PATH' = 'PATH',\n  'RAD' = 'RD',\n  'CLINICIAN' = 'CLINICIAN',\n}\n","import React from 'react'\nimport { Radio } from 'antd'\nimport { RadioProps } from 'antd/lib/radio'\nimport styled from 'styled-components'\n\nconst StyledRadio = styled(Radio)`\n  &.ant-radio-wrapper {\n    color: ${p => p.theme.darkGrey};\n\n    span.ant-radio + * {\n      padding-left: 16px;\n    }\n\n    .ant-radio-inner,\n    .ant-radio-checked .ant-radio-inner {\n      border-color: initial;\n    }\n\n    .ant-radio-inner::after {\n      background: ${p => p.theme.primary};\n    }\n\n    &:hover,\n    .ant-radio:hover .ant-radio-inner,\n    .ant-radio-input:focus + .ant-radio-inner {\n      border-color: ${p => p.theme.primary};\n    }\n  }\n`\n\ninterface Props extends RadioProps {\n  css?: React.CSSProperties\n}\n\nclass RadioComponent extends React.Component<Props, any> {\n  public static Group = Radio.Group\n\n  public static displayName = 'Radio'\n\n  public render() {\n    return <StyledRadio {...this.props} />\n  }\n}\n\nexport default RadioComponent\n","import { atom, useRecoilState } from 'recoil'\nimport Store from 'store'\nimport { User } from '@/constants/types'\nimport { useAuth } from '@/hooks/useAuth'\n\nexport const userState = atom<User | null>({\n  key: 'userState',\n  default: Store.get('vghks_user'),\n})\n\nexport function useUser() {\n  const [, setUserState] = useRecoilState(userState)\n  const { setUser: setAuthUser } = useAuth()\n\n  const _setUser = (updater: (values: User | null) => any) => {\n    setAuthUser(updater)\n    setUserState(updater)\n  }\n\n  return _setUser\n}\n\nexport default useUser\n","import React from 'react'\nimport { ColumnProps, TableProps, TablePaginationConfig } from 'antd/lib/table'\nimport { SpinProps } from 'antd/lib/spin'\nimport { mergeDeepRight } from 'ramda'\nimport { DataSource } from '@/constants/types'\nimport Table from '@/components/table'\n\ntype Props<T> = Omit<TableProps<T>, 'dataSource'> & {\n  columns: ColumnProps<T>[]\n  className?: string\n  pageNum?: number\n  dataSource: DataSource<T>\n  onChange?: (pagination: TablePaginationConfig) => any\n  loading?: boolean | SpinProps\n  rowSelection?: {\n    selectedRowKeys: any[]\n    onChange: (selectedRowKeys: any, selectedRows: any) => void\n  }\n}\n\nexport default function QueryTable<T>({\n  columns,\n  className,\n  pageNum = 1,\n  dataSource,\n  onChange,\n  loading = false,\n  rowSelection,\n  pagination = {},\n  ...props\n}: Props<T>) {\n  const [_pageNum, setPageNum] = React.useState(pageNum)\n\n  const handleTableChange = ({ current, pageSize }: TablePaginationConfig) => {\n    if (onChange) {\n      onChange({ current, pageSize })\n    }\n    if (current) {\n      setPageNum(current)\n    }\n  }\n\n  let paginationConfig: false | TablePaginationConfig = mergeDeepRight<\n    any,\n    any\n  >(\n    {\n      current: _pageNum,\n      pageSize: 10,\n      total: dataSource.total,\n      showSizeChanger: false,\n    },\n    pagination\n  )\n\n  if (pagination === false) {\n    paginationConfig = false\n  }\n\n  return (\n    <Table\n      rowKey=\"id\"\n      dataSource={dataSource.content}\n      columns={columns as any}\n      pagination={paginationConfig}\n      onChange={handleTableChange}\n      rowSelection={rowSelection}\n      loading={loading}\n      className={className}\n      {...props}\n    />\n  )\n}\n","import { Input } from 'antd'\nimport styled, { css } from 'styled-components'\n\nconst borderLess = css`\n  &.ant-input-borderless {\n    border: none;\n    border-bottom: 1px solid #d9d9d9;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n\n  &:active:not(.ant-input-borderless) {\n    box-shadow: 0 0 0 1px ${p => p.theme.primary};\n  }\n`\n\nconst StyledInput = styled(Input)`\n  &.ant-input-affix-wrapper .ant-input,\n  &.ant-input {\n    border-color: #d9d9d9;\n\n    &:hover,\n    &:focus {\n      border-color: ${p => p.theme.secondary};\n    }\n\n    ${borderLess};\n  }\n\n  &.ant-input.is--linked {\n    border: 1px solid #2d6ca2;\n    background-color: #d9edf7;\n  }\n`\n\nconst Search = styled(Input.Search)`\n  &.ant-input-search {\n    .ant-input {\n      border-color: #d9d9d9;\n\n      &:hover,\n      &:focus {\n        border-color: ${p => p.theme.secondary};\n      }\n\n      &:focus {\n        box-shadow: 0 0 0 1px ${p => p.theme.primary};\n      }\n    }\n\n    .anticon-search {\n      font-size: 20px;\n      color: ${p => p.theme.primary};\n    }\n  }\n`\n\nconst TextArea = styled(Input.TextArea)`\n  &.ant-input {\n    resize: none;\n    border: 1px solid #d9d9d9;\n\n    &:hover,\n    &:focus {\n      border-color: ${p => p.theme.secondary};\n    }\n\n    ${borderLess};\n  }\n`\n\nexport { StyledInput as Input, TextArea, Search }\n\nexport default StyledInput\n","export default function getDisplayName(Component: any) {\n  return (\n    Component.displayName ||\n    Component.name ||\n    (typeof Component === 'string' && Component.length > 0\n      ? Component\n      : 'Unknown')\n  )\n}\n","import React from 'react'\nimport { Table, Tooltip } from 'antd'\nimport { TableProps } from 'antd/lib/table'\nimport { CloseOutlined, PlusOutlined } from '@ant-design/icons'\nimport styled from 'styled-components'\n\nconst StyledTable: any = styled(Table)`\n  &.ant-table-wrapper {\n    .ant-pagination-prev .ant-pagination-item-link,\n    .ant-pagination-next .ant-pagination-item-link {\n      border-color: ${p => p.theme.pagination};\n      border-radius: 6px;\n      color: ${p => p.theme.pagination};\n    }\n\n    .ant-pagination-item {\n      border-color: ${p => p.theme.pagination};\n    }\n\n    .ant-pagination-item a {\n      color: ${p => p.theme.pagination};\n    }\n\n    .ant-pagination-item-active,\n    .ant-pagination-item-active:focus,\n    .ant-pagination-item:hover {\n      border-color: ${p => p.theme.pagination};\n      background: ${p => p.theme.pagination};\n\n      a {\n        color: #fff;\n      }\n    }\n\n    .ant-table-pagination.ant-pagination {\n      margin-top: 32px;\n    }\n\n    .ant-pagination-prev:hover .ant-pagination-item-link,\n    .ant-pagination-next:hover .ant-pagination-item-link {\n      border-color: ${p => p.theme.pagination};\n      background: ${p => p.theme.pagination};\n      color: #fff;\n    }\n\n    .ant-pagination-simple-pager {\n      color: ${p => p.theme.pagination};\n    }\n\n    .ant-pagination.mini .ant-pagination-item-link .anticon {\n      position: relative;\n      top: -2px;\n    }\n\n    .ant-pagination.mini .ant-pagination-prev {\n      margin-right: 3px;\n    }\n\n    .ant-pagination.mini .ant-pagination-next {\n      margin-left: 3px;\n    }\n  }\n\n  .ant-table {\n    background: transparent;\n  }\n\n  .ant-table-tbody > tr > td {\n    height: 40px;\n    padding-top: 10px;\n    padding-bottom: 10px;\n    line-height: 1em;\n    color: #4a4a4a;\n    background: transparent !important;\n    border-bottom: 1px solid #e9e9e9;\n  }\n\n  .ant-table-thead > tr > th {\n    padding: 12px;\n    background: ${p => p.theme.primary};\n    border-bottom: 1px solid #e9e9e9;\n    color: #fff;\n    font-weight: 500;\n  }\n`\n\ntype Props<T> = TableProps<T> & {\n  editable?: boolean\n  isRowDeletable?: (row: T) => boolean\n  onAddRowClick?: (param?: any) => any\n  onDeleteRowClick?: (param?: any) => any\n  isCanEdit?: any\n}\n\nfunction TableComponent<T = any>({\n  editable = false,\n  columns = [],\n  onAddRowClick,\n  isRowDeletable = () => true,\n  onDeleteRowClick,\n  isCanEdit = '',\n  ...props\n}: Props<T>) {\n  const _columns = React.useMemo(() => {\n    let canEdit: boolean = true\n    if (!editable) {\n      return columns\n    }\n    if (isCanEdit !== '') {\n      canEdit = isCanEdit\n    }\n\n    const handleRowDelete = (key: React.Key) => () => {\n      if (onDeleteRowClick) {\n        onDeleteRowClick(key)\n      }\n    }\n\n    return [\n      {\n        title: (\n          <Tooltip placement=\"topLeft\" title=\"新增\">\n            <PlusOutlined\n              className=\"ml-1 relative\"\n              style={{ top: -3 }}\n              onClick={canEdit ? onAddRowClick : undefined}\n            />\n          </Tooltip>\n        ),\n        width: 50,\n        render: (_: any, __: any, idx: number) => (\n          <div className=\"text-center\">#{idx + 1}</div>\n        ),\n      },\n      ...columns,\n      {\n        width: 50,\n        render: (_: any, r: any, idx: number) => (\n          <Tooltip placement=\"topLeft\" title=\"刪除\">\n            <CloseOutlined\n              onClick={isRowDeletable(r) ? handleRowDelete(r.id) : undefined}\n            />\n          </Tooltip>\n        ),\n      },\n    ]\n  }, [columns, editable]) // eslint-disable-line\n\n  return (\n    <StyledTable\n      columns={_columns}\n      // locale={{\n      //   emptyText: (\n      //     <span className=\"d-block\">查無資料，請重新設定查詢條件。</span>\n      //   ),\n      // }}\n      {...props}>\n      {props.children}\n    </StyledTable>\n  )\n}\n\nTableComponent.displayName = 'Table'\nTableComponent.Column = Table.Column\n\nexport default TableComponent\n","import React from 'react'\nimport {\n  length,\n  pathOr,\n  ifElse,\n  isNil,\n  identity,\n  takeLast,\n  compose,\n  filter,\n  concat,\n} from 'ramda'\nimport { ModalFuncProps } from 'antd/lib/modal'\nimport useDelete from './useDelete'\n\ntype Props<T> = {\n  defaultRowKeys?: number[] | string[]\n  defaultRows?: T[]\n  multiple?: boolean\n  limit?: number\n  modalProps?: ModalFuncProps\n  onRequestDelete?: (values: any) => any\n  refetchQueries?: () => any\n}\n\nexport default function useRowSelection<T = any>(props: Props<T> = {}) {\n  const {\n    limit,\n    defaultRowKeys = [],\n    defaultRows = [],\n    multiple = true,\n  } = props\n\n  const [selectedRowKeys, setSelectedRowKeys] = React.useState<\n    string[] | number[]\n  >(defaultRowKeys)\n\n  const [selectedRows, setSelectedRows] = React.useState<T[]>(defaultRows)\n\n  const onSelectChange = (rowKeys: React.Key[], rows: T[]) => {\n    if (!isNil(limit) && length(rowKeys) > limit) {\n      return\n    }\n\n    setSelectedRowKeys(ifElse(() => multiple, identity, takeLast(1))(rowKeys))\n\n    setSelectedRows(prev =>\n      ifElse(\n        () => multiple,\n        compose(\n          filter((x: any) => rowKeys.includes(x.id)),\n          concat(prev)\n        ),\n        takeLast(1)\n      )(rows)\n    )\n  }\n\n  const isDeletable = React.useMemo(() => selectedRowKeys.length > 0, [\n    selectedRowKeys,\n  ])\n\n  const rowSelection = {\n    selectedRowKeys,\n    onChange: onSelectChange,\n  }\n\n  const { handleConfirm, onAfterDelete } = useDelete({\n    ...props,\n    isDeletable,\n    content: `確定要刪除 ${length(selectedRowKeys as any)} 筆資料嗎？`,\n    deleteItem: selectedRows.map(x => ({ id: pathOr('code', ['id'], x) })),\n    onAfterDelete: () => {\n      setSelectedRowKeys([])\n      setSelectedRows([])\n    },\n  })\n\n  return {\n    rowSelection,\n    isDeletable,\n    handleConfirm,\n    selectedRowKeys,\n    selectedRows,\n    selectedRowCount: selectedRowKeys.length,\n    onAfterDelete,\n    clearSelection: () => {\n      setSelectedRowKeys([])\n      setSelectedRows([])\n    },\n  }\n}\n","import React from 'react'\nimport cx from 'classnames'\nimport { Card } from 'antd'\nimport { CardProps } from 'antd/lib/card'\nimport { FontColorsOutlined } from '@ant-design/icons'\nimport styled from 'styled-components'\nimport { useReportPreview } from '@/services/report-template'\n// import { isNil } from '@/utils/webHelper'\n\nconst StyledCard = styled(Card)`\n  &.ant-card {\n    border-radius: 10px;\n    border: none;\n    cursor: move;\n  }\n\n  .ant-card-head {\n    padding-left: 18px;\n    border-bottom: none;\n    color: ${p => p.theme.darkGrey};\n    font-size: 15px;\n    font-weight: 500;\n  }\n\n  &.ant-card-head--hide .ant-card-head {\n    display: none;\n  }\n\n  &.ant-card-body--hide {\n    .ant-card-head {\n      padding-bottom: 16px;\n      border-bottom: 1px dashed #f0f0f0;\n    }\n\n    .ant-card-body {\n      display: none;\n    }\n  }\n\n  &.is--preview .ant-card-head {\n    min-height: auto;\n  }\n\n  &.is--preview .ant-card-head-title {\n    padding-top: 0;\n  }\n\n  &.is--preview .ant-card-body {\n    padding-top: 12px;\n    padding-bottom: 8px;\n  }\n\n  .ant-card-head-title {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding-bottom: 0;\n  }\n\n  .ant-card-body {\n    padding-top: 6px;\n    padding-left: 26px;\n    padding-bottom: 20px;\n  }\n`\n\ninterface Props extends CardProps {\n  titleVisible?: boolean\n  bodyVisible?: boolean\n  icon?: any\n  onEdit?: () => void\n  onDelete?: () => void\n}\n\nfunction SnippetTemplateWrapper({\n  title,\n  children,\n  onDelete,\n  onEdit,\n  titleVisible = true,\n  bodyVisible = true,\n  icon,\n  ...props\n}: Props) {\n  const [isPreview] = useReportPreview()\n\n  let Icon = icon ? icon : FontColorsOutlined\n\n  return (\n    <StyledCard\n      {...(titleVisible\n        ? {\n            title: (\n              <div className=\"flex items-center\">\n                {!isPreview && <Icon className=\"mr-3\" />}\n                {title ||\n                  `模版標題 ${isPreview ? '' : '(點鉛筆圖示可進行編輯)'}`}\n              </div>\n            ),\n          }\n        : {})}\n      className={cx({\n        // 'ant-card-head--hide': isNil(title) && !titleVisible,\n        'ant-card-body--hide': !bodyVisible,\n        // 'is--preview': isPreview,\n      })}\n      {...props}>\n      {children}\n    </StyledCard>\n  )\n}\n\nexport default SnippetTemplateWrapper\n","import React from 'react'\nimport styled from 'styled-components'\nimport {\n  EditOutlined,\n  DeleteOutlined,\n  RightOutlined,\n  LeftOutlined,\n} from '@ant-design/icons'\nimport cx from 'classnames'\nimport { Tooltip } from 'antd'\n\ntype Props = {\n  visible?: boolean\n  editable?: boolean\n  tabIndex: number\n  onEdit: () => void\n  onDelete: () => void\n  onShift: (shift: number) => void\n}\n\nconst ToolbarWrapper = styled.div`\n  position: absolute;\n  top: 8px;\n  right: 15px;\n  visibility: hidden;\n  transition: visibility 0s, opacity 0.3s, max-height 0.6s linear;\n  opacity: 0;\n  z-index: 1;\n\n  &.is--over {\n    visibility: visible;\n    transition: visibility 0s, opacity 0.3s, max-height 0.6s linear;\n    opacity: 0.8;\n  }\n`\n\nexport const SHIFT_TYPES = {\n  LEFT: -1,\n  RIGHT: 1,\n}\n\nexport default function SnippetToolbar({\n  tabIndex,\n  onEdit,\n  onDelete,\n  onShift,\n  editable = true,\n  visible = false,\n}: Props) {\n  const handleShift = (shift: number) => () => {\n    onShift(shift)\n  }\n\n  return (\n    <ToolbarWrapper\n      className={cx('text-primary', {\n        'is--over': tabIndex === 1,\n        hidden: !visible,\n      })}>\n      <Tooltip title=\"向左縮排\">\n        <LeftOutlined\n          className=\"mr-2 cursor-pointer\"\n          onClick={handleShift(SHIFT_TYPES.LEFT)}\n        />\n      </Tooltip>\n      <Tooltip title=\"向右縮排\">\n        <RightOutlined\n          className=\"mr-2 cursor-pointer\"\n          onClick={handleShift(SHIFT_TYPES.RIGHT)}\n        />\n      </Tooltip>\n      {editable && (\n        <Tooltip title=\"編輯\">\n          <EditOutlined className=\"mr-2 cursor-pointer\" onClick={onEdit} />\n        </Tooltip>\n      )}\n      <Tooltip title=\"刪除\">\n        <DeleteOutlined className=\"cursor-pointer\" onClick={onDelete} />\n      </Tooltip>\n    </ToolbarWrapper>\n  )\n}\n\nexport { SnippetToolbar }\n","/* eslint-disable no-undef */\nimport React from 'react'\nimport { clone, is, equals } from 'ramda'\nimport envStore from '@/constants/env'\nimport hoist from 'hoist-non-react-statics'\nimport getDisplayName from '@/utils/get-display-name'\n\n// https://stackoverflow.com/questions/57047722/how-to-disable-and-enable-tinymce-with-a-button-and-jquery\n\nlet defaultConfig = {\n  block_formats: 'Heading 1=h1;Heading 2=h2;Heading 3=h3;Paragraph=p',\n  inline: true,\n  menubar: false,\n  external_plugins: {\n    dropdown: `${envStore.publicUrl}/js/tinymce/plugins/dropdown/plugin.js`,\n    inputtext: `${envStore.publicUrl}/js/tinymce/plugins/inputtext/plugin.js`,\n  },\n  env: envStore.appBaseName,\n  fontsize_formats: '10px 12px 14px 16px 18px 20px 24px 32px 36px',\n  force_br_newlines: true,\n  force_p_newlines: false,\n  forced_root_block: 'div',\n  plugins: 'image textcolor lists emoticons link table media code',\n  tinymce: `${envStore.publicUrl}/js/tinymce/4.9.2/tinymce.min.js`,\n  link_title: false,\n  table_toolbar:\n    'tablemergecells tablesplitcells | tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol',\n  textcolor_cols: '5',\n  content_security_policy: '',\n  allow_unsafe_link_target: true,\n  relative_urls: false,\n  convert_urls: false,\n  valid_elements: '*[*]',\n  valid_children:\n    'h1[div|strong|b],h2[div|strong|b],h3[div|strong|b],p[div|strong|b]',\n  toolbar1:\n    'undo redo | custom-formatselect fontsizeselect | bold italic underline strikethrough forecolor removeformat | align numlist bullist outdent indent | link | fontawesome | inputtext | dropdown',\n}\n\nexport default function withTinyMCE(ComposedComponent) {\n  class withTinyMCE extends React.Component {\n    static displayName = `withTinyMCE(${getDisplayName(ComposedComponent)})`\n\n    static defaultProps = {\n      inline: false,\n    }\n\n    state = {\n      top: 0,\n      tabIndex: -1,\n      editor: null,\n      toolbarMouseOver: false,\n      toolbarVisible: false,\n    }\n\n    componentDidMount() {\n      if (this.props.inline) {\n        this.initialize(this.props.item)\n      }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n      const { isDragging, inline, id, item } = this.props\n      const { editor } = this.state\n\n      if (!isDragging && prevProps.isDragging) {\n        this.setState({ toolbarVisible: false })\n      }\n      if (!inline) {\n        return\n      }\n      if (!equals(id, prevProps.id)) {\n        this.initialize(item)\n      }\n      if (!equals(item?.html, prevProps.item?.html)) {\n        editor.setContent(item?.html)\n        this._addEventListeners(editor)\n      }\n    }\n\n    _addEventListeners = (editor = this.state.editor) => {\n      if (editor) {\n        editor.dom.select('input').forEach(el =>\n          el.addEventListener('input', function (evt) {\n            const value = evt.target.value\n\n            this.innerHTML = value\n            this.setAttribute('data-mce-value', value)\n            this.setAttribute('value', value)\n\n            if (!value) {\n              this.removeAttribute('data-mce-value')\n              this.removeAttribute('value')\n            }\n\n            tinymce.triggerSave()\n          })\n        )\n\n        editor.dom.select('select').forEach(el => {\n          el.addEventListener('change', function (evt) {\n            this.setAttribute('data-mce-value', evt.target.value)\n            this.setAttribute('value', evt.target.value)\n\n            this.childNodes.forEach(child => {\n              if (!(child instanceof HTMLElement)) {\n                return\n              }\n              if (child.innerText === evt.target.value) {\n                child.setAttribute('selected', 'selected')\n              }\n              if (\n                child.innerText !== evt.target.value &&\n                child.hasAttribute('selected')\n              ) {\n                child.removeAttribute('selected')\n              }\n            })\n\n            tinymce.triggerSave()\n          })\n        })\n      }\n    }\n\n    initialize = snippet => {\n      if (this._get(snippet.id)) {\n        this.remove(snippet.id)\n      }\n\n      const _config = clone(snippet.config || defaultConfig)\n\n      tinymce.init({\n        ..._config,\n        selector: `#${snippet.id}`,\n        language_url: `${envStore.publicUrl}/js/tinymce/langs/zh_TW.js`,\n        content: snippet.html,\n        setup: editor => {\n          editor.on('blur', this.onBlur)\n          editor.on('focus', this.onFocus)\n          // editor.on('change', this.onBlur)\n\n          if (is(Function, _config.execInit)) {\n            _config.execInit(editor)\n          }\n\n          if (snippet.html) {\n            editor.on('init', () => editor.setContent(snippet.html))\n          }\n        },\n        init_instance_callback: editor => {\n          this.setState({ editor })\n          this._addEventListeners(editor)\n          editor.undoManager.add()\n        },\n      })\n    }\n\n    onFocus = () => {}\n\n    onChange = () => {\n      this.state.editor.getContent({ format: 'text' })\n    }\n\n    onBlur = e => {\n      const { updateSnippet, item } = this.props\n      // console.log(e.target.getContent({ format: 'text' }))\n      if (updateSnippet) {\n        updateSnippet({ ...item, html: e.target.getContent() })\n      }\n    }\n\n    _get = id => {\n      return tinymce.get(id)\n    }\n\n    remove = id => {\n      tinymce.remove(this._get(id || this.props.id))\n    }\n\n    render() {\n      return <ComposedComponent {...this.state} {...this.props} />\n    }\n  }\n\n  return hoist(withTinyMCE, ComposedComponent)\n}\n","import React from 'react'\nimport { DragSource, ConnectDragPreview, ConnectDragSource } from 'react-dnd'\nimport { getEmptyImage } from 'react-dnd-html5-backend'\nimport { mergeRight } from 'ramda'\nimport cx from 'classnames'\nimport { confirm } from '@/utils/message'\nimport { SnippetProps } from '@/constants/types'\nimport ItemTypes from '@/constants/item-types'\nimport TemplateWrapper from '@/components/snippet-template-wrapper'\nimport SnippetToolbar from '@/components/snippet-toolbar'\nimport withTinyMCE from '@/components/withTinyMCE'\nimport { snippetTypes } from '@/components/snippet-template-list'\nimport theme from '../theme'\nconst { compose } = require('ramda')\n\ntype Props = {\n  id?: React.Key\n  wrapperId?: string\n  className?: string\n  style?: React.CSSProperties\n  index?: number\n  tabSize?: number\n  isDragging?: boolean\n  draggable?: boolean\n  inline?: boolean\n  fromMenu?: boolean\n  item: SnippetProps\n  connectDragPreview?: ConnectDragPreview\n  connectDragSource?: ConnectDragSource\n  children?: React.ReactNode\n  updateSnippet?(data: any): void\n  findSnippet?(id: React.Key): { index: number; snippet: SnippetProps }\n  shiftSnippet?(id: React.Key, shift: number): any\n  removeSnippet?(index: number): void\n}\n\ntype State = {\n  tabIndex: number\n  editModalVisible: boolean\n}\n\nconst withDragSource = DragSource(\n  ItemTypes.BOARD,\n  {\n    beginDrag(props: Props) {\n      return {\n        ...props,\n        fromMenu: false,\n        originalIndex: (props as any).findSnippet(props.id).index,\n      }\n    },\n    canDrag(props: Props) {\n      return !!(props.draggable && !props.fromMenu)\n    },\n  },\n  (connect, monitor) => ({\n    connectDragSource: connect.dragSource(),\n    connectDragPreview: connect.dragPreview(),\n    isDragging: monitor.isDragging(),\n  })\n)\n\nclass Snippet extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props)\n\n    this.state = {\n      tabIndex: -1,\n      editModalVisible: false,\n    }\n  }\n\n  componentDidMount = () => {\n    const { connectDragPreview } = this.props\n    if (connectDragPreview) {\n      connectDragPreview(getEmptyImage() /* { anchorX: 0.2, anchorY: 0.1 } */)\n    }\n  }\n\n  handleShift = (shift: number) => {\n    const { id, shiftSnippet } = this.props\n\n    if (shiftSnippet && id) {\n      shiftSnippet(id, shift)\n    }\n  }\n\n  handleRemove = () => {\n    confirm({\n      content: '刪除後將無法還原，確認繼續？',\n      title: '確認要刪除這個模版?',\n      onOk: () => {\n        ;(this.props as any).removeSnippet(this.props.index)\n      },\n      onCancel() {},\n    })\n  }\n\n  handleEditModalVisible = () => {\n    this.setState(prev => ({ editModalVisible: !prev.editModalVisible }))\n  }\n\n  _onMouseOver = () => {\n    this.setState({ tabIndex: 1 })\n  }\n\n  _onMouseOut = () => {\n    this.setState({ tabIndex: -1 })\n  }\n\n  render() {\n    const {\n      props: {\n        connectDragSource = (node: any) => node,\n        connectDragPreview = (node: any) => node,\n        wrapperId,\n        index,\n        draggable,\n        style = {},\n        className = 'mb-2',\n        item,\n      },\n      state: { tabIndex, editModalVisible },\n    } = this\n\n    const styles = mergeRight(\n      getItemStyles({ ...this.props, ...this.state }),\n      style\n    )\n\n    const children = React.Children.map(this.props.children, child =>\n      React.cloneElement(child as any, {\n        editModalVisible,\n        handleEditModalVisible: this.handleEditModalVisible,\n      })\n    )\n\n    return connectDragSource(\n      connectDragPreview(\n        <div\n          id={wrapperId}\n          style={styles}\n          className={cx(\n            'ui-sortable',\n            { 'ui-draggable': draggable },\n            className\n          )}\n          tabIndex={tabIndex}\n          onMouseOver={this._onMouseOver}\n          onMouseOut={this._onMouseOut}\n          data-index={index}>\n          <SnippetToolbar\n            visible={draggable}\n            tabIndex={tabIndex}\n            editable={!item.inline}\n            onEdit={this.handleEditModalVisible}\n            onDelete={this.handleRemove}\n            onShift={this.handleShift}\n          />\n          {item.type !== snippetTypes.CLOZE ? (\n            <TemplateWrapper\n              titleVisible\n              bodyVisible={item.type !== snippetTypes.HEADER}\n              title={item?.setting?.text || ''}\n              icon={item.icon}>\n              {children}\n            </TemplateWrapper>\n          ) : (\n            children\n          )}\n        </div>\n      )\n    )\n  }\n}\n\nfunction getItemStyles(props: Partial<Props & State>): React.CSSProperties {\n  const { isDragging, tabIndex, draggable, tabSize = 0 } = props\n\n  const isFocus = tabIndex === 1\n\n  return {\n    ...(isFocus ? { borderRadius: 3 } : {}),\n    ...(draggable\n      ? { border: `1px dashed ${draggable ? '#e7e7e7' : 'transparent'}` }\n      : {\n          outlineColor: isFocus ? theme.purple150 : 'transparent',\n        }),\n    cursor: 'default',\n    position: 'relative',\n    display: isDragging ? 'none' : 'block',\n    marginLeft: tabSize * 50,\n  }\n}\n\nexport default compose(withDragSource, withTinyMCE)(Snippet) as typeof Snippet\n","import { Tabs } from 'antd'\nimport styled from 'styled-components'\n\nconst bg = 'rgb(43,193,183)'\n\nexport default styled(Tabs)`\n  &.ant-tabs {\n    .ant-tabs-tab {\n      display: flex;\n      align-items: center;\n      padding: 10px 24px !important;\n      margin-right: 4px !important;\n      color: #fff !important;\n      border-color: ${bg} !important;\n      background: ${bg} !important;\n      border-top-left-radius: 12px !important;\n      border-top-right-radius: 12px !important;\n    }\n\n    .ant-tabs-tab-active {\n      border-color: #fff !important;\n      background: #fff !important;\n\n      svg path {\n        fill: ${p => p.theme.primary} !important;\n      }\n    }\n\n    .ant-tabs-tab .anticon {\n      color: #fff !important;\n    }\n\n    .ant-tabs-tab.is--over {\n      border: 1px dashed lightgrey !important;\n    }\n\n    .ant-tabs-tab.is--dragging {\n      opacity: 0.3;\n    }\n\n    > .ant-tabs-nav .ant-tabs-nav-add,\n    .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-add {\n      background: transparent;\n      border-color: transparent;\n      color: ${p => p.theme.darkGrey};\n\n      .anticon-plus {\n        color: ${p => p.theme.darkGrey};\n      }\n\n      .anticon-plus:hover {\n        color: ${p => p.theme.primary};\n      }\n    }\n\n    .ant-tabs-tab-btn:focus,\n    .ant-tabs-tab-remove:focus,\n    .ant-tabs-tab-btn:active,\n    .ant-tabs-tab-remove:active,\n    .ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn {\n      color: ${p => p.theme.secondary} !important;\n    }\n  }\n\n  &.ant-tabs-top > .ant-tabs-nav,\n  &.ant-tabs-top > div > .ant-tabs-nav {\n    margin-bottom: 0;\n  }\n\n  &.ant-tabs-top > .ant-tabs-nav::before {\n    border-bottom: none;\n  }\n`\n","import React from 'react'\nimport { DragSource, DropTarget } from 'react-dnd'\nimport cx from 'classnames'\nimport { compose } from 'ramda'\nimport Tabs from '@/components/tabs'\n\n// Drag & Drop node\nclass TabNode extends React.Component {\n  render() {\n    const {\n      connectDragSource,\n      connectDropTarget,\n      isDragging,\n      isOver,\n      moveTabNode,\n      draggingItem,\n      id,\n      ...props\n    } = this.props\n\n    return connectDragSource(\n      connectDropTarget(\n        React.cloneElement(props.children, {\n          className: cx(props.children.props.className, {\n            'is--dragging': isDragging,\n            'is--over': isOver && id !== draggingItem?.id,\n          }),\n        })\n      )\n    )\n  }\n}\n\nconst withDropTarget = DropTarget(\n  'DND_NODE',\n  {\n    drop(props, monitor) {\n      const dragKey = monitor.getItem().index\n      const hoverKey = props.index\n\n      if (dragKey === hoverKey) {\n        return\n      }\n\n      props.moveTabNode(dragKey, hoverKey)\n      monitor.getItem().index = hoverKey\n    },\n  },\n  (connect, monitor) => ({\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver(),\n    draggingItem: monitor.getItem(),\n  })\n)\n\nconst withDragSource = DragSource(\n  'DND_NODE',\n  {\n    beginDrag(props) {\n      return {\n        id: props.id,\n        index: props.index,\n      }\n    },\n  },\n  (connect, monitor) => ({\n    connectDragSource: connect.dragSource(),\n    isDragging: monitor.isDragging(),\n  })\n)\n\nconst WrapTabNode = compose(withDropTarget, withDragSource)(TabNode)\n\nexport default class DraggableTabs extends React.Component {\n  static defaultProps = {\n    order: [],\n  }\n\n  moveTabNode = (dragKey, hoverKey) => {\n    const { children, order, moveTabNode } = this.props\n    const newOrder = order.slice()\n\n    React.Children.forEach(children, c => {\n      if (newOrder.indexOf(c.key) === -1) {\n        newOrder.push(c.key)\n      }\n    })\n\n    const dragIndex = newOrder.indexOf(dragKey)\n    const hoverIndex = newOrder.indexOf(hoverKey)\n\n    newOrder.splice(dragIndex, 1)\n    newOrder.splice(hoverIndex, 0, dragKey)\n\n    moveTabNode(newOrder)\n  }\n\n  renderTabBar = (props, DefaultTabBar) => (\n    <DefaultTabBar {...props}>\n      {node => (\n        <WrapTabNode\n          key={node.key}\n          id={node.key}\n          index={node.key}\n          moveTabNode={this.moveTabNode}>\n          {node}\n        </WrapTabNode>\n      )}\n    </DefaultTabBar>\n  )\n\n  render() {\n    const { moveTabNode, children, ...props } = this.props\n\n    return (\n      <Tabs renderTabBar={this.renderTabBar} {...props}>\n        {children}\n      </Tabs>\n    )\n  }\n}\n\nDraggableTabs.TabPane = Tabs.TabPane\n","import React from 'react'\nimport { isNil } from 'ramda'\nimport Store from 'store'\nimport { Divisions } from '@/constants/enums'\nimport { User } from '@/constants/types'\nimport envStore from '@/constants/env'\n\nexport type LogoutFn = (params?: { onCompleted?: () => any }) => any\n\nexport type AuthContextType = {\n  logout: LogoutFn\n  isAuthenticated: boolean\n  user: User\n  setUser: React.Dispatch<React.SetStateAction<User | null>>\n  setIsAuthenticated: React.Dispatch<React.SetStateAction<boolean>>\n}\n\nexport const AuthContext = React.createContext<AuthContextType>({\n  isAuthenticated: false,\n  user: {} as User,\n  logout: () => ({}),\n  setUser: (_: React.SetStateAction<User | null>) => ({}),\n  setIsAuthenticated: (_: React.SetStateAction<boolean>) => ({}),\n})\n\nconst _user = Store.get('vghks_user')\n\nexport function AuthProvider(props: any) {\n  const [isAuthenticated, setIsAuthenticated] = React.useState(\n    !envStore.useOAuth ? true : !isNil(_user)\n  )\n\n  const [user, setUser] = React.useState<User>({\n    id: 1,\n    name: '醫師姓名',\n    division: Divisions.PATH,\n    position: 'A',\n    isAdmin: true,\n    viewDivision: false,\n    ..._user,\n  })\n\n  const logout = React.useCallback(({ onCompleted } = {}) => {\n    Store.remove('vghks_token')\n    Store.remove('vghks_user')\n\n    setIsAuthenticated(false)\n\n    if (onCompleted) {\n      onCompleted()\n    }\n  }, [])\n\n  const value = React.useMemo(\n    () => ({\n      isAuthenticated,\n      setIsAuthenticated,\n      setUser,\n      logout,\n      user,\n    }),\n    [isAuthenticated, logout, user, setUser, setIsAuthenticated]\n  )\n\n  return <AuthContext.Provider value={value} {...props} />\n}\n\nexport function useAuth() {\n  const context = React.useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error(`useAuth must be used within a AuthProvider`)\n  }\n  return context\n}\n\nexport default useAuth\n","import React from 'react'\n\nexport default React.lazy(() => import('./report-template-builder'))\n","import React from 'react'\n\nexport default React.lazy(\n  () => import('../report-template-list/report-template-list')\n)\n","import React from 'react'\n\nexport default React.lazy(() => import('./report-inquiry'))\n","/* eslint eqeqeq: 0 */\nimport React from 'react'\n\nexport type IReactComponent<P = any> =\n  | React.StatelessComponent<P>\n  | React.ComponentClass<P>\n  | React.ClassicComponentClass<P>\n\nfunction computeHeight(node: HTMLDivElement) {\n  const totalHeight = parseInt(getComputedStyle(node).height, 10)\n  const padding =\n    parseInt(getComputedStyle(node).paddingTop, 10) +\n    parseInt(getComputedStyle(node).paddingBottom, 10)\n  return totalHeight - padding\n}\n\nfunction getAutoHeight(n: HTMLDivElement | undefined) {\n  if (!n) {\n    return 0\n  }\n\n  let node = n\n\n  let height = computeHeight(node)\n\n  while (!height) {\n    node = node.parentNode as HTMLDivElement\n    if (node) {\n      height = computeHeight(node)\n    } else {\n      break\n    }\n  }\n\n  return height\n}\n\ninterface AutoHeightProps {\n  height?: number\n}\n\nfunction autoHeight() {\n  return <P extends AutoHeightProps>(\n    WrappedComponent: React.ComponentClass<P> | React.FC<P>\n  ) =>\n    class extends React.Component<P & AutoHeightProps> {\n      state = {\n        computedHeight: 0,\n      }\n\n      root: HTMLDivElement | undefined = undefined\n\n      componentDidMount() {\n        const { height } = this.props\n        if (!height) {\n          const h = getAutoHeight(this.root)\n          // eslint-disable-next-line\n          this.setState({ computedHeight: h })\n        }\n      }\n\n      handleRoot = (node: HTMLDivElement) => {\n        this.root = node\n      }\n\n      render() {\n        const { height } = this.props\n        const { computedHeight } = this.state\n        const h = height || computedHeight\n        return (\n          <div ref={this.handleRoot}>\n            {h > 0 && <WrappedComponent {...this.props} height={h} />}\n          </div>\n        )\n      }\n    }\n}\n\nexport default autoHeight\n","import React from 'react'\nimport moment from 'moment'\nimport { replace } from 'ramda'\nimport useRouteLeaveConfirm from '@/hooks/useRouteLeaveConfirm'\nimport { useExportReportJson } from '@/services/report'\nimport Button from '@/components/button'\nimport env from '@/constants/env'\nimport useAuth from '@/hooks/useAuth'\nimport { REPORT_INQUIRY } from '@/constants/routes'\nimport { ReportTemplate } from '@/constants/types'\nimport { Divisions } from '@/constants/enums'\nconst html2pdf = require('html2pdf.js')\n\nexport enum menuState {\n  VISIBLE_RIGHT = '1',\n  VISIBLE_LEFT = '2',\n}\n\ntype Props = {\n  data: ReportTemplate\n  isExport?: boolean\n  readOnly?: boolean\n  onToggleExport: () => void\n  onOk: () => void\n  onExportJson?: () => void\n  onExport?: () => void\n}\n\nexport default function Header({\n  data,\n  isExport,\n  readOnly = false,\n  onToggleExport,\n  onOk,\n}: Props) {\n  const handleConfirm = useRouteLeaveConfirm(REPORT_INQUIRY)\n\n  const { user } = useAuth()\n\n  const [exporting, setIsExporting] = React.useState(false)\n\n  const handleSave = () => {\n    onOk()\n  }\n\n  const handleOpenImageViewer = () => {\n    let url = replace(\n      ':studyInstanceUIDs',\n      '1.3.6.1.4.1.14519.5.2.1.3098.4963.119176436435873112231353675460'\n    )(user.division === Divisions.PATH ? env.viewerUrl : env.radiolViewerUrl)\n\n    window.open(`${url}?PatientID=${data.hhisnum}`, '__blank')\n  }\n\n  const [exportingJson, handleExportJson] = useExportReportJson({\n    onCompleted: () => {},\n  })\n\n  const _handleExportJson = () => {\n    handleExportJson({\n      orreqno: data.orreqno,\n      division: user.division,\n      filename: data.name,\n    })\n  }\n\n  const handleExport = async () => {\n    setIsExporting(true)\n\n    const element = document.querySelector('.js-export-pdf')\n    const opt = {\n      margin: 1,\n      filename: `報告匯出_${moment().format('YYYYMMDDHHmmss')}.pdf`,\n      image: { type: 'jpeg', quality: 0.98 },\n      html2canvas: { scale: 2 },\n      jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },\n    }\n\n    // New Promise-based usage:\n    await html2pdf().set(opt).from(element).save()\n\n    setIsExporting(false)\n  }\n\n  return (\n    <div className=\"inline-flex\">\n      {!isExport && (\n        <>\n          <Button\n            color=\"outline\"\n            className=\"ml-2 text-white border-white bg-transparent\"\n            onClick={handleSave}\n            style={{ minWidth: 80 }}>\n            儲存\n          </Button>\n          <Button\n            color=\"outline\"\n            className=\"ml-2 text-white border-white bg-transparent\"\n            onClick={handleConfirm}\n            style={{ minWidth: 80 }}>\n            取消\n          </Button>\n          <Button\n            color=\"outline\"\n            className=\"ml-2 text-white border-white bg-transparent\"\n            onClick={handleOpenImageViewer}\n            style={{ minWidth: 80 }}>\n            影像\n          </Button>\n          <Button\n            color=\"outline\"\n            className=\"ml-6 text-white border-white bg-transparent\"\n            onClick={onToggleExport}>\n            輸出報告\n          </Button>\n        </>\n      )}\n      {isExport && (\n        <>\n          {user.division !== 'CLINICIAN' && !readOnly && (\n            <Button\n              color=\"outline\"\n              className=\"text-white border-white bg-transparent\"\n              onClick={onToggleExport}>\n              取消\n            </Button>\n          )}\n          <Button\n            color=\"outline\"\n            className=\"ml-6 text-white border-white bg-transparent\"\n            loading={exportingJson}\n            onClick={_handleExportJson}>\n            下載 JSON\n          </Button>\n          <Button\n            color=\"outline\"\n            className=\"ml-2 text-white border-white bg-transparent\"\n            loading={exporting}\n            onClick={handleExport}>\n            下載報告\n          </Button>\n        </>\n      )}\n    </div>\n  )\n}\n","import { Anchor } from 'antd'\nimport styled from 'styled-components'\n\nconst StyledAnchor = styled(Anchor)`\n  &.ant-anchor-wrapper {\n    background: transparent;\n  }\n\n  .fixed {\n    position: relative !important;\n  }\n\n  a:hover,\n  .ant-anchor-link-active > .ant-anchor-link-title {\n    color: ${p => p.theme.primary};\n  }\n\n  .ant-anchor-ink-ball {\n    border: 2px solid ${p => p.theme.primary};\n  }\n\n  .ant-anchor-ink::before {\n    /* background-color: ${p => p.theme.secondary}; */\n  }\n`\n\nconst PieChart = styled.div<{\n  legendWidth?: number\n  chartWidth?: number\n}>`\n  &.pie {\n    position: relative;\n\n    .chart {\n      position: relative;\n    }\n\n    &.hasLegend .chart {\n      width: calc(100% - ${p => p.chartWidth + 'px'});\n    }\n\n    .legend {\n      position: absolute;\n      top: 50%;\n      right: 0;\n      min-width: ${p => p.legendWidth}px;\n      margin: 0 20px;\n      padding: 0;\n      list-style: none;\n      transform: translateY(-50%);\n      li {\n        height: 22px;\n        margin-bottom: 16px;\n        line-height: 22px;\n        cursor: pointer;\n        &:last-child {\n          margin-bottom: 0;\n        }\n      }\n    }\n\n    .dot {\n      position: relative;\n      top: -1px;\n      display: inline-block;\n      width: 8px;\n      height: 8px;\n      margin-right: 8px;\n      border-radius: 8px;\n    }\n\n    .line {\n      display: inline-block;\n      width: 1px;\n      height: 16px;\n      margin-right: 8px;\n      background-color: hsv(0, 0, 91%);\n    }\n\n    .legendTitle {\n      color: rgba(0, 0, 0, 0.65);\n    }\n\n    .percent {\n      color: rgba(0, 0, 0, 0.45);\n    }\n\n    .value {\n      position: absolute;\n      right: 0;\n    }\n\n    .title {\n      margin-bottom: 8px;\n    }\n\n    .total {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      max-height: 62px;\n      text-align: center;\n      transform: translate(-50%, -50%);\n      font-size: 14px;\n\n      & > h4 {\n        height: 22px;\n        margin-bottom: 8px;\n        color: rgba(0, 0, 0, 0.45);\n        font-weight: normal;\n        font-size: 14px;\n        line-height: 22px;\n      }\n      & > p {\n        display: block;\n        height: 32px;\n        color: rgba(0, 0, 0, 0.85);\n        font-size: 1.2em;\n        line-height: 32px;\n        white-space: nowrap;\n      }\n    }\n  }\n\n  &.legendBlock {\n    &.hasLegend .chart {\n      width: 100%;\n      margin: 0 0 32px 0;\n    }\n    .legend {\n      position: relative;\n      transform: none;\n    }\n  }\n`\n\nexport { StyledAnchor as Anchor, PieChart }\n","// import { G2 } from 'bizcharts/typings/index'\nimport React from 'react'\nimport { Chart as ChartType } from 'bizcharts/lib/interface'\nimport { Geom, Coordinate as Coord, Chart, Tooltip } from 'bizcharts'\n// import Chart from 'bizcharts/lib/components/Chart'\n// import Tooltip from 'bizcharts/lib/components/Tooltip'\n// import Coord from 'bizcharts/lib/components/Coord'\n// import Geom from 'bizcharts/lib/components/Geom'\nimport { Divider } from 'antd'\nimport classNames from 'classnames'\nimport Debounce from 'lodash.debounce'\nimport autoHeight from './autoHeight'\nimport { PieChart } from './components'\nimport theme from '../../theme'\nconst ReactFitText = require('react-fittext')\nconst { DataView } = require('@antv/data-set')\n\ninterface PieProps {\n  animate?: boolean\n  color?: string\n  colors?: string[]\n  selected?: boolean\n  height?: number\n  margin?: [number, number, number, number]\n  hasLegend?: boolean\n  padding?: [number, number, number, number]\n  percent?: number\n  data?: {\n    x: string | string\n    y: number\n  }[]\n  inner?: number\n  lineWidth?: number\n  forceFit?: boolean\n  style?: React.CSSProperties\n  className?: string\n  total?: React.ReactNode | number | (() => React.ReactNode | number)\n  title?: React.ReactNode\n  tooltip?: boolean\n  valueFormat?: (value: string) => string | React.ReactNode\n  subTitle?: React.ReactNode\n  width?: number\n  legendWidth?: number\n}\n\ninterface PieState {\n  legendData: {\n    checked: boolean\n    x: string\n    color: string\n    percent: number\n    y: string\n  }[]\n  legendBlock: boolean\n}\n\nclass Pie extends React.PureComponent<PieProps, PieState> {\n  state: PieState = {\n    legendData: [],\n    legendBlock: false,\n  }\n\n  requestRef: number | undefined = undefined\n\n  root: HTMLDivElement | undefined = undefined\n\n  chart: ChartType | undefined = undefined\n\n  componentDidMount() {\n    window.addEventListener(\n      'resize',\n      () => {\n        this.requestRef = requestAnimationFrame(() => this.resize())\n      },\n      { passive: true }\n    )\n  }\n\n  componentDidUpdate(preProps: PieProps) {\n    const { data } = this.props\n    if (data !== preProps.data) {\n      // because of charts data create when rendered\n      // so there is a trick for get rendered time\n      this.getLegendData()\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.requestRef) {\n      window.cancelAnimationFrame(this.requestRef)\n    }\n    if (this.resize) {\n      window.removeEventListener('resize', this.resize)\n      this.resize.cancel()\n    }\n  }\n\n  getG2Instance = (_: any, chart: ChartType) => {\n    this.chart = chart\n    requestAnimationFrame(() => {\n      this.getLegendData()\n      this.resize()\n    })\n  }\n\n  // for custom lengend view\n  getLegendData = () => {\n    if (!this.chart) return\n    // const geom = (this.chart as any).getAllGeoms()[0] // 获取所有的图形\n    let geom = null\n    if (!geom) return\n    const items = (geom as any).get('dataArray') || [] // 获取图形对应的\n\n    const legendData = items.map((item: { color: any; _origin: any }[]) => {\n      /* eslint no-underscore-dangle:0 */\n      const origin = item[0]._origin\n      origin.color = item[0].color\n      origin.checked = true\n      return origin\n    })\n\n    this.setState({\n      legendData,\n    })\n  }\n\n  handleRoot = (n: HTMLDivElement) => {\n    this.root = n\n  }\n\n  handleLegendClick = (item: any, i: number) => {\n    const newItem = item\n    newItem.checked = !newItem.checked\n\n    const { legendData } = this.state\n    legendData[i] = newItem\n\n    const filteredLegendData = legendData.filter(l => l.checked).map(l => l.x)\n\n    if (this.chart) {\n      this.chart.filter(\n        'x',\n        (val: any) => filteredLegendData.indexOf(`${val}`) > -1\n      )\n    }\n\n    this.setState({\n      legendData,\n    })\n  }\n\n  resize = Debounce(() => {\n    const { hasLegend } = this.props\n    const { legendBlock } = this.state\n    if (!hasLegend || !this.root) {\n      window.removeEventListener('resize', this.resize)\n      return\n    }\n    if (\n      this.root &&\n      this.root.parentNode &&\n      (this.root.parentNode as HTMLElement).clientWidth <= 380\n    ) {\n      if (!legendBlock) {\n        this.setState({\n          legendBlock: true,\n        })\n      }\n    } else if (legendBlock) {\n      this.setState({\n        legendBlock: false,\n      })\n    }\n  }, 400)\n\n  render() {\n    const {\n      valueFormat,\n      subTitle,\n      total,\n      hasLegend = false,\n      className,\n      style,\n      height,\n      forceFit = true,\n      percent,\n      color,\n      inner = 0.75,\n      animate = true,\n      // colors,\n      lineWidth = 0,\n      width = 240,\n      legendWidth = 250,\n    } = this.props\n\n    const { legendData, legendBlock } = this.state\n    const pieClassName = classNames('pie', className, {\n      hasLegend: !!hasLegend,\n      legendBlock: legendBlock,\n    })\n\n    const {\n      data: propsData,\n      selected: propsSelected = true,\n      tooltip: propsTooltip = true,\n    } = this.props\n\n    let data = propsData || []\n    let selected = propsSelected\n    let tooltip = propsTooltip\n\n    // const defaultColors = colors\n    data = data || []\n    selected = selected || true\n    tooltip = tooltip || true\n    let formatColor = (value: string) => {\n      if (value === '占比') {\n        return color || theme.primary\n      }\n      return '#f0f2f5'\n    }\n\n    const scale = {\n      x: {\n        type: 'cat',\n        range: [0, 1],\n      },\n      y: {\n        min: 0,\n      },\n    }\n\n    if (percent || percent === 0) {\n      selected = false\n      tooltip = false\n\n      data = [\n        {\n          x: '占比',\n          y: parseFloat(`${percent}`),\n        },\n        {\n          x: '反比',\n          y: 100 - parseFloat(`${percent}`),\n        },\n      ]\n    }\n\n    const tooltipFormat = [\n      'x*percent',\n      (x: string, p: number) => ({\n        name: x,\n        value: `${(p * 100).toFixed(2)}%`,\n      }),\n    ]\n\n    const padding = [6, 0, 6, 0]\n\n    const dv = new DataView()\n    dv.source(data).transform({\n      type: 'percent',\n      field: 'y',\n      dimension: 'x',\n      as: 'percent',\n    })\n\n    return (\n      <PieChart\n        ref={this.handleRoot}\n        className={pieClassName}\n        chartWidth={width}\n        style={style}\n        legendWidth={legendWidth}>\n        <ReactFitText maxFontSize={25}>\n          <div className=\"chart\">\n            <Chart\n              scale={scale}\n              height={height}\n              autoFit={forceFit}\n              data={dv}\n              padding={padding}\n              animate={animate}\n              onGetG2Instance={this.getG2Instance}>\n              {!!tooltip && <Tooltip showTitle={false} />}\n              <Coord type=\"theta\" innerRadius={inner} />\n              <Geom\n                style={{ lineWidth, stroke: '#fff' }}\n                tooltip={(tooltip && tooltipFormat) as any}\n                type=\"interval\"\n                position=\"percent\"\n                adjust=\"stack\"\n                color={['x', formatColor as any]}\n                animate={false}\n                label={false}\n                selected={selected}\n              />\n            </Chart>\n\n            {(subTitle || total) && (\n              <div className=\"total\">\n                {subTitle && <h4 className=\"pie-sub-title\">{subTitle}</h4>}\n                {/* eslint-disable-next-line */}\n                {total && (\n                  <div className=\"pie-stat\">\n                    {typeof total === 'function' ? total() : total}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </ReactFitText>\n\n        {hasLegend && (\n          <ul className=\"legend\">\n            {legendData.map((item, i) => (\n              <li key={item.x} onClick={() => this.handleLegendClick(item, i)}>\n                <span\n                  className=\"dot\"\n                  style={{\n                    backgroundColor: !item.checked ? '#aaa' : item.color,\n                  }}\n                />\n                <span className=\"legendTitle\">{item.x}</span>\n                <Divider type=\"vertical\" />\n                <span className=\"percent\">\n                  {`${(Number.isNaN(item.percent)\n                    ? 0\n                    : item.percent * 100\n                  ).toFixed(2)}%`}\n                </span>\n                <span className=\"value\">\n                  {valueFormat ? valueFormat(item.y) : item.y}\n                </span>\n              </li>\n            ))}\n          </ul>\n        )}\n      </PieChart>\n    )\n  }\n}\n\nexport default autoHeight()(Pie)\n","import React from 'react'\nimport cx from 'classnames'\nimport { map } from 'ramda'\nimport { Form, Tooltip } from 'antd'\nimport { DoubleRightOutlined } from '@ant-design/icons'\nimport Collapse from '@/components/collapse'\nimport { Checkbox, CheckboxGroup } from '@/components/checkbox'\nimport Radio from '@/components/radio'\nimport { reportAnnotations, Divisions } from '@/constants/enums'\nimport useAuth from '@/hooks/useAuth'\nimport { MedicalOrder } from '@/constants/types'\nimport { reportStatusEnums } from '@/constants/enums'\nimport { rules } from '@/utils/form'\n\ntype Props = {\n  data?: MedicalOrder | null\n  onSave?: () => void\n  onPhraseOpen?: () => void\n  onToggle?: () => void\n}\n\nexport default function ReportMedicalOrder({ data, onToggle }: Props) {\n  const { user } = useAuth()\n  return (\n    <Collapse\n      activeKey={[1, 2, 3, 4]}\n      expandIcon={() => null}\n      className=\"shadow-2xl\">\n      <Collapse.Panel\n        header={\n          <div className=\"text-center relative\">\n            <Tooltip title=\"收合醫囑內容\">\n              <DoubleRightOutlined\n                className=\"absolute\"\n                style={{ top: 5, left: 15 }}\n                onClick={onToggle}\n              />\n            </Tooltip>\n            醫囑內容\n          </div>\n        }\n        key={1}>\n        <div className=\"border-b border-gray-600 p-3\">\n          申請序號：{data?.orreqno}\n        </div>\n        {user.division === Divisions.PATH && (\n          <div className=\"border-b border-gray-600 p-3\">\n            病理號：{data?.orworkno}\n          </div>\n        )}\n        <div className=\"border-b border-gray-600 p-3\">\n          病患姓名：{data?.hnamec}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">性別：{data?.hsex}</div>\n        <div className=\"border-b border-gray-600 p-3\">\n          申請科別：{data?.csect}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">\n          病歷號：{data?.hhisnum}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">\n          病房：{data?.hnursta}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">\n          病房床號：{data?.hbed}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">\n          出生日期：{data?.hbirthdt || data?.hbirthd2}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">\n          醫囑名稱：{data?.orproced}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">\n          現在輸入：{user.name}\n        </div>\n        <div className=\"border-b border-gray-600 p-3\">審核者：{user.name}</div>\n      </Collapse.Panel>\n      <Collapse.Panel\n        header={<div className=\"text-center\">儲存狀態</div>}\n        key={2}>\n        <Form.Item noStyle name=\"status\" rules={[rules.required]}>\n          <Radio.Group className=\"pl-3\">\n            {map((s: { id: number; name: string }) => (\n              <Radio key={s.id} className=\"block mb-1\" value={s.id}>\n                {s.name}\n              </Radio>\n            ))(reportStatusEnums)}\n          </Radio.Group>\n        </Form.Item>\n      </Collapse.Panel>\n      {user.division === Divisions.PATH && (\n        <Collapse.Panel\n          header={<div className=\"text-center\">報告註記</div>}\n          key={3}>\n          <Form.Item noStyle name=\"annotations\">\n            <CheckboxGroup>\n              {reportAnnotations.map((x, idx) => (\n                <Checkbox\n                  key={`annotations-${idx}`}\n                  className={cx('block ml-0 pl-2', {\n                    'mt-1': idx > 0,\n                  })}\n                  defaultChecked={false}\n                  value={`${idx}`}>\n                  {x}\n                </Checkbox>\n              ))}\n            </CheckboxGroup>\n          </Form.Item>\n        </Collapse.Panel>\n      )}\n      <Collapse.Panel\n        header={<div className=\"text-center\">操作熱鍵</div>}\n        key={4}>\n        <div className=\"pl-6\">\n          <code className=\"bg-yellow-400 px-1\">CTRL+S</code> 儲存\n        </div>\n        <div className=\"pl-6 pt-2\">\n          <code className=\"bg-yellow-400 px-1\">F9</code> 片語視窗\n        </div>\n      </Collapse.Panel>\n    </Collapse>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport { isNil, length, keys, pathOr, gt, __, map, filter } from 'ramda'\nimport cx from 'classnames'\nimport cheerio from 'cheerio'\nimport { Row, Col, Divider as AntDivider, Form } from 'antd'\nimport { useReportJson } from '@/services/report'\nimport { useBreadcrumb } from '@/hooks/useApp'\nimport { useAuth } from '@/hooks/useAuth'\nimport { createFormItemLayout } from '@/utils/form'\nimport { Snippets, SnippetProps, MedicalOrder } from '@/constants/types'\nimport { snippetTypes } from '@/components/snippet-template-list'\nimport { Input } from '@/components/input'\nimport { mapIndexed, toThousandSeparator } from '@/utils/webHelper'\nimport { Divisions } from '@/constants/enums'\nconst { compose } = require('ramda')\n\ntype Props = {\n  className?: string\n  style?: React.CSSProperties\n  data: {\n    template: any\n    snippetList: Snippets\n    medical: MedicalOrder | null\n  }\n  exporting?: boolean\n}\n\nconst formItemLayout = createFormItemLayout(8)\nconst shortFormItemLayout = createFormItemLayout(3)\n\nconst FormItem = styled(Form.Item)`\n  margin-bottom: 12px;\n`\n\nconst Divider = styled(AntDivider)`\n  margin: 16px 0;\n`\n\nconst SnippetPreviewWrapper = styled.div`\n  .ant-card-head {\n    min-height: auto;\n  }\n\n  .ant-card-head-title {\n    padding-top: 0;\n    font-size: 14px;\n  }\n\n  .ant-card-body {\n    padding-top: 6px;\n    padding-bottom: 8px;\n    padding-left: 18px;\n  }\n`\n\nexport default function ReportTypingPreview({ className, style, data }: Props) {\n  useBreadcrumb([{ name: '輸入報告' }, { name: '文件報告' }])\n\n  const { json } = useReportJson({ orreqno: data.template.orreqno })\n\n  const { snippetList, medical } = data\n\n  const { user } = useAuth()\n\n  const getHtmlText = (\n    { html = '', valuesJson = [] }: SnippetProps,\n    idx?: number\n  ) => {\n    const $ = cheerio.load(html)\n\n    const getValue = (idx: number, val: any) => {\n      // PDF 不必替換成編碼\n      return pathOr(toThousandSeparator(val), [idx, 'codexxx'], valuesJson)\n    }\n\n    $('.template-cloze__control').each((idx, el) => {\n      const $el = $(el)\n      $el.replaceWith(\n        (el as any).name === 'select'\n          ? ' '\n          : '' + getValue(idx, $el.val()) + ' '\n      )\n    })\n\n    const div = document.createElement('div')\n    div.innerHTML = $.html()\n\n    const text = div.textContent || div.innerText || ''\n    div.remove()\n\n    return `${!idx ? '' : idx + '. '}${text}`\n  }\n\n  const _snippetList = pathOr(snippetList, ['setting'], json)\n\n  const renderReport = ({ useCode = false }: any = {}) => {\n    return (\n      <>\n        <Row className=\"mb-3\">\n          <Col span={24}>\n            <div className=\"text-xl text-center mt-2\">\n              高雄榮總\n              <span className=\"mx-6\">\n                {user.division === Divisions.RAD ? '放射線部' : '病理檢驗部'}\n              </span>\n              檢查報告單\n            </div>\n          </Col>\n        </Row>\n        <Divider />\n        <Row gutter={16}>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"病房床號\">\n              <Input readOnly bordered={false} value={medical?.hbed} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"病患姓名\">\n              <Input readOnly bordered={false} value={medical?.hnamec} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"病歷號\">\n              <Input readOnly bordered={false} value={medical?.hhisnum} />\n            </FormItem>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"病患性別\">\n              <Input readOnly bordered={false} value={medical?.hsex} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"病患身分\">\n              <Input readOnly bordered={false} value={medical?.cfinancl} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"出生日期\">\n              <Input\n                readOnly\n                bordered={false}\n                value={medical?.hbirthdt || medical?.hbirthd2}\n              />\n            </FormItem>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"申請序號\">\n              <Input readOnly bordered={false} value={medical?.orreqno} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...shortFormItemLayout} label=\"開立科別\">\n              <Input readOnly bordered={false} value={medical?.csect} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            {user.division === Divisions.RAD ? (\n              <FormItem {...formItemLayout} label=\"檢查日期\">\n                <Input readOnly bordered={false} value={'xxxx'} />\n              </FormItem>\n            ) : (\n              <FormItem {...formItemLayout} label=\"病理號\">\n                <Input readOnly bordered={false} value={medical?.orworkno} />\n              </FormItem>\n            )}\n          </Col>\n        </Row>\n        <Row>\n          <Col span={24}>\n            <FormItem {...shortFormItemLayout} label=\"醫囑項目\">\n              <div\n                dangerouslySetInnerHTML={{ __html: `${medical?.orword}` }}\n                style={{\n                  maxWidth: '100%',\n                  whiteSpace: 'initial',\n                  borderBottom: '1px solid #d9d9d9',\n                  paddingBottom: 5,\n                  paddingLeft: 5,\n                  marginLeft: -15,\n                }}\n              />\n            </FormItem>\n          </Col>\n        </Row>\n        {user.division === Divisions.RAD && (\n          <Row>\n            <Col span={24}>\n              <FormItem {...shortFormItemLayout} label=\"檢查日期\">\n                <Input readOnly bordered={false} value={'xxxx'} />\n              </FormItem>\n            </Col>\n          </Row>\n        )}\n        <Divider />\n        <Row>\n          <Col span={24}>\n            <SnippetPreviewWrapper>\n              {compose(\n                map((key: string) => (\n                  <div\n                    key={key}\n                    css={{\n                      fontSize: 15,\n                      lineHeight: 1.65,\n                      color: 'rgba(0, 0, 0, 0.85)',\n                    }}>\n                    {compose(\n                      gt(__, 0),\n                      length,\n                      pathOr([], [key])\n                    )(snippetList) && (\n                      <h2\n                        className=\"my-1 font-normal underline\"\n                        css={{ fontSize: 16 }}>\n                        {key}\n                      </h2>\n                    )}\n                    {compose(\n                      mapIndexed(\n                        ({ setting, ...x }: SnippetProps, idx: number) => (\n                          <div key={x.id}>\n                            {(() => {\n                              let textOnly = key === 'Gross'\n                              let className = `ml-0`\n\n                              if (x.inline) {\n                                return (\n                                  <div\n                                    className={className}\n                                    dangerouslySetInnerHTML={{\n                                      __html: getHtmlText(\n                                        x as any,\n                                        textOnly ? undefined : idx + 1\n                                      ),\n                                    }}\n                                  />\n                                )\n                              }\n\n                              if (x.type === snippetTypes.HEADER) {\n                                return (\n                                  <div className={className}>\n                                    {idx + 1}. {setting.text}\n                                  </div>\n                                )\n                              }\n\n                              return (\n                                <div className={className}>\n                                  {textOnly ? '' : idx + 1 + '.'} {setting.text}\n                                  : {setting.value}\n                                </div>\n                              )\n                            })()}\n                          </div>\n                        )\n                      ),\n                      filter(\n                        ({ setting, ...x }: SnippetProps) =>\n                          (!isNil(setting) && !isNil(setting.value)) ||\n                          x.type === snippetTypes.HEADER ||\n                          x.inline\n                      ),\n                      pathOr([], [key])\n                    )(_snippetList)}\n                  </div>\n                )),\n                keys\n              )(_snippetList)}\n            </SnippetPreviewWrapper>\n          </Col>\n        </Row>\n        <Divider />\n        <Row gutter={16}>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"判讀醫師\">\n              <Input readOnly bordered={false} value={user.name} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"複審醫師\">\n              <Input readOnly bordered={false} value={user.name} />\n            </FormItem>\n          </Col>\n          <Col span={8}>\n            <FormItem {...formItemLayout} label=\"申請醫師\">\n              <Input readOnly bordered={false} value={user.name} />\n            </FormItem>\n          </Col>\n        </Row>\n        <Row gutter={16}>\n          <Col span={12}>\n            <FormItem {...formItemLayout} label=\"報告輸入人員\">\n              <Input bordered={false} />\n            </FormItem>\n          </Col>\n          <Col span={12}>\n            <FormItem {...formItemLayout} label=\"報告複審人員\">\n              <Input bordered={false} />\n            </FormItem>\n          </Col>\n        </Row>\n        <Divider />\n        <Row className=\"mb-4\">\n          <Col span={24}>\n            <div className=\"text-center\">病解專醫字第000001號</div>\n          </Col>\n        </Row>\n\n        <Row className=\"mt-4 hidden\">\n          <Col span={24}>\n            <SnippetPreviewWrapper>\n              {compose(\n                map((key: string) => (\n                  <div\n                    key={key}\n                    css={{\n                      fontSize: 15,\n                      lineHeight: 1.65,\n                      color: 'rgba(0, 0, 0, 0.85)',\n                    }}>\n                    {compose(\n                      gt(__, 0),\n                      length,\n                      pathOr([], [key])\n                    )(snippetList) && (\n                      <h2\n                        className=\"my-1 mt-5 font-normal underline\"\n                        css={{ fontSize: 16 }}>\n                        {key}\n                      </h2>\n                    )}\n                    {compose(\n                      mapIndexed(\n                        ({ setting, ...x }: SnippetProps, _idx: number) => (\n                          <span key={x.id}>\n                            {(() => {\n                              let className = `ml-0`\n\n                              let textOnly = false\n\n                              if (\n                                key === 'Pathological diagnosis' ||\n                                key === 'Notes'\n                              ) {\n                                textOnly = true\n                              }\n\n                              if (x.inline) {\n                                let Tag: any = textOnly ? 'span' : 'div'\n                                return (\n                                  <Tag\n                                    className={className}\n                                    dangerouslySetInnerHTML={{\n                                      __html: getHtmlText(\n                                        x as any,\n                                        textOnly ||\n                                          (key === 'Gross' &&\n                                            length(_snippetList[key]) === 1)\n                                          ? undefined\n                                          : _idx + 1\n                                      ),\n                                    }}\n                                  />\n                                )\n                              }\n\n                              if (x.type === snippetTypes.HEADER) {\n                                return textOnly ? (\n                                  `${setting.text}.`\n                                ) : (\n                                  <div className={className}>\n                                    {_idx + 1}. {setting.text}\n                                  </div>\n                                )\n                              }\n\n                              return textOnly ? (\n                                `${setting.text} ${setting.value}, `\n                              ) : (\n                                <div className={className}>\n                                  {_idx + 1}. {setting.text}: {setting.value}\n                                </div>\n                              )\n                            })()}\n                          </span>\n                        )\n                      ),\n                      filter(\n                        ({ setting, ...x }: SnippetProps) =>\n                          (!isNil(setting) && !isNil(setting.value)) ||\n                          x.type === snippetTypes.HEADER ||\n                          x.inline\n                      ),\n                      pathOr([], [key])\n                    )(_snippetList)}\n                  </div>\n                )),\n                keys\n              )(_snippetList)}\n            </SnippetPreviewWrapper>\n          </Col>\n        </Row>\n      </>\n    )\n  }\n\n  return (\n    <>\n      <div style={style} className={cx('js-export-pdf', className)}>\n        {renderReport()}\n      </div>\n    </>\n  )\n}\n","import React from 'react'\nimport { Affix } from 'antd'\nimport { keys, pathOr } from 'ramda'\nimport { mapIndexed } from '@/utils/webHelper'\nimport { SnippetProps, Snippets } from '@/constants/types'\nimport { Anchor } from './components'\nconst { compose } = require('ramda')\n\nconst { Link } = Anchor\n\ntype Props = {\n  affixed?: boolean\n  onClick: (\n    e: React.MouseEvent<HTMLElement>,\n    link: {\n      title: React.ReactNode\n      href: string\n    }\n  ) => void\n  onChange: (affixed?: boolean) => void\n  snippetList: Snippets\n}\n\nexport default function ReportTypingAffix({\n  affixed = false,\n  onChange,\n  onClick,\n  snippetList,\n}: Props) {\n  return (\n    <Affix offsetTop={0} onChange={onChange}>\n      <Anchor\n        showInkInFixed\n        affix={false}\n        className=\"is--fixed\"\n        style={getAnchorStyles(affixed)}\n        onClick={onClick}>\n        {compose(\n          mapIndexed((key: string, idx: number) => (\n            <Link key={`${key}-${idx}`} href={key} title={key}>\n              {compose(\n                mapIndexed((x: SnippetProps) => (\n                  <Link\n                    key={x.id}\n                    href={`${key}-${x.id}`}\n                    title={pathOr(x.id, ['setting', 'text'], x)}\n                  />\n                )),\n                pathOr([], [key])\n              )(snippetList)}\n            </Link>\n          )),\n          keys\n        )(snippetList)}\n      </Anchor>\n    </Affix>\n  )\n}\n\nfunction getAnchorStyles(affixed?: boolean): React.CSSProperties | undefined {\n  if (!affixed) {\n    return undefined\n  }\n\n  return {\n    marginLeft: -16,\n    marginRight: -16,\n    background: '#fff',\n    padding: 24,\n    borderBottomLeftRadius: 8,\n    borderBottomRightRadius: 8,\n  }\n}\n","import React from 'react'\nimport { Col, Row, Form, Tooltip } from 'antd'\nimport { BulbOutlined, DoubleLeftOutlined } from '@ant-design/icons'\nimport { split, pathOr, join } from 'ramda'\nimport Collapse from '@/components/collapse'\nimport Input from '@/components/input'\nimport SnippetListMenu from '@/components/snippet-list-menu'\nimport { ReportTemplateSelect } from '@/services/report-template'\nimport { Snippets } from '@/constants/types'\nimport useAuth from '@/hooks/useAuth'\nimport ReportAffix from './report-typing-affix'\nconst { compose } = require('ramda')\n\ntype Props = {\n  category: string\n  templateName: string\n  snippetList: Snippets\n  onTabChange: (activeKey: string) => void\n  onLayoutChnage: () => void\n  onReportChange: (value: string) => void\n  onPhraseListModalVisible: () => void\n}\n\nexport default function ReportTypingSideMenu(props: Props) {\n  const {\n    onLayoutChnage,\n    onReportChange,\n    onTabChange,\n    onPhraseListModalVisible,\n    category,\n    templateName,\n    snippetList,\n  } = props\n\n  const { user } = useAuth()\n\n  const [affixed, setIsAffixed] = React.useState<boolean | undefined>(false)\n\n  const handleAffixChange = (affixed?: boolean) => {\n    setIsAffixed(affixed)\n  }\n\n  const handleAnchorClick = (\n    e: React.MouseEvent<HTMLElement>,\n    link: {\n      title: React.ReactNode\n      href: string\n    }\n  ) => {\n    e.preventDefault()\n\n    const [tab, href] = compose(\n      ([tab, ...rest]: string[]) => [tab, join('-')(rest)],\n      split('-'),\n      pathOr('', ['href'])\n    )(link)\n\n    if (category !== 'overview') {\n      onTabChange(tab)\n    }\n\n    if (!href) {\n      return\n    }\n\n    window.scroll({\n      behavior: 'smooth',\n      left: 0,\n      top: document.getElementById(href)?.offsetTop,\n    })\n  }\n\n  return (\n    <>\n      <Col span={5}>\n        <Collapse\n          defaultActiveKey={[1, 2]}\n          expandIcon={() => null}\n          className=\"shadow-2xl\">\n          <Collapse.Panel\n            header={\n              <div className=\"text-center relative\">\n                報告內容\n                <Tooltip title=\"收合報告內容\">\n                  <DoubleLeftOutlined\n                    className=\"absolute cursor-pointer\"\n                    style={{ top: 5, right: 0 }}\n                    onClick={onLayoutChnage}\n                  />\n                </Tooltip>\n              </div>\n            }\n            key={1}>\n            <Row className=\"mb-2 text-sm text-darkGrey\">\n              <Col span={24} className=\"mb-3\">\n                <div className=\"inline-block\" css={{ width: 65 }}>\n                  判讀醫師\n                </div>\n                <Form.Item noStyle name=\"doctor\" initialValue={user.name}>\n                  <Input className=\"w-2/3\" bordered={false} />\n                </Form.Item>\n              </Col>\n              <Col span={24} className=\"my-3\">\n                <div className=\"inline-block\" css={{ width: 65 }}>\n                  申請序號\n                </div>\n                <Form.Item noStyle name=\"orreqno\">\n                  <Input className=\"w-2/3\" bordered={false} />\n                </Form.Item>\n              </Col>\n              <Col span={24} className=\"my-3\">\n                <div className=\"inline-block\" css={{ width: 65 }}>\n                  報告格式\n                </div>\n                <Form.Item\n                  noStyle\n                  name=\"templateName\"\n                  initialValue={templateName}>\n                  <ReportTemplateSelect\n                    className=\"w-2/3\"\n                    onChange={onReportChange}\n                  />\n                </Form.Item>\n              </Col>\n              {category === 'overview' && (\n                <Col span={24} className=\"mt-3\">\n                  <ReportAffix\n                    affixed={affixed}\n                    onClick={handleAnchorClick}\n                    onChange={handleAffixChange}\n                    snippetList={snippetList}\n                  />\n                </Col>\n              )}\n            </Row>\n          </Collapse.Panel>\n          <Collapse.Panel\n            header={<div className=\"text-center\">模版工具</div>}\n            key={2}>\n            <Row>\n              <Col span={24}>\n                <SnippetListMenu />\n                <div\n                  className=\"flex items-center mt-2 cursor-pointer\"\n                  onClick={onPhraseListModalVisible}>\n                  <BulbOutlined className=\"mr-2\" />\n                  Phrase\n                </div>\n              </Col>\n            </Row>\n          </Collapse.Panel>\n        </Collapse>\n      </Col>\n    </>\n  )\n}\n","import React from 'react'\nimport { ColumnProps } from 'antd/lib/table'\nimport { ModalProps } from 'antd/lib/modal'\nimport { flatten, pluck } from 'ramda'\nimport Modal from '@/components/modal'\nimport Table from '@/components/query-table'\nimport Button from '@/components/button'\nimport { usePhraseList } from '@/services/phrase'\nimport { PhraseTemplate, SnippetProps } from '@/constants/types'\nimport useTableRowSelection from '@/hooks/useTableRowSelection'\nconst { compose } = require('ramda')\n\ninterface Props extends Omit<ModalProps, 'onOk'> {\n  onOk: (values: SnippetProps[]) => void\n}\n\nexport default function PhraseListModal({ onOk, onCancel, ...props }: Props) {\n  const { data } = usePhraseList()\n\n  const { rowSelection, selectedRows } = useTableRowSelection()\n\n  const handleOk = () => {\n    onOk(compose(flatten, pluck('setting'))(selectedRows))\n    ;(onCancel as any)()\n  }\n\n  const columns: ColumnProps<PhraseTemplate>[] = [\n    {\n      title: '模版名稱',\n      dataIndex: 'name',\n    },\n    {\n      title: '創作者',\n      dataIndex: 'author',\n    },\n    {\n      title: '狀態',\n      dataIndex: 'statusName',\n    },\n    {\n      title: '創作時間',\n      dataIndex: 'createdAtStr',\n    },\n    {\n      title: '上次修改時間',\n      dataIndex: 'updatedAtStr',\n    },\n    {\n      title: '模版描述',\n      dataIndex: 'description',\n    },\n  ]\n\n  return (\n    <Modal\n      {...props}\n      visible\n      title=\"選擇片語模版\"\n      bodyStyle={{\n        paddingTop: 48,\n        paddingLeft: 64,\n        paddingRight: 64,\n      }}\n      width={800}\n      footer={[\n        <Button key=\"btn-cancel\" color=\"outline\" onClick={onCancel}>\n          取消\n        </Button>,\n        <Button\n          key=\"btn-ok\"\n          color=\"primary\"\n          onClick={handleOk}\n          className=\"ml-3\">\n          確認\n        </Button>,\n      ]}\n      onCancel={onCancel}\n      keyboard={false}\n      maskClosable={false}>\n      <Table\n        size=\"small\"\n        columns={columns}\n        dataSource={data}\n        rowSelection={rowSelection}\n      />\n    </Modal>\n  )\n}\n","import React from 'react'\n\nenum menuState {\n  VISIBLE_RIGHT = '1',\n  VISIBLE_LEFT = '2',\n}\n\nexport default function useLayout() {\n  const [visibleLayouts, setVisibleLayouts] = React.useState<string[]>([\n    menuState.VISIBLE_LEFT,\n    menuState.VISIBLE_RIGHT,\n  ])\n\n  const handleLayoutChange = (value: string) => () => {\n    setVisibleLayouts((prev: string[]) =>\n      prev.includes(value) ? prev.filter(x => x !== value) : [...prev, value]\n    )\n  }\n\n  const toggleLeftMenu = handleLayoutChange(menuState.VISIBLE_LEFT)\n  const toggleRightMenu = handleLayoutChange(menuState.VISIBLE_RIGHT)\n\n  return {\n    visibleLayouts,\n    setVisibleLayouts,\n    toggleLeftMenu,\n    toggleRightMenu,\n    leftContentVisible: visibleLayouts.includes(menuState.VISIBLE_LEFT),\n    rightContentVisible: visibleLayouts.includes(menuState.VISIBLE_RIGHT),\n    handleLayoutChange,\n  }\n}\n","import React from 'react'\nimport { RouteComponentProps } from 'react-router-dom'\nimport { FormInstance } from 'antd/lib/form'\nimport { message } from 'antd'\nimport { equals, isNil, pathOr, head } from 'ramda'\nimport { queryString } from '@/utils/webHelper'\nimport history from '@/utils/history'\nimport { confirm } from '@/utils/message'\nimport { REPORT_INQUIRY } from '@/constants/routes'\nimport { useReportItem, useMedicalOrder } from '@/services/report'\nimport { useReportTemplate } from '@/services/report-template'\nimport { ReportTemplate } from '@/constants/types'\nconst { compose } = require('ramda')\n\ninterface Props extends RouteComponentProps<{ id: string }> {\n  id: any\n  doctor: string\n  orreqno: string\n  form: FormInstance\n  setVisibleLayouts: React.Dispatch<React.SetStateAction<string[]>>\n  onExportableChange: () => void\n}\n\nexport default function useReport({\n  form,\n  setVisibleLayouts,\n  onExportableChange,\n  ...props\n}: Props) {\n  // 沒有 QS 代表是編輯，會有 params.id 要用 useReportItem 取得報告資料後，\n  // 再餵進去 useReportTemplate 作編輯\n  const { params } = props.match\n\n  // 有 QS 代表狀態是新增，此時沒有 params.id，這時的資料要用 reportTemplate\n  const qs = queryString(props.location.search)\n\n  // reset form field values while qs changed\n  React.useEffect(() => {\n    if (qs.doctor) {\n      form.setFieldsValue({ doctor: qs.doctor })\n    }\n    if (qs.orreqno) {\n      form.setFieldsValue({ orreqno: qs.orreqno })\n    }\n  }, [JSON.stringify(qs)]) // eslint-disable-line\n\n  // 新增時使用 QS 的 orreqno，編輯用 pramas.id (/report-input/:id) 的\n  const orreqno = params.id || qs.orreqno\n\n  // reset templateName state while qs.templateName changed\n  React.useEffect(() => {\n    setCurrentTemplateName(qs.templateName)\n  }, [qs.templateName])\n\n  // 只有新增時有 QS 才會有\n  const [templateName, setCurrentTemplateName] = React.useState(qs.templateName)\n\n  const { data: medicalorder, loadingM } = useMedicalOrder({ id: orreqno })\n\n  const { item, loading: loadingData } = useReportItem({\n    id: orreqno,\n    onError: response => {\n      if (equals('ORREQNO is not exist.', response?.message)) {\n        history.push(REPORT_INQUIRY)\n        message.error('申請序號不存在，請重新輸入')\n      }\n    },\n  })\n\n  const {\n    loading,\n    reportTemplate,\n    setReportTemplate,\n    ...rest\n  } = useReportTemplate({\n    id: templateName,\n    data: item,\n    shouldFetch: !isNil(templateName),\n    errorMsg: false,\n    onCompleted: response => {\n      const template: ReportTemplate = compose(\n        head,\n        pathOr([], ['template'])\n      )(response)\n      if (!template) {\n        return\n      }\n\n      if (template.templateName) {\n        form.setFieldsValue({ templateId: reportTemplate.templateName })\n        setCurrentTemplateName(reportTemplate.templateName)\n      }\n    },\n  })\n\n  const handleReportTemplateChange = (value: string) => {\n    confirm({\n      content: '變更後會以新模版來取代原有的模版問題，確認要變更嗎？',\n      okText: '確認變更',\n      onOk: () => {\n        setCurrentTemplateName(value)\n        setReportTemplate(prev => ({ ...prev, templateName: value }))\n      },\n      onCancel: () => form.setFieldsValue({ templateName }),\n    })\n  }\n\n  // reset form field values while report data changed\n  React.useEffect(() => {\n    if (reportTemplate) {\n      form.setFieldsValue(reportTemplate)\n    }\n    // avoid use report template status\n    if (reportTemplate.status === 's') {\n      form.setFieldsValue({ status: undefined })\n    }\n    if (reportTemplate.orstatus === '完成') {\n      setVisibleLayouts([])\n      onExportableChange()\n    }\n  }, [JSON.stringify(reportTemplate)]) // eslint-disable-line\n\n  const _loading = loading || loadingM || loadingData\n\n  return {\n    ...rest,\n    templateName,\n    reportTemplate,\n    medicalorder,\n    handleReportTemplateChange,\n    readOnly: reportTemplate.orstatus === '完成',\n    loading: _loading,\n  }\n}\n","import React, { useEffect } from 'react'\nimport { RouteComponentProps } from 'react-router-dom'\nimport { Row, Col, BackTop, Affix, Form, message, Tooltip, Spin } from 'antd'\nimport { LeftOutlined, RightOutlined } from '@ant-design/icons'\nimport cx from 'classnames'\nimport moment from 'moment'\nimport {\n  map,\n  pathOr,\n  keys,\n  gt,\n  __,\n  length,\n  ifElse,\n  equals,\n  always,\n  filter,\n  values,\n  not,\n  replace,\n  join,\n  toPairs,\n  head,\n  update,\n  is,\n  T,\n  identity,\n  flatten,\n  sum,\n  pluck,\n  toUpper,\n} from 'ramda'\nimport cheerio from 'cheerio'\nimport useTitle from '@/hooks/useTitle'\nimport useVisible from '@/hooks/useVisible'\nimport { useBreadcrumb, useHeaderContent } from '@/hooks/useApp'\nimport useAuth from '@/hooks/useAuth'\nimport { isNil, uuid, mapIndexed } from '@/utils/webHelper'\nimport { SnippetProps } from '@/constants/types'\nimport { Page } from '@/components/layout'\nimport ReactDndProvider from '@/components/snippet-scrollable-container'\nimport SnippetsContainer from '@/components/snippets-container'\nimport { renderSnippets } from '@/components/snippet-utils'\nimport Tabs from '@/components/draggable-tabs'\nimport {\n  useToggleReportPreview,\n  useAllReportTemplates,\n} from '@/services/report-template'\nimport { useCreateOrUpdateReport } from '@/services/report'\nimport history from '@/utils/history'\nimport { Divisions } from '@/constants/enums'\nimport { REPORT_EDIT } from '@/constants/routes'\nimport Pie from './pie'\nimport Header from './report-typing-header'\nimport ReportMedicalOrder from './report-typing-medical-order'\nimport ReportPreview from './report-typing-preview'\nimport ReportSideMenu from './report-typing-sidemenu'\nimport PhraseListModal from './phrase-list-modal'\nimport useReport from './useReport'\nimport useLayout from './useLayout'\nconst { compose, cond } = require('ramda')\n\ninterface Props extends RouteComponentProps<{ id: string }> {\n  id: any\n  doctor: string\n  orreqno: string\n}\n\nconst col = ifElse(equals(false), always(5), always(0))\n\nexport default function ReportTyping(props: Props) {\n  const { user } = useAuth()\n\n  useToggleReportPreview(true)\n  useTitle('輸入報告')\n  useBreadcrumb([\n    { name: '輸入報告' },\n    {\n      name: user.division === Divisions.PATH ? '病理報告輸入' : '放射報告輸入',\n    },\n  ])\n\n  const { params } = props.match\n  const [form] = Form.useForm()\n\n  const [exportable, handleExportable] = useVisible()\n\n  const {\n    setVisibleLayouts,\n    leftContentVisible,\n    rightContentVisible,\n    toggleLeftMenu,\n    toggleRightMenu,\n  } = useLayout()\n\n  const {\n    loading,\n    total,\n    category,\n    reportTemplate,\n    snippetList,\n    handleTabEdit,\n    handleTabChange,\n    handleTabMove,\n    handleTabNameChange,\n    handleSnippetUpdate,\n    handleReportTemplateChange,\n    templateName,\n    medicalorder,\n    readOnly,\n  } = useReport({\n    ...props,\n    form,\n    setVisibleLayouts,\n    onExportableChange: handleExportable,\n  })\n\n  useEffect(() => {\n    const handleKeyPress = (evt: KeyboardEvent) => {\n      if (exportable) {\n        return\n      }\n\n      if (\n        (evt.ctrlKey && toUpper(evt.key) === 'W') ||\n        (evt.ctrlKey && toUpper(evt.key) === 'S')\n      ) {\n        evt.preventDefault()\n        evt.stopPropagation()\n      }\n\n      // ctrl + s\n      if (evt.ctrlKey && toUpper(evt.key) === 'S') {\n        handleOk()\n      }\n      // f9\n      if (!evt.ctrlKey && evt.key === 'F9') {\n        handlePhraseListModalVisible()\n      }\n    }\n\n    window.addEventListener('keydown', handleKeyPress)\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress)\n    }\n    // eslint-disable-next-line\n  }, [\n    JSON.stringify(snippetList), // eslint-disable-line\n    JSON.stringify(reportTemplate), // eslint-disable-line\n    JSON.stringify(medicalorder), // eslint-disable-line\n  ])\n\n  useEffect(() => {\n    if (user.division !== Divisions.PATH && user.division !== Divisions.RAD) {\n      handleExportable()\n    }\n  }, [user.division]) // eslint-disable-line\n\n  const [phraseListModalVisible, handlePhraseListModalVisible] = useVisible()\n\n  const [creating, handleCreateOrUpdate] = useCreateOrUpdateReport({\n    onCompleted: response => {\n      history.push(replace(':id', response?.data.orreqno)(REPORT_EDIT))\n      message.success('報告已儲存成功')\n    },\n  })\n\n  const { templateByName } = useAllReportTemplates()\n\n  const handleOk = () => {\n    form\n      .validateFields()\n      .then(values => {\n        handleCreateOrUpdate({\n          ...values,\n          ...(params.id ? { orreqno: params.id } : {}),\n          hhisnum: medicalorder?.hhisnum || reportTemplate.hhisnum,\n          templateId: pathOr(\n            reportTemplate.templateId,\n            [values.templateName, 'id'],\n            templateByName\n          ),\n          setting: snippetList,\n        })\n      })\n      .catch(error => {\n        message.config({ maxCount: 1 })\n        message.error(\n          compose(\n            join('\\n'),\n            map(\n              (x: any) =>\n                `${compose(\n                  pathOr('', []),\n                  head,\n                  pathOr([], ['name'])\n                )(x)}: ${compose(join('、'), pathOr([], ['errors']))(x)}`\n            ),\n            pathOr([], ['errorFields'])\n          )(error)\n        )\n      })\n  }\n\n  useHeaderContent(\n    <Header\n      readOnly={readOnly}\n      data={reportTemplate}\n      isExport={exportable}\n      onToggleExport={handleExportable}\n      onOk={handleOk}\n    />\n  )\n\n  const [percentage, setPercentage] = React.useState(0)\n\n  const handlePhraseAdd = (values: SnippetProps[]) => {\n    let newList = [\n      ...snippetList[category],\n      ...values.map(x => ({\n        ...x,\n        fromMenu: false,\n        id: `${x.id}__${uuid()}`,\n      })),\n    ]\n\n    handleSnippetUpdate(newList)\n  }\n\n  React.useEffect(() => {\n    handlePercentageChange(snippetList)\n  }, [JSON.stringify(snippetList)]) // eslint-disable-line\n\n  const handlePercentageChange = (data: any) => {\n    const topic = compose(\n      length,\n      filter(compose(not, isNil)),\n      pluck('value'),\n      pluck('setting'),\n      flatten,\n      values\n    )(snippetList)\n\n    const cloze = compose(\n      sum,\n      map((x: SnippetProps) => {\n        const $ = cheerio.load(x.html)\n\n        let isAnswer = true\n\n        $('input').each((_, el) => {\n          if (isNil($(el).val())) {\n            isAnswer = false\n            return\n          }\n        })\n        $('select').each((_, el) => {\n          if (isNil($(el).val())) {\n            isAnswer = false\n            return\n          }\n        })\n\n        return isAnswer ? 1 : 0\n      }),\n      filter((x: SnippetProps) => x.type === 'TemplateCloze'),\n      flatten,\n      values\n    )(snippetList)\n\n    setPercentage(Math.round(((topic + cloze) / total) * 100))\n  }\n\n  type FormValuesChangeHandler = (\n    changedValues: any,\n    data: { data: { [key: string]: any } }\n  ) => void\n\n  const handleValuesChange: FormValuesChangeHandler = (changedValues, _) => {\n    if (!changedValues) {\n      return\n    }\n\n    const [id, value] = compose(\n      pathOr([], []),\n      head,\n      toPairs,\n      pathOr({}, ['data'])\n    )(changedValues)\n\n    if (!id) {\n      return\n    }\n\n    // 更新答案，moment格式要轉成日期字串\n    const list = snippetList[category]\n    const snippet = list.filter(x => x.id === id)[0]\n    const index = list.indexOf(snippet)\n\n    handleSnippetUpdate(\n      update(\n        index,\n        {\n          ...snippet,\n          setting: {\n            ...snippet.setting,\n            value: cond([\n              [is(Array), join('、')],\n              [\n                (val: any) => moment.isMoment(val),\n                (val: any) =>\n                  snippet.type === 'TemplateDate'\n                    ? val.format('YYYY/MM/DD')\n                    : val.format('HH:mm:ss'),\n              ],\n              [T, identity],\n            ])(value),\n          },\n        },\n        list\n      )\n    )\n  }\n\n  React.useEffect(() => {\n    handleValuesChange(null, form.getFieldsValue())\n  }, [total]) // eslint-disable-line\n\n  const renderCategory = (category: string) => {\n    return compose(gt(__, 0), length, pathOr([], [category]))(snippetList) ? (\n      <h2 id={category} className=\"my-2\">\n        {category}\n      </h2>\n    ) : null\n  }\n\n  const renderORWord = (idx: number) => {\n    const orword = pathOr(reportTemplate?.orword, ['orword'], medicalorder)\n    return (\n      !!orword &&\n      idx === 0 && (\n        <div\n          className=\"mb-4 px-1\"\n          dangerouslySetInnerHTML={{\n            __html: `${orword}`,\n          }}\n        />\n      )\n    )\n  }\n\n  const colSpan = 14 + col(leftContentVisible) + col(rightContentVisible)\n\n  const morder: any =\n    user.division === Divisions.PATH ? medicalorder : reportTemplate\n\n  return (\n    <ReactDndProvider className=\"is--preview\">\n      {phraseListModalVisible && (\n        <PhraseListModal\n          onOk={handlePhraseAdd}\n          onCancel={handlePhraseListModalVisible}\n        />\n      )}\n      <BackTop />\n      <Spin spinning={loading || creating}>\n        <Page>\n          <Form\n            form={form}\n            labelAlign={exportable ? 'left' : 'right'}\n            className=\"relative\"\n            onValuesChange={handleValuesChange}>\n            {!leftContentVisible && !readOnly && (\n              <Tooltip title=\"展開報告內容\">\n                <div\n                  className=\"absolute z-10 bg-secondary text-white rounded-tr-md rounded-br-md flex items-center justify-center cursor-pointer py-2 pl-1\"\n                  css={{ left: -40, top: 7 }}\n                  onClick={toggleLeftMenu}>\n                  <RightOutlined className=\"text-xl\" />\n                </div>\n              </Tooltip>\n            )}\n            <Row gutter={16}>\n              {leftContentVisible && (\n                <ReportSideMenu\n                  onLayoutChnage={toggleLeftMenu}\n                  onReportChange={handleReportTemplateChange}\n                  onTabChange={handleTabChange}\n                  onPhraseListModalVisible={handlePhraseListModalVisible}\n                  snippetList={snippetList}\n                  category={category}\n                  templateName={templateName}\n                />\n              )}\n              <Col span={colSpan}>\n                {!exportable && (\n                  <>\n                    <div className=\"pt-2 bg-white rounded-lg shadow-2xl\">\n                      <Affix offsetTop={0}>\n                        <div\n                          className={cx(\n                            'px-4 mb-4 -mt-2',\n                            'flex items-center justify-between',\n                            'rounded-lg shadow-sm',\n                            'text-xl text-darkGrey font-medium'\n                          )}\n                          css={{ background: '#fff' }}>\n                          <div>\n                            {user.division === Divisions.PATH\n                              ? 'Pathological'\n                              : 'Radiological'}{' '}\n                            Image Report\n                            <div className=\"text-base text-gray-600\"></div>\n                          </div>\n                          <Pie\n                            percent={percentage}\n                            total={`${percentage || 0}%`}\n                            style={{ width: 70, paddingTop: 6 }}\n                            height={80}\n                          />\n                        </div>\n                      </Affix>\n                    </div>\n                    <div className=\"rounded-lg shadow-2xl\">\n                      <Tabs\n                        type=\"editable-card\"\n                        activeKey={category}\n                        onChange={handleTabChange}\n                        onEdit={handleTabEdit}\n                        tabBarGutter={8}\n                        moveTabNode={handleTabMove}\n                        className=\"flex-1\">\n                        {compose(\n                          mapIndexed((category: string, idx: number) => (\n                            <Tabs.TabPane\n                              closable\n                              key={category}\n                              tab={\n                                <span\n                                  contentEditable\n                                  suppressContentEditableWarning\n                                  spellCheck={false}\n                                  className=\"outline-none\"\n                                  css={{ whiteSpace: 'nowrap' }}\n                                  onBlur={handleTabNameChange(category)}>\n                                  {category}\n                                </span>\n                              }>\n                              <Col\n                                span={24}\n                                className=\"p-4 report-template-builder__main-content\">\n                                {renderORWord(idx)}\n                                <SnippetsContainer\n                                  draggable\n                                  snippetList={snippetList[category]}\n                                  onSnippetUpdate={handleSnippetUpdate}\n                                />\n                              </Col>\n                            </Tabs.TabPane>\n                          )),\n                          keys\n                        )(snippetList)}\n                        <Tabs.TabPane key=\"overview\" tab=\"Overview\">\n                          {compose(\n                            map((category: string) => (\n                              <div key={category} className=\"px-3 bg-white\">\n                                {renderCategory(category)}\n                                {compose(\n                                  renderSnippets({ className: 'mb-0' }),\n                                  pathOr([], [category])\n                                )(snippetList)}\n                              </div>\n                            )),\n                            keys\n                          )(snippetList)}\n                        </Tabs.TabPane>\n                      </Tabs>\n                    </div>\n                  </>\n                )}\n                {exportable && (\n                  <div className=\"rounded-log shadow-2x bg-white p-3 px-5\">\n                    <div id=\"editor\" />\n                    <ReportPreview\n                      data={{\n                        template: reportTemplate,\n                        medical: morder,\n                        snippetList,\n                      }}\n                    />\n                  </div>\n                )}\n              </Col>\n\n              {rightContentVisible && (\n                <Col span={5}>\n                  <ReportMedicalOrder\n                    data={morder}\n                    onToggle={toggleRightMenu}\n                  />\n                </Col>\n              )}\n            </Row>\n            {!rightContentVisible && !readOnly && (\n              <Tooltip title=\"展開醫囑內容\">\n                <div\n                  className=\"absolute z-10 bg-secondary text-white rounded-tl-md rounded-bl-md flex items-center justify-center cursor-pointer py-2 pr-1\"\n                  css={{ right: -49, top: 7 }}\n                  onClick={toggleRightMenu}>\n                  <LeftOutlined className=\"text-xl\" />\n                </div>\n              </Tooltip>\n            )}\n          </Form>\n        </Page>\n      </Spin>\n    </ReactDndProvider>\n  )\n}\n","import ReportTyping from './report-typing'\n\nexport default ReportTyping\n// import React from 'react'\n\n// export default React.lazy(() => import('../report-typing/report-typing'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./report-list'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./radiol-report-list'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./yellow-card-inquiry'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./blood-bank-review'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./medical-order'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./phrase-list'))\n\nexport const PhraseList = React.lazy(() => import('./phrase-list'))\n\nexport const PhraseEdit = React.lazy(() => import('./phrase-edit'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./report-version-comparison'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./image-scheduler'))\n","import React from 'react'\n\nexport default React.lazy(() => import('./image-viewer-tutorial'))\n","import ReportTemplateBuilder from '@/containers/report-template-editor'\nimport ReportTemplateList from '@/containers/report-template-list'\nimport ReportInquiry from '@/containers/report-inquiry'\nimport ReportTyping from '@/containers/report-typing'\n// import PatholImagesViewer from '@/containers/pathol-images-viewer'\n// import RadiolImagesViewer from '@/containers/radiol-images-viewer'\nimport ReportList from '@/containers/report-list'\nimport RadiolReportList from '@/containers/radiol-report-list'\nimport YellowCardInquiry from '@/containers/yellow-card-inquiry'\nimport BloodBankReview from '@/containers/blood-bank-review'\nimport MedicalOrder from '@/containers/medical-order'\nimport { PhraseList, PhraseEdit } from '@/containers/phrase-list'\nimport ReportVersionComparison from '@/containers/report-version-comparison'\nimport ImageScheduler from '@/containers/image-scheduler'\nimport ImageViewerTutorial from '@/containers/image-viewer-tutorial'\nimport useAuth from '@/hooks/useAuth'\nimport { Divisions } from './enums'\n\nexport type RouteItem = {\n  id: number\n  title: string\n  path: string\n  component: typeof React.Component\n  icon?: React.FunctionComponent\n  disabled?: boolean\n  param?: string\n  children?: RouteItem[]\n  hide?: RouteItem[]\n}\n\nexport type Route = RouteItem & {\n  children: Array<RouteItem>\n  hide: Array<RouteItem>\n  disabled: boolean\n}\n\nexport const PATHOL_IMAGE = '/pathol-images/:studyInstanceUIDs'\nexport const RADIOL_IMAGE = '/radiol-images/:studyInstanceUIDs'\nexport const REPORT_TEMPLATE_LIST = '/report-templates'\nexport const REPORT_INPUT = '/report-input'\nexport const REPORT_EDIT = `${REPORT_INPUT}/:id`\nexport const REPORT_TEMPLATE_EDIT = `${REPORT_TEMPLATE_LIST}/:id`\nexport const REPORT_TEMPLATE_CREATE = `${REPORT_TEMPLATE_LIST}/create`\nexport const REPORT_INQUIRY = '/report-inquiry'\nexport const REPORT_VERSION_COMPARISON = '/report-version-comparison'\nexport const REPORT_LIST = '/report-list'\nexport const RADIOL_REPORT_LIST = '/radiol-report-list'\nexport const PHRASE_LIST = '/phrase-list'\nexport const PHRASE_CREATE = '/phrase-list/create'\nexport const PHRASE_EDIT = `${PHRASE_LIST}/:id`\nexport const BLOOD_BANK_REVIEW = '/blood-bank-review'\nexport const YELLOW_CARD_INQUIRY = '/yellow-card-inquiry'\nexport const MEDICAL_ORDER = '/medical-order/:id'\nexport const IMAGE_SCHEDULER = '/image-scheduler'\nexport const IMAGE_VIEWER_TUTORIAL = '/image-viewer-tutorial'\n\nexport function useRoutes() {\n  const { user } = useAuth()\n\n  const isPATH = user.division === Divisions.PATH\n  const isRAD = user.division === Divisions.RAD\n  const isClinician = user.isClinician\n  const isUsePATH = user.isClinician && user.division === Divisions.PATH\n\n  const viewPath = isPATH || (isClinician && isUsePATH)\n  const viewRad = isRAD || (isClinician && !isUsePATH)\n\n  return [\n    // {\n    //   id: 1,\n    //   title: '病理影像',\n    //   path: PATHOL_IMAGE,\n    //   component: PatholImagesViewer,\n    // },\n    // {\n    //   id: 2,\n    //   title: '放射影像',\n    //   path: RADIOL_IMAGE,\n    //   component: RadiolImagesViewer,\n    // },\n    ...(viewPath\n      ? [\n          {\n            id: 666,\n            title: '影像排班',\n            path: IMAGE_SCHEDULER,\n            component: ImageScheduler,\n          },\n          {\n            id: 999,\n            title: '報告查詢',\n            path: REPORT_LIST,\n            component: ReportList,\n          },\n        ]\n      : []),\n    ...(viewRad\n      ? [\n          {\n            id: 99999,\n            title: '報告查詢',\n            path: REPORT_LIST,\n            component: RadiolReportList,\n          },\n          {\n            id: 99999878,\n            title: '報告查詢',\n            path: RADIOL_REPORT_LIST,\n            component: RadiolReportList,\n          },\n        ]\n      : []),\n    {\n      id: 3,\n      title: '輸入報告',\n      path: REPORT_INQUIRY,\n      component: ReportInquiry,\n    },\n    {\n      id: 15,\n      title: '輸入報告',\n      path: REPORT_EDIT,\n      component: ReportTyping,\n    },\n    {\n      id: 10,\n      title: '輸入報告',\n      path: REPORT_INPUT,\n      component: ReportTyping,\n    },\n    {\n      id: 87878,\n      title: '版本比較',\n      path: REPORT_VERSION_COMPARISON,\n      component: ReportVersionComparison,\n    },\n    {\n      id: 87,\n      title: '黃卡新檢索',\n      path: YELLOW_CARD_INQUIRY,\n      component: YellowCardInquiry,\n    },\n    {\n      id: 88,\n      title: '血庫備血審查作業',\n      path: BLOOD_BANK_REVIEW,\n      component: BloodBankReview,\n    },\n    {\n      id: 89,\n      title: '醫囑內容',\n      path: MEDICAL_ORDER,\n      component: MedicalOrder,\n    },\n    {\n      id: 90,\n      title: '片語模版',\n      path: 'phrase',\n      children: [\n        {\n          id: 93,\n          title: '片語模版清單',\n          path: PHRASE_LIST,\n          component: PhraseList,\n        },\n        {\n          id: 94,\n          title: '片語模版編輯',\n          path: PHRASE_CREATE,\n          component: PhraseEdit,\n        },\n        {\n          id: 95,\n          title: '片語模版編輯',\n          path: PHRASE_EDIT,\n          component: PhraseEdit,\n        },\n      ],\n    },\n    {\n      id: 4,\n      title: '結構式報告模版',\n      path: 'report-template',\n      children: [\n        {\n          id: 5,\n          title: '報告模版清單',\n          path: REPORT_TEMPLATE_LIST,\n          component: ReportTemplateList,\n        },\n        {\n          id: 6,\n          title: '報告模版新增',\n          path: REPORT_TEMPLATE_CREATE,\n          component: ReportTemplateBuilder,\n        },\n        {\n          id: 7,\n          title: '報告模版編輯',\n          path: REPORT_TEMPLATE_EDIT,\n          component: ReportTemplateBuilder,\n        },\n      ],\n    },\n    {\n      id: 878788,\n      title: '影像教學',\n      path: IMAGE_VIEWER_TUTORIAL,\n      component: ImageViewerTutorial,\n    },\n  ]\n}\n\nexport default useRoutes\n","import React from 'react'\nimport { Layout } from 'antd'\nimport cx from 'classnames'\nimport AppFooter from '@/components/app-footer'\nimport theme from '../theme'\n\ninterface PageProps {\n  children: React.ReactNode\n  style?: React.CSSProperties\n  className?: string\n  wrapperClassName?: string\n  wrapperStyle?: React.CSSProperties\n}\n\nexport function Page({ children, style, className = 'pr-12' }: PageProps) {\n  return (\n    <Layout>\n      <Layout.Content\n        style={{\n          background: `linear-gradient(-90deg,#42c2b8,${theme.primary})`,\n        }}>\n        <div\n          className={cx('pl-8 pt-6 pb-12', className)}\n          style={style}\n          css={{\n            background: 'rgb(221, 228, 237)',\n            // borderTopLeftRadius: 32,\n            // borderTopRightRadius: 32,\n          }}>\n          {children}\n        </div>\n      </Layout.Content>\n      <AppFooter />\n    </Layout>\n  )\n}\n","import React from 'react'\nimport { replace } from 'ramda'\nimport { envStore } from '@/constants/env'\n\nexport interface UseTitleOptions {\n  restoreOnUnmount?: boolean\n}\n\nconst DEFAULT_USE_TITLE_OPTIONS: UseTitleOptions = {\n  restoreOnUnmount: false,\n}\n\nfunction useTitle(\n  title: string,\n  options: UseTitleOptions = DEFAULT_USE_TITLE_OPTIONS\n) {\n  const prevTitleRef = React.useRef(document.title)\n  document.title = replace(/%s/, title)(envStore.appTitle)\n  React.useEffect(() => {\n    if (options && options.restoreOnUnmount) {\n      return () => {\n        document.title = prevTitleRef.current // eslint-disable-line\n      }\n    } else {\n      return\n    }\n  }, []) // eslint-disable-line\n}\n\nexport default typeof document !== 'undefined'\n  ? useTitle\n  : (_title: string) => {}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { findDOMNode } from 'react-dom'\nimport { DndContext } from 'react-dnd'\nimport throttle from 'lodash.throttle'\nimport raf from 'raf'\nimport hoist from 'hoist-non-react-statics'\nimport getDisplayName from '@/utils/get-display-name'\n\nfunction noop() {}\n\nfunction intBetween(min, max, val) {\n  return Math.floor(Math.min(max, Math.max(min, val)))\n}\n\nfunction getCoords(evt) {\n  if (evt.type === 'touchmove') {\n    return {\n      x: evt.changedTouches[0].clientX,\n      y: evt.changedTouches[0].clientY,\n    }\n  }\n\n  return { x: evt.clientX, y: evt.clientY }\n}\n\nconst DEFAULT_BUFFER = 150\n\nexport function createHorizontalStrength(_buffer) {\n  return function defaultHorizontalStrength({ x, w, y, h }, point) {\n    const buffer = Math.min(w / 2, _buffer)\n    const inRange = point.x >= x && point.x <= x + w\n    const inBox = inRange && point.y >= y && point.y <= y + h\n\n    if (inBox) {\n      if (point.x < x + buffer) {\n        return (point.x - x - buffer) / buffer\n      } else if (point.x > x + w - buffer) {\n        return -(x + w - point.x - buffer) / buffer\n      }\n    }\n\n    return 0\n  }\n}\n\nexport function createVerticalStrength(_buffer) {\n  return function defaultVerticalStrength({ y, h, x, w }, point) {\n    const buffer = Math.min(h / 2, _buffer)\n    const inRange = point.y >= y && point.y <= y + h\n    const inBox = inRange && point.x >= x && point.x <= x + w\n\n    if (inBox) {\n      if (point.y < y + buffer) {\n        return (point.y - y - buffer) / buffer\n      } else if (point.y > y + h - buffer) {\n        return -(y + h - point.y - buffer) / buffer\n      }\n    }\n\n    return 0\n  }\n}\n\nexport const defaultHorizontalStrength = createHorizontalStrength(\n  DEFAULT_BUFFER\n)\n\nexport const defaultVerticalStrength = createVerticalStrength(DEFAULT_BUFFER)\n\nexport default function createScrollingComponent(WrappedComponent) {\n  class ScrollingComponent extends React.Component {\n    static displayName = `Scrolling(${getDisplayName(WrappedComponent)})`\n\n    static propTypes = {\n      onScrollChange: PropTypes.func,\n      verticalStrength: PropTypes.func,\n      horizontalStrength: PropTypes.func,\n      strengthMultiplier: PropTypes.number,\n    }\n\n    static defaultProps = {\n      useScroll: true,\n      onScrollChange: noop,\n      verticalStrength: defaultVerticalStrength,\n      horizontalStrength: defaultHorizontalStrength,\n      strengthMultiplier: 30,\n    }\n\n    static contextType = DndContext\n\n    constructor(props, ctx) {\n      super(props, ctx)\n\n      this.scaleX = 0\n      this.scaleY = 0\n      this.frame = null\n\n      this.attached = false\n      this.dragging = false\n    }\n\n    componentDidMount() {\n      if (this.props.useScroll) {\n        this._initial()\n      }\n    }\n\n    _initial() {\n      // window.document.body.addEventListener('dragover', this.handleEvent);\n      this.container = findDOMNode(this.wrappedInstance)\n      this.container.addEventListener('dragover', this.handleEvent)\n      // touchmove events don't seem to work across siblings, so we unfortunately\n      // have to attach the listeners to the body\n      window.document.body.addEventListener('touchmove', this.handleEvent)\n\n      this.clearMonitorSubscription = this.context.dragDropManager\n        .getMonitor()\n        .subscribeToStateChange(() => this.handleMonitorChange())\n    }\n\n    componentWillUnmount() {\n      if (this.props.useScroll) {\n        this._remove()\n      }\n    }\n\n    _remove() {\n      // window.document.body.removeEventListener('dragover', this.handleEvent);\n      this.container.removeEventListener('dragover', this.handleEvent)\n      window.document.body.removeEventListener('touchmove', this.handleEvent)\n      this.clearMonitorSubscription()\n      this.stopScrolling()\n    }\n\n    handleEvent = evt => {\n      if (this.dragging && !this.attached) {\n        this.attach()\n        this.updateScrolling(evt)\n      }\n    }\n\n    handleMonitorChange() {\n      const isDragging = this.context.dragDropManager.getMonitor().isDragging()\n\n      if (!this.dragging && isDragging) {\n        this.dragging = true\n      } else if (this.dragging && !isDragging) {\n        this.dragging = false\n        this.stopScrolling()\n      }\n    }\n\n    attach() {\n      this.attached = true\n      window.document.body.addEventListener('dragover', this.updateScrolling)\n      window.document.body.addEventListener('touchmove', this.updateScrolling)\n    }\n\n    detach() {\n      this.attached = false\n      window.document.body.removeEventListener('dragover', this.updateScrolling)\n      window.document.body.removeEventListener(\n        'touchmove',\n        this.updateScrolling\n      )\n    }\n\n    // Update scaleX and scaleY every 100ms or so\n    // and start scrolling if necessary\n    updateScrolling = throttle(\n      evt => {\n        const {\n          left: x,\n          top: y,\n          width: w,\n          height: h,\n        } = this.container.getBoundingClientRect()\n        const box = { x, y, w, h }\n        const coords = getCoords(evt)\n\n        // calculate strength\n        this.scaleX = this.props.horizontalStrength(box, coords)\n        this.scaleY = this.props.verticalStrength(box, coords)\n\n        // start scrolling if we need to\n        if (!this.frame && (this.scaleX || this.scaleY)) {\n          this.startScrolling()\n        }\n      },\n      100,\n      { trailing: false }\n    )\n\n    startScrolling() {\n      let i = 0\n      const tick = () => {\n        const { scaleX, scaleY, container } = this\n        const { strengthMultiplier, onScrollChange } = this.props\n\n        // stop scrolling if there's nothing to do\n        if (strengthMultiplier === 0 || scaleX + scaleY === 0) {\n          this.stopScrolling()\n          return\n        }\n\n        // there's a bug in safari where it seems like we can't get\n        // mousemove events from a container that also emits a scroll\n        // event that same frame. So we double the strengthMultiplier and only adjust\n        // the scroll position at 30fps\n        if (i++ % 2) {\n          const {\n            scrollLeft,\n            scrollTop,\n            scrollWidth,\n            scrollHeight,\n            clientWidth,\n            clientHeight,\n          } = container\n\n          const newLeft = scaleX\n            ? (container.scrollLeft = intBetween(\n                0,\n                scrollWidth - clientWidth,\n                scrollLeft + scaleX * strengthMultiplier\n              ))\n            : scrollLeft\n\n          const newTop = scaleY\n            ? (container.scrollTop = intBetween(\n                0,\n                scrollHeight - clientHeight,\n                scrollTop + scaleY * strengthMultiplier\n              ))\n            : scrollTop\n\n          onScrollChange(newLeft, newTop)\n        }\n        this.frame = raf(tick)\n      }\n\n      tick()\n    }\n\n    stopScrolling() {\n      this.detach()\n      this.scaleX = 0\n      this.scaleY = 0\n\n      if (this.frame) {\n        raf.cancel(this.frame)\n        this.frame = null\n      }\n    }\n\n    render() {\n      const {\n        // not passing down these props\n        strengthMultiplier,\n        verticalStrength,\n        horizontalStrength,\n        onScrollChange,\n        ...props\n      } = this.props\n\n      return (\n        <WrappedComponent\n          ref={ref => {\n            this.wrappedInstance = ref\n          }}\n          {...props}\n        />\n      )\n    }\n  }\n\n  return hoist(ScrollingComponent, WrappedComponent)\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport cx from 'classnames'\nimport { isMobile } from '@/constants/env'\nimport withScroll, { createVerticalStrength } from './withScroll'\n\ninterface Props {\n  className?: string\n  useScroll?: boolean\n}\n\nconst DndScrollableElement = styled.div`\n  height: ${isMobile() ? '72vh' : '85vh'};\n  padding-top: 0;\n  overflow-y: scroll;\n\n  .report-template-builder {\n    &__main-content {\n      min-height: 371.25mm;\n      margin: 0 auto;\n      padding: 16px;\n      box-sizing: border-box;\n      max-width: 100%;\n      background: #fff;\n      border-top-right-radius: 16px;\n      border-bottom-left-radius: 16px;\n      border-bottom-right-radius: 16px;\n    }\n\n    &__contentarea {\n      min-height: 348.75mm;\n    }\n\n    &__contentarea--fixed-layout {\n      min-height: auto;\n    }\n\n    &__snippet-toolbar {\n      visibility: hidden;\n    }\n  }\n\n  .ui-draggable {\n    &:focus,\n    &:active {\n      outline: 0;\n\n      .course-builder__snippet-toolbar {\n        visibility: visible;\n        opacity: 1;\n        transition: visibility 0s, opacity 0.3s, max-height 0.6s linear;\n      }\n    }\n  }\n\n  &.is--preview {\n    height: auto;\n  }\n`\n\nconst ScrollableComponent = withScroll(DndScrollableElement)\n\nconst vStrength = createVerticalStrength(150)\n\nexport default class ReactDndProvider extends React.Component<Props> {\n  static defaultProps = {\n    useScroll: true,\n  }\n\n  render() {\n    const { className, useScroll } = this.props\n\n    return (\n      <ScrollableComponent\n        useScroll={useScroll}\n        verticalStrength={vStrength}\n        strengthMultiplier={100}\n        className={cx('report-template-builder', className)}>\n        {this.props.children}\n      </ScrollableComponent>\n    )\n  }\n}\n","import { confirm } from '@/utils/message'\nimport history from '@/utils/history'\n\nexport default function useRouteLeaveConfirm(pathname: string) {\n  const handleConfirm = () => {\n    confirm({\n      title: '確認要取消嗎？',\n      content: '取消後未儲存的資料將會消失，確認取消嗎？',\n      okText: '確認',\n      onOk: () => {\n        if (pathname) {\n          history.push(pathname)\n        }\n      },\n    })\n  }\n\n  return handleConfirm\n}\n","import React from 'react'\nimport { isMobile } from '@/constants/env'\n\nexport default function useMobile() {\n  let [mobile, setIsMobile] = React.useState(isMobile())\n\n  React.useEffect(() => {\n    const handleResize = () => {\n      let currentViewport = {\n        width: window.innerWidth,\n        height: window.innerHeight,\n      }\n\n      setIsMobile(isMobile() || currentViewport.width <= 1024)\n    }\n\n    window.addEventListener('resize', handleResize)\n    window.addEventListener('orientationchange', handleResize)\n\n    return () => {\n      window.removeEventListener('resize', handleResize)\n      window.removeEventListener('orientationchange', handleResize)\n    }\n  }, []) // eslint-disable-line\n\n  return mobile\n}\n","import React from 'react'\nimport { length, head, of, pathOr, map } from 'ramda'\nimport {\n  SnippetProps,\n  ReportTemplateQueryResult,\n  Mutation,\n  MutationOptions,\n  PhraseTemplate,\n  QueryVariables,\n} from '@/constants/types'\nimport useAuth from '@/hooks/useAuth'\nimport { reportTemplateStatusEnums, Divisions } from '@/constants/enums'\nimport { setComponent } from '@/components/snippet-template-list'\nimport useSWR from '@/hooks/useSWR'\nimport { useRequest } from '@/utils/request'\nimport { toMoment, toDateString } from '@/utils/webHelper'\nconst { compose } = require('ramda')\n\nconst convertData = compose(\n  setComponent,\n  map((x: ReportTemplateQueryResult) => ({\n    ...x,\n    id: x.no || x.id,\n    name: x.templateName,\n    description: x.templateDescription,\n    setting: compose(\n      map((s: SnippetProps) => ({\n        ...s,\n        ...(s.inline ? { html: decodeURIComponent(s.html) } : {}),\n      })),\n      pathOr([], ['template'])\n    )(x),\n    statusName: '草稿',\n    createdAt: toMoment(x.createDate),\n    createdAtStr: toDateString(x.createDate, 'YYYY.MM.DD HH:mm'),\n    updatedAt: toMoment(x.updateDate),\n    updatedAtStr: toDateString(x.updateDate, 'YYYY.MM.DD HH:mm'),\n  })),\n  pathOr([], [])\n)\n\n// 報告模版清單\nfunction useUserPhraseTemplates({\n  id = 0,\n  division = Divisions.PATH,\n  ...params\n}: QueryVariables = {}) {\n  const { data, ...rest } = useSWR<ReportTemplateQueryResult[]>(\n    `/api/v1/c5/getPhraseTemplateList/{id}&{division}`,\n    {\n      variables: { ...params, id, division },\n    }\n  )\n\n  return {\n    ...rest,\n    data: convertData(data) as PhraseTemplate[],\n  }\n}\n\nfunction useAllPhraseTemplates({\n  id = 0,\n  division = Divisions.PATH,\n  ...params\n}: QueryVariables = {}) {\n  const { data, ...rest } = useSWR<ReportTemplateQueryResult[]>(\n    `/api/v1/c5/getCompletePhraseTemplateList/{id}&{division}`,\n    {\n      variables: { ...params, id, division },\n    }\n  )\n\n  return {\n    ...rest,\n    data: convertData(data) as PhraseTemplate[],\n  }\n}\n\n// 片語模版資料\nfunction usePhraseTemplate({\n  userId = 0,\n  division = Divisions.PATH,\n  name = '',\n  data,\n  ...params\n}: {\n  [key: string]: any\n  userId?: React.Key\n  division?: string\n  name?: string\n  data?: any\n}) {\n  const response = useSWR<ReportTemplateQueryResult[]>(\n    name ? `/api/v1/c5/getPhraseTemplate/{userId}&{division}&{name}` : null,\n    {\n      variables: {\n        ...params,\n        userId,\n        division,\n        name,\n      },\n    }\n  )\n\n  const _data = compose(head, convertData, pathOr([], ['data']))(response)\n\n  const [phraseTemplate, setPhraseTemplate] = React.useState<PhraseTemplate>({\n    setting: [],\n  } as any)\n\n  React.useEffect(() => {\n    if (data?.id) {\n      setPhraseTemplate(compose(head, setComponent, of)(data))\n    }\n  }, [data])\n\n  React.useEffect(() => {\n    if (_data) {\n      setPhraseTemplate(prev => ({ ...prev, ..._data, author: 'Author' }))\n    }\n  }, [JSON.stringify(_data)]) // eslint-disable-line\n\n  let _snippetList = pathOr([], ['setting'])(phraseTemplate)\n\n  React.useEffect(() => {\n    setSnippetList(_snippetList)\n  }, [JSON.stringify(_snippetList)]) // eslint-disable-line\n\n  const [snippetList, setSnippetList] = React.useState<SnippetProps[]>(\n    _snippetList\n  )\n\n  let snippetById: { [key: string]: SnippetProps } = {}\n\n  return {\n    ...response,\n    phraseTemplate,\n    snippetList,\n    setSnippetList,\n    snippetById: map((x: SnippetProps) => (snippetById[x.id] = x), snippetList),\n  }\n}\n\nfunction useCreateOrUpdatePhraseTemplateAPI(options: MutationOptions = {}) {\n  const { loading, mutate } = useRequest(`/api/v1/c5/createPhraseTemplate`, {\n    ...options,\n    method: 'POST',\n  })\n\n  return [loading, mutate] as Mutation\n}\n\nfunction useDeletePhraseTemplateAPI(options: MutationOptions = {}) {\n  const { loading, mutate } = useRequest(`/api/v1/c5/deletePhraseTemplate`, {\n    ...options,\n    method: 'POST',\n  })\n\n  return [loading, mutate] as Mutation\n}\n\nexport const usePhraseList = (variables: QueryVariables = {}) => {\n  const { user } = useAuth()\n  const { data, ...rest } = useUserPhraseTemplates({ ...user, ...variables })\n\n  const dataSource = {\n    content: data,\n    total: length(data),\n    totalPages: Math.floor(length(data) / 10 + 1),\n  }\n\n  return {\n    ...rest,\n    dataSource,\n    data: dataSource,\n  }\n}\n\nexport const useAllPhraseList = (variables: QueryVariables = {}) => {\n  const { user } = useAuth()\n  const { data, ...rest } = useAllPhraseTemplates({ ...user, ...variables })\n\n  const dataSource = {\n    content: data,\n    total: length(data),\n    totalPages: Math.floor(length(data) / 10 + 1),\n  }\n\n  return {\n    ...rest,\n    dataSource,\n    data: dataSource,\n  }\n}\n\nexport const useCreateOrUpdatePhrase = (options: MutationOptions = {}) => {\n  const [loading, mutate] = useCreateOrUpdatePhraseTemplateAPI(options)\n  const { user } = useAuth()\n\n  const handler = (values: PhraseTemplate) => {\n    return mutate({\n      ...values,\n      userId: user.id,\n      division: user.division,\n      status: reportTemplateStatusEnums.DRAFT,\n      templateName: values.name,\n      templateDescription: values.description,\n      // templateJson: JSON.stringify(values.setting),\n      template: compose(\n        map((s: SnippetProps) => ({\n          ...s,\n          ...s.setting,\n          ...(s.inline\n            ? { clozeId: s.id, html: encodeURIComponent(s.html) }\n            : { topicId: s.id, toolTip: s?.setting?.tooltip }),\n        })),\n        pathOr([], ['setting'])\n      )(values),\n    })\n  }\n\n  return [loading, handler] as Mutation\n}\n\nexport const useRemovePhrase = (options: MutationOptions = {}) => {\n  const [loading, mutate] = useDeletePhraseTemplateAPI(options)\n  const { user } = useAuth()\n\n  const hanlder = (values: PhraseTemplate) => {\n    return mutate({\n      ...values,\n      userId: user.id,\n      division: user.division,\n      TemplateName: values.name,\n    })\n  }\n\n  return [loading, hanlder] as Mutation\n}\n\nexport const usePhraseItem = (variables: { id?: string; data?: any }) => {\n  const { user } = useAuth()\n  const { setSnippetList, snippetList, ...rest } = usePhraseTemplate({\n    ...variables,\n    userId: user.id,\n    division: user.division,\n    name: variables.id,\n  })\n\n  return {\n    ...rest,\n    snippetList,\n    setSnippetList,\n    handleSnippetUpdate: setSnippetList,\n  }\n}\n","import styled from 'styled-components'\n\ntype Props = {\n  border?: string\n}\n\nexport default styled.div.attrs({\n  className: 'block-placeholder',\n})<Props>`\n  display: flex;\n  align-items: center;\n  padding-left: 25px;\n  height: 50px;\n  border: rgba(225, 225, 225, 0.9) 2px ${p => p.border || 'dashed'};\n  background-color: transparent;\n  margin-bottom: 35px;\n`\n","/**\n * NOTE:\n * nerver using index as list component key forever,\n * it will completely fucked up your page\n */\nimport React from 'react'\nimport { withRouter } from 'react-router-dom'\nimport { DropTarget, ConnectDropTarget, XYCoord } from 'react-dnd'\nimport {\n  equals,\n  length,\n  remove,\n  update,\n  insert,\n  cond,\n  gt,\n  lt,\n  T,\n  __,\n  add,\n  pathOr,\n  identity,\n  always,\n} from 'ramda'\nimport cx from 'classnames'\nimport { uuid } from '@/utils/webHelper'\nimport ItemTypes from '@/constants/item-types'\nimport { SnippetProps } from '@/constants/types'\nimport Snippet from '@/components/snippet'\nimport BlockPlaceholder from '@/components/snippet-block-placeholder'\nimport { canMoveSnippet, getPlaceHolderIndex } from './snippet-utils'\nconst { compose } = require('ramda')\n\ninterface Props {\n  draggingItem: any\n  isOver?: boolean\n  draggable?: boolean\n  canDrop?: boolean\n  snippetList: SnippetProps[]\n  connectDropTarget: ConnectDropTarget\n  onSnippetUpdate(data: any): void\n  calcPercentage(data: any): void\n}\n\ninterface State {\n  placeholderIndex: number | null\n}\n\nconst withDropTarget = DropTarget<Props>(\n  ItemTypes.BOARD,\n  {\n    drop(_, monitor, component) {\n      if (!component || !component.props.draggable) {\n        return\n      }\n\n      const canDrop = monitor.canDrop()\n      let { placeholderIndex } = component.state\n      const item = monitor.getItem()\n\n      if (canDrop && item.fromMenu) {\n        component.handleSnippetDrop({ ...item, placeholderIndex })\n      }\n\n      if (canDrop && !item.fromMenu) {\n        component.handleSnippetMove(item.id, placeholderIndex)\n      }\n    },\n    canDrop({ snippetList }, monitor) {\n      // if there is no items in cards, and is over on the board currently,\n      // we can display a placeholder and drop the snippet item on the board.\n      if (snippetList.length === 0 && monitor.isOver()) {\n        return true\n      }\n\n      const clientOffset = monitor.getClientOffset() as XYCoord\n      const element = document.elementFromPoint(clientOffset.x, clientOffset.y)\n\n      return canMoveSnippet(element)\n    },\n    hover(_, monitor, component) {\n      // Determine mouse position\n      const clientOffset = monitor.getClientOffset() as XYCoord\n\n      let {\n        placeholderIndex,\n        isOverSnippet,\n        overSnippet,\n      } = getPlaceHolderIndex(clientOffset)\n\n      // 還要判斷是否是在最後一個 snippet 下面及 snippets-container 裡面\n      if (!isOverSnippet) {\n        return\n      }\n\n      const hoverBoundingRect = (overSnippet as HTMLElement).getBoundingClientRect()\n      const hoverMiddleY =\n        (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2\n      const hoverClientY = clientOffset.y - hoverBoundingRect.top\n\n      if (hoverClientY < hoverMiddleY) {\n        placeholderIndex -= 1\n      }\n\n      if (\n        monitor.canDrop() &&\n        !equals(component.state.placeholderIndex, placeholderIndex)\n      ) {\n        component.setState({ placeholderIndex })\n      }\n    },\n  },\n  (connect, monitor) => ({\n    connectDropTarget: connect.dropTarget(),\n    isOver: monitor.isOver(),\n    canDrop: monitor.canDrop(),\n    didDrop: monitor.didDrop(),\n    draggingItem: monitor.getItem(),\n  })\n)\n\nclass SnippetsContainer extends React.Component<Props, State> {\n  static defaultProps = {\n    draggable: true,\n    snippetList: [],\n  }\n\n  public state: State = {\n    placeholderIndex: null,\n  }\n\n  handleSnippetMove = (id: React.Key, atIndex: number) => {\n    const { snippetList } = this.props\n    const { snippet, index } = this.handleFindSnippet(id)\n\n    const newList = []\n    let isPlaced = false\n\n    snippetList.forEach((s, idx) => {\n      if (idx === index) {\n        return\n      }\n\n      if (!isPlaced && atIndex < idx) {\n        newList.push(snippet)\n        isPlaced = true\n      }\n\n      newList.push(s)\n\n      if (!isPlaced && atIndex === idx) {\n        newList.push(snippet)\n        isPlaced = true\n      }\n    })\n\n    // we dropped the only one snippet in the list so let it back to list.\n    if (length(snippetList) === 1 && !atIndex) {\n      newList.push(snippet)\n    }\n\n    this.props.onSnippetUpdate(newList)\n    this.setState({ placeholderIndex: null })\n  }\n\n  // prettier-ignore\n  handleSnippetDrop = (droppedItem: { [key: string]: any; placeholderIndex: number }) => {\n    const { placeholderIndex, ...item } = droppedItem\n\n    const snippetList = [...this.props.snippetList]\n\n    const nextIndex = placeholderIndex + 1\n    let newList: any[] = []\n\n    const snippet: Partial<SnippetProps> = {\n      ...item,\n      fromMenu: false,\n      id: `${item.id}__${uuid()}`,\n    }\n\n    if (length(snippetList) === 0) {\n      newList = insert(0, snippet)(snippetList)\n    }\n    if (length(snippetList) > 0) {\n      newList = insert(nextIndex, snippet)(snippetList)\n    }\n\n    this.props.onSnippetUpdate(newList)\n    this.setState({ placeholderIndex: null })\n  }\n\n  handleSnippetRemove = (index: number) => {\n    this.props.onSnippetUpdate(remove(index, 1)(this.props.snippetList))\n  }\n\n  handleSnippetShift = (id: React.Key, shift: number) => {\n    const { snippet } = this.handleFindSnippet(id)\n\n    this.handleSnippetUpdate({\n      ...snippet,\n      tabSize: compose(\n        cond([\n          [gt(__, 2), always(2)],\n          [lt(__, 0), always(0)],\n          [T, identity],\n        ]),\n        add(shift),\n        pathOr(0, ['tabSize'])\n      )(snippet),\n    })\n  }\n\n  handleSnippetUpdate = (data: any) => {\n    const { snippet, index } = this.handleFindSnippet(data.id)\n\n    this.props.onSnippetUpdate(\n      update(index, { ...snippet, ...data })(this.props.snippetList)\n    )\n  }\n\n  handleFindSnippet = (id: React.Key) => {\n    const { snippetList } = this.props\n    const snippet = snippetList.filter(x => x.id === id)[0]\n\n    return {\n      snippet,\n      index: snippetList.indexOf(snippet),\n    }\n  }\n\n  render() {\n    const {\n      connectDropTarget,\n      isOver,\n      canDrop,\n      snippetList,\n      draggingItem,\n      draggable, // 模版是否可拖曳，編輯模式下才會是 true\n      ...props\n    } = this.props\n\n    const { placeholderIndex } = this.state\n\n    let isPlaceHold = false\n    const cardList = []\n\n    snippetList.forEach((item, idx) => {\n      if (isOver && canDrop) {\n        isPlaceHold = false\n        if (idx === 0 && placeholderIndex === -1) {\n          cardList.push(<BlockPlaceholder key={`block-placeholder-${idx}`} />)\n        } else if ((placeholderIndex as any) > idx) {\n          isPlaceHold = true\n        }\n      }\n\n      if (item !== undefined) {\n        cardList.push(\n          <Snippet\n            {...props}\n            key={item.id}\n            id={item.id}\n            index={idx}\n            draggable={draggable}\n            item={item}\n            inline={item.inline}\n            // wrapperId={(item.id || `snippet-wrapper-${idx}`) as string}\n            wrapperId={`snippet-wrapper-${idx}`}\n            tabSize={item.tabSize}\n            findSnippet={this.handleFindSnippet}\n            updateSnippet={this.handleSnippetUpdate}\n            shiftSnippet={this.handleSnippetShift}\n            removeSnippet={this.handleSnippetRemove}>\n            {item.inline ? (\n              <div\n                id={`${item.id}`}\n                className={`${item.id}`}\n                css={{ padding: 16, lineHeight: 2 }}\n              />\n            ) : (\n              <item.Component\n                id={item.id}\n                className={item.id}\n                item={item}\n                index={idx}\n                onUpdate={this.handleSnippetUpdate}\n              />\n            )}\n          </Snippet>\n        )\n      }\n\n      if (isOver && canDrop && placeholderIndex === idx) {\n        cardList.push(<BlockPlaceholder key={`block-placeholder-${idx}`} />)\n      }\n    })\n\n    // if placeholder index is greater than array.length, display placeholder as last\n    if (isPlaceHold) {\n      cardList.push(<BlockPlaceholder key={'block-placeholder-bottom'} />)\n    }\n\n    // if there is no items in cards currently, display a placeholder anyway\n    if (isOver && canDrop && snippetList.length === 0) {\n      cardList.push(<BlockPlaceholder key={'block-placeholder-zero'} />)\n    }\n\n    // if just has only one item in list and currently dragged, display a placeholder\n    if (isOver && canDrop && snippetList.length === 1) {\n      if (!draggingItem.fromMenu) {\n        cardList.push(<BlockPlaceholder key={'block-placeholder-zero'} />)\n      }\n    }\n\n    return connectDropTarget(\n      <div\n        className={cx('report-template-builder__contentarea', {\n          'report-template-builder__contentarea--fixed-layout': !draggable,\n        })}>\n        {cardList}\n      </div>\n    )\n  }\n}\n\nexport default compose(withRouter, withDropTarget)(SnippetsContainer)\n","import React from 'react'\nimport { DragSource, ConnectDragSource } from 'react-dnd'\nimport styled from 'styled-components'\nimport ItemTypes from '@/constants/item-types'\n\ninterface Props {\n  connectDragSource: ConnectDragSource\n  children?: React.ReactNode\n  className?: string\n  id?: React.Key\n}\n\nconst withDragSource = DragSource(\n  ItemTypes.BOARD,\n  {\n    beginDrag(props: Props) {\n      const { children, className, ...rest } = props // eslint-disable-line\n      return {\n        ...rest,\n        fromMenu: true,\n      }\n    },\n    endDrag(_, monitor) {\n      if (!monitor.didDrop()) {\n        return\n      }\n    },\n    isDragging(props, monitor) {\n      const isDragging = props.id === monitor.getItem().id\n\n      return isDragging\n    },\n  },\n  (connect, monitor) => ({\n    connectDragSource: connect.dragSource(),\n    connectDragPreview: connect.dragPreview(),\n    isDragging: monitor.isDragging(),\n  })\n)\n\nclass SnippetListMenuItem extends React.Component<Props> {\n  render() {\n    const { connectDragSource, id, ...rest } = this.props\n\n    return (\n      <SnippetListMenuWrapper\n        {...rest}\n        ref={comp => connectDragSource(comp)}\n        id={`${id}`}>\n        <div className=\"snippet-drawer-menu__item--content\">\n          {this.props.children}\n        </div>\n      </SnippetListMenuWrapper>\n    )\n  }\n}\n\nconst SnippetListMenuWrapper = styled.div`\n  cursor: move;\n`\n\nexport default withDragSource(SnippetListMenuItem)\n","import React from 'react'\nimport cx from 'classnames'\nimport { FontColorsOutlined } from '@ant-design/icons'\nimport styled from 'styled-components'\nimport SnippetListMenuItem from '@/components/snippet-list-menu-item'\nimport snippetTemplateList from '@/components/snippet-template-list'\n\ninterface Props {\n  className?: string\n  style?: React.CSSProperties\n}\n\nexport default class SnippetListMenu extends React.Component<Props> {\n  render() {\n    return (\n      <SnippetListMenuWrapper\n        className={cx('snippet-drawer-menu', this.props.className)}\n        {...this.props}>\n        <div className=\"snippet-drawer-menu__list\">\n          {snippetTemplateList.map(item => (\n            <SnippetListMenuItem\n              {...item}\n              key={item.id}\n              className=\"snippet-drawer-menu__item py-3\">\n              <div className=\"flex items-center\">\n                {item.icon ? (\n                  <item.icon className=\"mr-2\" />\n                ) : (\n                  <FontColorsOutlined className=\"mr-2\" />\n                )}\n                {item.name}\n              </div>\n            </SnippetListMenuItem>\n          ))}\n        </div>\n      </SnippetListMenuWrapper>\n    )\n  }\n}\n\nconst SnippetListMenuWrapper = styled.div`\n  .snippet-drawer-menu {\n    &__list {\n      height: 100%;\n      overflow-y: auto;\n      overflow-x: hidden;\n\n      ::-webkit-scrollbar {\n        display: none;\n      }\n    }\n  }\n`\n","class EnvStore {\n  pageSize = 10\n  apiBaseUrl =\n    process.env.REACT_APP_API_ROOT ||\n    'https://path.weiecampus.com/backend/kmedical'\n\n  get isEnvDev(): boolean {\n    return process.env.NODE_ENV === 'development'\n  }\n  get appBaseName(): string {\n    return process.env.REACT_APP_BASE_NAME || ''\n  }\n  get appTitle(): string {\n    return `%s | ${\n      process.env.REACT_APP_TITLE || '高雄榮民總醫院 數位病理平台'\n    }`\n  }\n  get appUrl(): string {\n    return `${window.location.protocol}//${window.location.host}${this.appBaseName}/#/`\n  }\n  get fakeApiBaseUrl(): string {\n    return (\n      process.env.REACT_APP_FAKE_API_ROOT ||\n      (this.isEnvDev ? 'http://localhost:3004' : 'http://localhost:3004')\n    )\n  }\n  get publicUrl(): string {\n    return process.env.PUBLIC_URL || ''\n  }\n  get radiolViewerUrl(): string {\n    return (\n      process.env.REACT_APP_RADIOL_VIEWER_URL ||\n      'https://fhir-mcode.vghks.gov.tw/radiology-viewer/radiology-viewer/html/start.html'\n    )\n  }\n  get viewerUrl(): string {\n    return (\n      process.env.REACT_APP_VIEWER_URL ||\n      'https://fhir-mcode.vghks.gov.tw/PathViewer/demo/index.html'\n      // https://fhir-mcode.vghks.gov.tw/radiology-viewer/radiology-viewer/html/start.html\n    )\n  }\n  get oauthUrl(): string {\n    return (\n      process.env.REACT_APP_OAUTH_URL ||\n      'https://fhir-mcode.vghks.gov.tw/backend/oauth2Login/login'\n    )\n  }\n  get canUseDOM(): boolean {\n    return !!(\n      typeof window !== 'undefined' &&\n      window.document &&\n      window.document.createElement\n    )\n  }\n  get useOAuth(): boolean {\n    return process.env.REACT_APP_OAUTH === 'true' && !this.isEnvDev\n  }\n  set setPageSize(pageSize: number | undefined) {\n    this.pageSize = pageSize || 50\n  }\n  set setApiBaseUrl(url: string) {\n    this.apiBaseUrl = url\n  }\n}\n\nexport const envStore = new EnvStore()\n\nexport function isMobile() {\n  let check = false\n  ;(function (a) {\n    if (\n      /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(\n        a\n      ) ||\n      // eslint-disable-next-line no-useless-escape\n      /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\n        a.substr(0, 4)\n      )\n    )\n      check = true\n  })(navigator.userAgent || navigator.vendor || (window as any).opera)\n  return check\n}\n\nexport default envStore\n","import React from 'react'\nimport { Layout } from 'antd'\n\nexport default function AppFooter() {\n  return (\n    <Layout.Footer\n      className=\"pb-6 text-center text-gray-600 border-t border-gray-400\"\n      style={{ background: 'rgb(221, 228, 237)' }}>\n      2020 高雄榮總數位病理平台\n    </Layout.Footer>\n  )\n}\n","const primary = '#38a8a9'\n\nmodule.exports = {\n  primary,\n  secondary: '#42c2b8',\n  danger: '#d74c4c',\n  darkGrey: '#4a4a4a',\n  purple150: 'rgba(115, 105, 215, 0.15)',\n  cornblue: '#a9b6d8',\n  comet: '#555977',\n  btn: {\n    danger: '#d74c4c',\n    primary: '#2c908a',\n    secondary: '#42c2b8',\n  },\n  sider: {\n    bg: primary,\n  },\n  login: {\n    cyan: 'rgba(5,124,147,1)',\n  },\n  pagination: primary,\n}\n","import React from 'react'\nimport { ModalProps, ModalFuncProps } from 'antd/lib/modal'\nimport { find, path } from 'ramda'\nimport Modal from '@/components/modal'\nimport { modalDefaultProps } from '@/utils/message'\n\nexport const confirm = Modal.confirm\n\ntype Props<T> = {\n  /**\n   * 是否可刪除: false的話不會跳確認刪除窗\n   */\n  isDeletable?: boolean\n  /**\n   * 刪除確認視窗的文字內容\n   */\n  content?: string | React.ReactNode\n  /**\n   * 確認刪除的行為，例如打 API\n   */\n  onRequestDelete?: (values?: any, resolve?: (values?: any) => any) => any\n  /**\n   * 跳出確認刪除時可以做的事情，例如關掉正在編輯的對話框\n   */\n  onBeforeDelete?: () => any\n  /**\n   * 刪除成功後，可重新取得(列表)資料\n   */\n  refetchQueries?: () => any\n  /**\n   * 取消刪除後做的事情，例如重新打開編輯對話窗\n   */\n  onCancel?: () => any\n  /**\n   * 列表資料，可在跳確認窗時從裡面查找要刪除的資料並回傳\n   */\n  dataSource?: T[]\n  /**\n   * 刪除的項目，可以是單一物件或陣列物件...\n   */\n  deleteItem?: any\n  /**\n   * 自訂確認視窗屬性\n   */\n  modalProps?: ModalProps\n  /**\n   * 刪除成功後可作的事情\n   */\n  onAfterDelete?: () => any\n}\n\nexport let modal: {\n  destroy: () => void\n  update: (newConfig: ModalFuncProps) => void\n}\n\nexport function useDelete<T extends any>(props: Props<T>) {\n  const {\n    isDeletable = true,\n    content,\n    dataSource = [],\n    onRequestDelete,\n    onBeforeDelete,\n    refetchQueries,\n    onCancel,\n    deleteItem,\n    modalProps = {},\n    onAfterDelete,\n  } = props\n\n  let onAfterDeleteResolve = React.useRef(() => ({}))\n\n  const handleConfirmDeletion = (evt: React.MouseEvent<HTMLElement>) => {\n    if (onBeforeDelete) {\n      onBeforeDelete()\n    }\n    handleConfirm(evt)\n  }\n\n  const handleDeleteFailure = () => {\n    if (modal) {\n      modal.update({\n        okButtonProps: {\n          className: 'c-btn c-btn--danger',\n          style: { minWidth: 96, marginRight: 104 },\n          loading: false,\n        },\n      })\n    }\n  }\n\n  const handleConfirm = (evt: React.MouseEvent<HTMLElement>) => {\n    if (!isDeletable) {\n      return\n    }\n\n    const item = find<any>(\n      x =>\n        `${path(['id'], x)}` ===\n        (evt.currentTarget as HTMLElement).dataset['id']\n    )(dataSource)\n\n    modal = confirm({\n      ...modalDefaultProps(content, modalProps),\n      onOk() {\n        if (modal) {\n          modal.update({\n            okButtonProps: {\n              className: 'c-btn c-btn--danger',\n              style: { minWidth: 80, marginRight: 24 },\n              loading: true,\n            },\n          })\n        }\n\n        return new Promise(resolve => {\n          if (onRequestDelete) {\n            onRequestDelete(item || deleteItem)\n          }\n\n          if (onAfterDelete) {\n            onAfterDelete()\n          }\n\n          onAfterDeleteResolve.current = (() => {\n            resolve()\n            if (refetchQueries) {\n              refetchQueries()\n            }\n          }) as any\n        })\n      },\n      onCancel() {\n        if (onCancel) {\n          onCancel()\n        }\n      },\n    })\n  }\n\n  return {\n    handleConfirmDeletion,\n    handleConfirm,\n    handleDeleteFailure,\n    onAfterDelete: onAfterDeleteResolve,\n  }\n}\n\nexport default useDelete\n","import React from 'react'\nimport { atom, selector, useRecoilValue, useRecoilState } from 'recoil'\nimport { SelectProps } from 'antd/lib/select'\nimport moment from 'moment'\nimport {\n  not,\n  mergeAll,\n  map,\n  last as Rlast,\n  filter,\n  omit,\n  keys,\n  sort,\n  inc,\n  pathOr,\n  length,\n  ifElse,\n  always,\n  head,\n  values,\n  flatten,\n  is,\n  identity,\n  __,\n  equals,\n  invoker,\n  tryCatch,\n  anyPass,\n  assoc,\n  of,\n  forEach,\n  pick,\n  pluck,\n  uniq,\n  lt,\n  path,\n  includes,\n} from 'ramda'\nimport {\n  Snippets,\n  SnippetProps,\n  MutationOptions,\n  Mutation,\n  ReportTemplate,\n  QueryVariables,\n  ReportTemplateSetting,\n  ReportClozeTemplateQueryResult,\n  ReportTopicTemplateQueryResult,\n  ReportTemplateQueryResult,\n  ReportTemplateDetailQueryResult,\n} from '@/constants/types'\nimport {\n  reportTemplateStatusEnums,\n  reportTemplateStatusNameEnums,\n  Divisions,\n} from '@/constants/enums'\nimport Select from '@/components/select'\nimport useAuth from '@/hooks/useAuth'\nimport useSWR from '@/hooks/useSWR'\nimport { userState } from '@/data/useUser'\nimport {\n  setComponentByTab,\n  snippetTemplateById,\n} from '@/components/snippet-template-list'\nimport { confirm } from '@/utils/message'\nimport { useRequest } from '@/utils/request'\nimport {\n  getNumberFromString,\n  downloadAsJson,\n  toMoment,\n  toDateString,\n  isNil,\n} from '@/utils/webHelper'\nconst { compose, mergeDeepRight, concat } = require('ramda')\n\nconst sorter: any = {\n  'Pathological diagnosis': 1,\n  'Procedure Information': 1,\n  'Clinical Information': 2,\n  Gross: 2,\n  Microscopy: 3,\n  Comparison: 3,\n  Notes: 4,\n  Findings: 4,\n  References: 5,\n  Impression: 5,\n}\n\n// 模版分類\nconst snippetCategoryOfReportState = selector({\n  key: 'snippetCategoryOfReportState',\n  get: ({ get }) =>\n    compose(\n      ifElse(\n        equals(__, Divisions.RAD),\n        always({\n          PROCEDURE_INFORMATION: 'Procedure Information',\n          CLINICAL_INFORMATION: 'Clinical Information',\n          COMPARISON: 'Comparison',\n          FINDINGS: 'Findings',\n          IMPRESSION: 'Impression',\n        }),\n        always({\n          PATHOLOGICAL_DIAGNOSIS: 'Pathological diagnosis',\n          GROSS: 'Gross',\n          MICROSCOPY: 'Microscopy',\n          NOTES: 'Notes',\n          REFERENCES: 'References',\n        })\n      ),\n      path(['division'])\n    )(get(userState)),\n})\n\nconst useDefaultSnippetOfReport = () => {\n  const snippetCategoryOfReport = useRecoilValue(snippetCategoryOfReportState)\n\n  return compose(\n    mergeAll,\n    map((key: string) => ({ [key]: [] })),\n    values\n  )(snippetCategoryOfReport)\n}\n\nconst useConvertData = () => {\n  const defaultSnippetsOfReport = useDefaultSnippetOfReport()\n  return compose(\n    setComponentByTab,\n    map((x: ReportTemplateQueryResult) => ({\n      ...x,\n      name: x.templateName,\n      description: x.templateDescription,\n      setting: compose(\n        (setting: Snippets) =>\n          compose(\n            mergeAll,\n            map((key: string) => ({\n              [key]: compose(\n                map((s: SnippetProps) => ({\n                  ...s,\n                  ...(s.inline ? { html: decodeURIComponent(s.html) } : {}),\n                  icon: path([s.type, 'icon'], snippetTemplateById),\n                })),\n                pathOr([], [key])\n              )(setting),\n            })),\n            keys\n          )(setting),\n        ifElse(\n          isNil,\n          always(defaultSnippetsOfReport),\n          compose(\n            ifElse(is(Object), identity, always(defaultSnippetsOfReport)),\n            ifElse(\n              is(String),\n              tryCatch<any>(\n                invoker(1, 'parse')(__)(JSON),\n                always(defaultSnippetsOfReport)\n              ),\n              identity\n            ),\n            ifElse(\n              anyPass([equals(__, 'undefined'), equals(__, '[object Object]')]),\n              always(defaultSnippetsOfReport),\n              identity\n            )\n          )\n        )\n      )(x.templateJson),\n      statusName: pathOr('', [x.status], reportTemplateStatusNameEnums),\n      createdAt: toMoment(x.createDate),\n      createdAtStr: toDateString(x.createDate, 'YYYY.MM.DD HH:mm'),\n      updatedAt: toMoment(x.updateDate),\n      updatedAtStr: toDateString(x.updateDate, 'YYYY.MM.DD HH:mm'),\n    })),\n    pathOr([], [])\n  )\n}\n\n// 報告模版清單\nfunction useUserReportTemplates({\n  id = 0,\n  division = Divisions.PATH,\n  ...params\n}: QueryVariables = {}) {\n  const { data, ...rest } = useSWR<ReportTemplateQueryResult[]>(\n    `/api/v1/c4/getReportTemplateList/{id}&{division}`,\n    {\n      variables: {\n        ...params,\n        id,\n        division,\n      },\n    }\n  )\n\n  return {\n    ...rest,\n    data: useConvertData()(data) as ReportTemplate[],\n  }\n}\n\nexport function useAllReportTemplates({\n  id = 0,\n  division = Divisions.PATH,\n  ...params\n}: QueryVariables = {}) {\n  const { user } = useAuth()\n  const { data, ...rest } = useSWR<ReportTemplateQueryResult[]>(\n    `/api/v1/c1/getCompleteReportTemplateList/{id}&{division}`,\n    {\n      variables: {\n        ...params,\n        id: user.id,\n        division: user.division,\n      },\n    }\n  )\n\n  const _data = useConvertData()(data) as ReportTemplate[]\n\n  const templateByName: { [key: string]: ReportTemplate } = {}\n\n  forEach((x: ReportTemplate) => (templateByName[x.name] = x))(_data)\n\n  return {\n    ...rest,\n    templateByName,\n    data: _data,\n  }\n}\n\nexport const useConvertReportTemplate = () => {\n  const convertData = useConvertData() // 這個好像用不到了..因為API格式有變\n  const defaultSnippetsOfReport = useDefaultSnippetOfReport()\n  return compose(\n    ({\n      template,\n      cloze = [],\n      topic = [],\n    }: ReportTemplateDetailQueryResult) => ({\n      ...compose(head, convertData)(template),\n      setting: compose(\n        mergeAll,\n        map((key: string) => ({\n          [key]: concat(\n            compose(\n              map((s: ReportClozeTemplateQueryResult) => ({\n                ...s,\n                id: s.clozeId,\n                categoryName: key,\n                inline: true,\n                html: decodeURIComponent(s.html),\n                icon: path([s.type, 'icon'], snippetTemplateById),\n              })),\n              filter((s: ReportClozeTemplateQueryResult) => s.tab === key),\n              pathOr([], [])\n            )(cloze),\n            compose(\n              map((s: ReportTopicTemplateQueryResult) => ({\n                ...s,\n                id: s.topicId,\n                categoryName: key,\n                inline: false,\n                icon: path([s.type, 'icon'], snippetTemplateById),\n                setting: {\n                  text: s.text,\n                  options: ifElse(\n                    isNil,\n                    identity,\n                    tryCatch(val => JSON.parse(val), always([]))\n                  )(s.options),\n                  tooltip: s.toolTip === 'undefined' ? undefined : s.toolTip,\n                  value: s.value === 'undefined' ? undefined : s.value,\n                  // radlexCode: s.radlexCode,\n                  units: path(['units'], s),\n                  defaultValue: path(['defaultValue'], s),\n                  max: path(['max'], s),\n                  min: path(['min'], s),\n                },\n              })),\n              filter((s: ReportClozeTemplateQueryResult) => s.tab === key),\n              pathOr([], [])\n            )(topic)\n          ),\n        })),\n        keys,\n        ifElse(\n          compose(lt(0), length),\n          compose(\n            mergeAll,\n            map((tab: string) => ({\n              [tab]: [],\n            })),\n            sort((a: string, b: string) => sorter[a] - sorter[b])\n          ),\n          always(defaultSnippetsOfReport)\n        ),\n        uniq,\n        pluck('tab'),\n        concat(cloze)\n      )(topic),\n    }),\n    pathOr({}, ['data'])\n  )\n}\n\ninterface QueryReportTemplateOptions extends QueryVariables {\n  [key: string]: any\n  userId?: React.Key\n  division?: string\n  name?: string\n  data?: any\n  shouldFetch?: boolean\n}\n\n// 模版報告資料\nfunction useQueryReportTemplate({\n  userId = 0,\n  division = Divisions.PATH,\n  shouldFetch = true,\n  name = '',\n  data,\n  id,\n  onCompleted,\n  onError,\n  errorMsg,\n  ...params\n}: QueryReportTemplateOptions) {\n  const _shouldFetch = !isNil(name) && shouldFetch\n\n  const response = useSWR<ReportTemplateQueryResult[]>(\n    ifElse(\n      equals(true),\n      always(`/api/v1/c4/getReportTemplate/{userId}&${division}&${name}`),\n      always(null)\n    )(_shouldFetch),\n    {\n      onError,\n      onCompleted: response => {\n        if (onCompleted) {\n          onCompleted(response)\n        }\n\n        compose(\n          handleUpdateReportTemplate,\n          omit(['status']),\n          convertData,\n          assoc('data', response)\n        )({})\n      },\n      fetchOptions: { errorMsg },\n      variables: {\n        ...params,\n        userId,\n        division,\n        name,\n      },\n    }\n  )\n\n  const defaultSnippetsOfReport = useDefaultSnippetOfReport()\n\n  const convertData = useConvertReportTemplate()\n\n  const _data = convertData(response) as ReportTemplateQueryResult\n\n  const [reportTemplate, setReportTemplate] = React.useState<ReportTemplate>({\n    setting: defaultSnippetsOfReport,\n  } as any)\n\n  const isEmptyReport = compose(\n    equals(0),\n    length,\n    flatten,\n    values,\n    pathOr({}, ['setting'])\n  )(data)\n\n  const handleUpdateReportTemplate = (newData: ReportTemplateQueryResult) => {\n    setReportTemplate(prev =>\n      mergeDeepRight(\n        prev,\n        compose(assoc('author', 'Author'), head, setComponentByTab, of)(newData)\n      )\n    )\n  }\n\n  // 使用報告的模版\n  React.useEffect(() => {\n    if (data?.id) {\n      console.log(`using report's template`)\n      setReportTemplate(compose(head, setComponentByTab, of)(data))\n    }\n  }, [JSON.stringify(data)]) // eslint-disable-line\n\n  // 輸入報告還尚未有問題模版時，使用所選的報告模版\n  React.useEffect(() => {\n    if (_data && isEmptyReport) {\n      if (_data.templateName) {\n        console.log(`using template ${_data.templateName}`)\n      }\n      handleUpdateReportTemplate(_data)\n    }\n  }, [JSON.stringify(_data), isEmptyReport]) // eslint-disable-line\n\n  let _snippetList = pathOr(defaultSnippetsOfReport, ['setting'])(\n    reportTemplate\n  )\n\n  React.useEffect(() => {\n    setSnippetList(_snippetList)\n  }, [JSON.stringify(_snippetList)]) // eslint-disable-line\n\n  const [snippetList, setSnippetList] = React.useState<Snippets>(_snippetList)\n\n  let snippetById: { [key: string]: SnippetProps } = {}\n\n  return {\n    ...response,\n    setReportTemplate,\n    reportTemplate,\n    snippetList,\n    setSnippetList,\n    categoryCountById: compose(\n      mergeAll,\n      map((key: string) => ({ [key]: length(snippetList[key]) })),\n      keys\n    )(snippetList),\n    categoryCount: compose(length, keys)(snippetList),\n    total: compose(\n      length,\n      filter((x: SnippetProps) => x.type !== 'TemplateSectionHeader'),\n      flatten,\n      values\n    )(snippetList),\n    snippetById: compose(\n      map((x: SnippetProps) => (snippetById[x.id] = x)),\n      flatten,\n      values\n    )(snippetList),\n  }\n}\n\nfunction useCreateReportTemplateAPI(options: MutationOptions = {}) {\n  const { loading, mutate } = useRequest(`/api/v1/c4/createReportTemplate`, {\n    ...options,\n    method: 'POST',\n  })\n\n  return [loading, mutate] as Mutation\n}\n\nfunction useUpdateReportTemplateAPI(options: MutationOptions = {}) {\n  const { loading, mutate } = useRequest(`/api/v1/c4/updateReportTemplate`, {\n    ...options,\n    method: 'POST',\n  })\n\n  return [loading, mutate] as Mutation\n}\n\nfunction useDeleteReportTemplateAPI(options: MutationOptions = {}) {\n  const { loading, mutate } = useRequest(`/api/v1/c4/delectReportTemplate`, {\n    ...options,\n    method: 'POST',\n  })\n\n  return [loading, mutate] as Mutation\n}\n\nexport function useSnippetCategoryOfReport() {\n  return useRecoilValue(snippetCategoryOfReportState)\n}\n\nexport function useUpdateSnippet<T = ReportTemplateSetting>(options: {\n  item: SnippetProps\n  onUpdate: (data: any) => void\n  defaultValue?: any\n}) {\n  const { item, onUpdate, defaultValue = {} } = options\n\n  const [setting, setSetting] = React.useState<T>(\n    pathOr(defaultValue, ['setting'], item) as T\n  )\n\n  const handleOk = (values: T) => {\n    const newSetting = mergeDeepRight(setting, values)\n    setSetting(newSetting)\n    onUpdate({ ...item, setting: newSetting })\n  }\n\n  return { setting, handleOk }\n}\n\nexport const useReportTemplates = () => {\n  const { user } = useAuth()\n  const { data, refetch, ...rest } = useUserReportTemplates(user)\n\n  React.useEffect(() => {\n    refetch({ division: user.division })\n  }, [user.division]) // eslint-disable-line\n\n  const dataSource = {\n    content: map((s: ReportTemplate) => ({ ...s, author: user.name }))(data),\n    total: length(data),\n    totalPages: Math.floor(length(data) / 10) + 1,\n  }\n\n  return {\n    ...rest,\n    refetch,\n    dataSource,\n    data: dataSource,\n  }\n}\n\ninterface ReportTemplateSelectProps extends SelectProps<any> {\n  setFieldsValue?: (values: any) => void\n}\n\nexport const ReportTemplateSelect = ({\n  onChange,\n  onSearch,\n  ...props\n}: ReportTemplateSelectProps) => {\n  const [keyword, setKeyword] = React.useState<string>()\n\n  const { user } = useAuth()\n  const { data, loading } = useAllReportTemplates(\n    pick(['division', 'id'])(user)\n  )\n\n  const filterReportTemplates: ReportTemplate[] = ifElse(\n    isNil,\n    always(data),\n    val =>\n      filter((x: ReportTemplate) =>\n        x.name?.toLowerCase().includes(val.toLowerCase())\n      )(data)\n  )(keyword)\n\n  const handleSearch = (value: string) => {\n    setKeyword(value)\n  }\n\n  const handleChange = (value: string) => {\n    if (onChange) {\n      ;(onChange as any)(value)\n    }\n  }\n\n  return (\n    <Select\n      showSearch\n      bordered={false}\n      filterOption={false}\n      onSearch={handleSearch}\n      onChange={handleChange}\n      loading={loading}\n      disabled={loading}\n      {...props}>\n      {filterReportTemplates.map(x => (\n        <Select.Option key={x.id} value={x.name}>\n          {x.name}\n        </Select.Option>\n      ))}\n    </Select>\n  )\n}\n\ninterface ReportTemplateOptions extends QueryVariables {\n  id?: string\n  data?: any\n  shouldFetch?: boolean\n}\n\nexport const useReportTemplate = (variables: ReportTemplateOptions) => {\n  const { user } = useAuth()\n  const { setSnippetList, snippetList, refetch, ...r } = useQueryReportTemplate(\n    {\n      ...variables,\n      userId: user.id,\n      division: user.division,\n      name: variables.id,\n    }\n  )\n\n  const [category, setCategory] = useCurrentCategoryOfSnippet()\n\n  React.useEffect(() => {\n    refetch({ division: user.division })\n  }, [user.division]) // eslint-disable-line\n\n  React.useEffect(() => {\n    if (\n      !category ||\n      (compose(not, includes(category), keys)(snippetList) &&\n        category !== 'overview')\n    ) {\n      setCategory(compose(head, keys)(snippetList))\n    }\n  }, [category, JSON.stringify(snippetList)]) // eslint-disable-line\n\n  const handleSnippetUpdate = (data: any[]) => {\n    setSnippetList(prev => ({ ...prev, [category]: data }))\n  }\n\n  const handleTabChange = (activeKey: string) => {\n    setCategory(activeKey)\n  }\n\n  const handleTabMove = (order: string[]) => {\n    const snippetKeys = keys(snippetList)\n\n    setSnippetList(\n      compose(\n        mergeAll,\n        map((key: string) => ({ [key]: snippetList[key] })),\n        sort((a: string, b: string) => {\n          const orderA = order.indexOf(a)\n          const orderB = order.indexOf(b)\n\n          if (orderA !== -1 && orderB !== -1) {\n            return orderA - orderB\n          }\n          if (orderA !== -1) {\n            return -1\n          }\n          if (orderB !== -1) {\n            return 1\n          }\n\n          const ia = snippetKeys.indexOf(a)\n          const ib = snippetKeys.indexOf(b)\n\n          return ia - ib\n        }),\n        keys\n      )(snippetList)\n    )\n  }\n\n  const handleTabAdd = () => {\n    const last = compose(\n      inc,\n      pathOr(0, []),\n      getNumberFromString,\n      Rlast,\n      sort((a: any, b: any) => a - b),\n      keys\n    )(snippetList)\n\n    setSnippetList((prev: Snippets) => ({ ...prev, [`新標籤頁${last}`]: [] }))\n    setCategory(`新標籤頁${last}`)\n  }\n\n  const handleTabRemove = (targetKey: string) => {\n    confirm({\n      title: '確認要刪除此頁籤嗎？',\n      content: '刪除會連同模版資料一起刪除，確認繼續？',\n      onOk: () => {\n        setSnippetList((prev: Snippets) => omit([targetKey], prev))\n\n        if (category === targetKey) {\n          setCategory(\n            compose(\n              Rlast,\n              filter((key: string) => key !== targetKey),\n              keys\n            )(snippetList)\n          )\n        }\n      },\n    })\n  }\n\n  const handleTabNameChange = (targetKey: string) => (\n    evt: React.FocusEvent<HTMLSpanElement>\n  ) => {\n    const newTabName = evt.target.innerHTML\n\n    setSnippetList((prev: Snippets) =>\n      compose(\n        mergeAll,\n        map((key: string) => ({\n          [key === targetKey ? newTabName : key]: prev[key],\n        })),\n        keys\n      )(prev)\n    )\n    setCategory(newTabName)\n  }\n\n  const handleTabEdit = (\n    e:\n      | string\n      | React.MouseEvent<Element, MouseEvent>\n      | React.KeyboardEvent<Element>,\n    action: 'add' | 'remove'\n  ) => {\n    const handler = action === 'add' ? handleTabAdd : handleTabRemove\n\n    handler(e as string)\n  }\n\n  return {\n    ...r,\n    refetch,\n    category,\n    snippetList,\n    setCategory,\n    setSnippetList,\n    handleTabEdit,\n    handleTabChange,\n    handleTabMove,\n    handleTabAdd,\n    handleTabRemove,\n    handleTabNameChange,\n    handleSnippetUpdate,\n  }\n}\n\nexport const useMakeRequestPayload = () => {\n  const { user } = useAuth()\n  return (values: ReportTemplate) =>\n    omit([\n      'setting',\n      'createDate',\n      'createdAt',\n      'createdAtStr',\n      'updateDate',\n      'updatedAt',\n      'updatedAtStr',\n    ])({\n      ...values,\n      ...(values.id ? { templateId: values.id } : {}),\n      userId: user.id,\n      division: user.division,\n      templateName: values.name,\n      status: values.status || reportTemplateStatusEnums.DRAFT,\n      templateDescription: values.description,\n      template: compose(\n        flatten,\n        map((key: string) =>\n          compose(\n            map((s: SnippetProps) => ({\n              ...s,\n              ...s.setting,\n              ...(s.inline\n                ? { clozeId: s.id, html: encodeURIComponent(s.html) }\n                : { topicId: s.id, toolTip: s?.setting?.tooltip }),\n              tab: key,\n              categoryName: s.inline ? 'cloze' : 'topic',\n            })),\n            pathOr([], ['setting', key])\n          )(values)\n        ),\n        keys\n      )(values.setting),\n    })\n}\n\nexport const useCreateTemplate = (options: MutationOptions = {}) => {\n  const [loading, mutate] = useCreateReportTemplateAPI(options)\n  const makeRequestPayload = useMakeRequestPayload()\n\n  const hanlder = (values: ReportTemplate) => {\n    return mutate(makeRequestPayload(values))\n  }\n\n  return [loading, hanlder] as Mutation\n}\n\nexport const useUpdateTemplate = (options: MutationOptions = {}) => {\n  const [loading, mutate] = useUpdateReportTemplateAPI(options)\n  const makeRequestPayload = useMakeRequestPayload()\n\n  const hanlder = (values: ReportTemplate) => {\n    // console.log(makeRequestPayload(values))\n    // return Promise.resolve({})\n    return mutate(makeRequestPayload(values))\n  }\n\n  return [loading, hanlder] as Mutation\n}\n\nexport const useDeleteTemplate = (options: MutationOptions = {}) => {\n  const [loading, mutate] = useDeleteReportTemplateAPI(options)\n\n  const { user } = useAuth()\n\n  const hanlder = (values: ReportTemplate) => {\n    return mutate({\n      ...values,\n      userId: user.id,\n      division: user.division,\n      TemplateNAME: values.name,\n    })\n  }\n\n  return [loading, hanlder] as Mutation\n}\n\nexport const useExportTemplate = ({\n  data,\n  filename,\n}: {\n  data: ReportTemplate\n  filename: string\n}) => {\n  const handleExport = () => {\n    downloadAsJson({\n      filename: `${filename}_${data?.name || ''}_${moment().format(\n        'YYYYMMDDHHmmss'\n      )}`,\n      json: data,\n    })\n  }\n\n  return handleExport\n}\n\nconst reportPreviewState = atom({\n  key: 'reportPreviewState',\n  default: false,\n})\n\nconst categoryState = atom<string>({\n  key: 'categoryState',\n  default: selector({\n    key: 'categoryState/default',\n    get: ({ get }) => compose(head, values)(get(snippetCategoryOfReportState)),\n  }),\n})\n\n// 切換編輯/檢視模式\nexport function useReportPreview() {\n  const [isPreview, setIsPreview] = useRecoilState(reportPreviewState)\n\n  return [isPreview, () => setIsPreview(prev => !prev)] as [boolean, () => void]\n}\n\n// 更方便切換編輯/檢視模式\nexport function useToggleReportPreview(state: boolean = false) {\n  const [isPreview, setIsPreview] = useRecoilState(reportPreviewState)\n\n  React.useEffect(() => {\n    setIsPreview(state)\n\n    return () => {\n      setIsPreview(false)\n    }\n  }, [state]) // eslint-disable-line\n\n  return [isPreview, () => setIsPreview(prev => !prev)] as [boolean, () => void]\n}\n\n// 編輯報告/模版時，當前的分類\nexport function useCurrentCategoryOfSnippet() {\n  return useRecoilState(categoryState)\n}\n","import React from 'react'\nimport styled, { css } from 'styled-components'\nimport { Button } from 'antd'\nimport { ButtonProps } from 'antd/lib/button'\nimport { ActionTypes } from '@/constants/enums'\n// import useRouteCRUDAuthCheck from 'shared/hooks/useRouteCRUDAuthCheck'\n// import * as Icons from 'shared/components/Icons'\n\ninterface Props extends Omit<ButtonProps, 'icon'> {\n  children?: React.ReactNode\n  circle?: boolean\n  color?: string\n  css?: React.CSSProperties\n  icon?: string | React.ReactNode\n  onClick?: (evt: React.MouseEvent<HTMLElement>) => any\n  actionType?: ActionTypes\n}\n\nconst StyledButton = styled(Button)<Props>`\n  &.ant-btn {\n    min-width: 80px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n\n    .anticon {\n      margin-right: 6px;\n    }\n\n    &.ant-btn-loading {\n      padding-left: 8px;\n    }\n\n    .ant-btn > .ant-btn-loading-icon .anticon {\n      padding-right: 0;\n    }\n\n    svg {\n      width: 20px;\n      height: 20px;\n    }\n\n    &.ant-btn-sm svg {\n      width: 16px;\n      height: 16px;\n    }\n\n    ${p =>\n      p.color === 'primary' &&\n      css`\n        color: #fff;\n        border-color: ${p => p.theme.btn.primary};\n        background: ${p => p.theme.btn.primary};\n\n        &:hover,\n        &:focus,\n        &:active {\n          color: #fff;\n          background: ${p => p.theme.btn.secondary};\n          border-color: ${p => p.theme.btn.secondary};\n        }\n      `};\n\n    ${p =>\n      p.color === 'outline' &&\n      css`\n        padding: 0 8px;\n        color: ${p => p.theme.btn.primary};\n        border: 1.3px solid ${p => p.theme.btn.primary};\n        background: transparent;\n\n        &:hover,\n        &:focus,\n        &:active {\n          color: ${p => p.theme.primary};\n          background: transparent;\n          border: 1.3px solid ${p => p.theme.btn.primary};\n        }\n      `};\n\n    ${p =>\n      p.color === 'danger' &&\n      css`\n        color: ${p => p.theme.btn.danger};\n        border: 1.3px solid ${p => p.theme.btn.danger};\n        background: #fff;\n\n        &:hover,\n        &:focus,\n        &:active {\n          color: ${p => p.theme.btn.danger};\n          background: #fff6e4;\n          border: 1.3px solid ${p => p.theme.btn.danger};\n        }\n      `};\n\n    ${p =>\n      p.type === 'link' &&\n      css`\n        min-width: auto;\n        padding-left: 0;\n        padding-right: 0;\n        background: transparent;\n        border-color: transparent;\n        color: ${p.theme.primary};\n\n        > span {\n          text-decoration: underline;\n        }\n\n        &:hover {\n          background: transparent;\n          border-color: transparent;\n        }\n      `};\n\n    ${p =>\n      p.size === 'small' &&\n      css`\n        line-height: 1.2;\n      `}\n\n    &.hover--none {\n      &:hover,\n      &:focus,\n      &:active {\n        color: initial;\n        background: initial;\n        border-color: initial;\n      }\n    }\n  }\n\n  &.ant-btn.ant-btn-loading:not(.ant-btn-circle):not(.ant-btn-circle-outline):not(.ant-btn-icon-only) {\n    padding-left: 20px;\n  }\n\n  &.ant-btn[disabled] {\n    svg > g path:nth-child(2) {\n      transition: fill 0.4s ease;\n      fill: darkgrey;\n    }\n  }\n`\n\nexport { StyledButton as Butotn }\n\nexport default function ButtonComponent({\n  // icon,\n  children,\n  loading,\n  actionType,\n  ...props\n}: Props) {\n  // const [, checkIsAuthenticated] = useRouteCRUDAuthCheck()\n\n  // if (actionType && !checkIsAuthenticated(actionType)) {\n  //   return null\n  // }\n\n  return (\n    <StyledButton {...props} loading={loading}>\n      {(() => {\n        // if (icon && !loading) {\n        //   let Icon\n\n        //   const isElement = React.isValidElement(icon)\n\n        //   if (!isElement) {\n        //     Icon = icon\n        //   }\n\n        //   if (typeof icon === 'string') {\n        //     const nameCapitalized = icon.charAt(0).toUpperCase() + icon.slice(1)\n        //     const iconName = 'Icon' + nameCapitalized\n        //     Icon = (Icons as any)[iconName]\n        //   }\n\n        //   return (\n        //     <div className=\"l-flex--center\">\n        //       {isElement ? icon : <Icon className=\"c-icon is--secondary\" />}\n        //       {children}\n        //     </div>\n        //   )\n        // }\n\n        return children\n      })()}\n    </StyledButton>\n  )\n}\n","import React from 'react'\nimport { ModalProps as AntModalProps } from 'antd/lib/modal'\nimport Modal from '@/components/modal'\nimport Button from '@/components/button'\n\nexport interface ModalProps<T = any>\n  extends Omit<AntModalProps, 'onOk' | 'onCancel'> {\n  item?: T\n  onOk?: (data?: any) => void\n  onSelect?: (radlex: string) => void\n  onCancel: () => void\n  children?: React.ReactNode\n}\n\nfunction TemplateModal<T = any>({\n  onCancel,\n  onOk,\n  item,\n  children,\n  ...props\n}: ModalProps<T>) {\n  const handleOk = () => {\n    if (onOk) {\n      onOk()\n    }\n  }\n  return (\n    <Modal\n      visible\n      onCancel={onCancel}\n      width={650}\n      maskClosable={false}\n      keyboard={false}\n      footer={[\n        <Button\n          key=\"btn-cancel\"\n          color=\"outline\"\n          style={{ minWidth: 80, marginRight: 16 }}\n          onClick={onCancel}>\n          取消\n        </Button>,\n        <Button\n          key=\"btn-save\"\n          color=\"primary\"\n          style={{ minWidth: 80 }}\n          onClick={handleOk}>\n          儲存\n        </Button>,\n      ]}\n      {...props}>\n      {children}\n    </Modal>\n  )\n}\n\nexport { TemplateModal as Modal }\n\nexport default TemplateModal\n","// import React from 'react'\nimport { Form } from 'antd'\nimport styled from 'styled-components'\n\nexport const FormItem = styled(Form.Item)`\n  &.is--flex .ant-form-item-control-input-content {\n    display: flex;\n    align-items: center;\n  }\n`\n","import React from 'react'\nimport cx from 'classnames'\nimport { Form, Row, Col } from 'antd'\nimport { ColumnProps } from 'antd/lib/table'\nimport { ModalProps } from 'antd/lib/modal'\nimport { LinkOutlined } from '@ant-design/icons'\nimport {\n  head,\n  isNil,\n  is,\n  of,\n  identity,\n  always,\n  ifElse,\n  update,\n  pathOr,\n  path,\n} from 'ramda'\nimport { FormItem } from '@/components/form'\nimport Modal from '@/components/modal'\nimport { Input } from '@/components/input'\nimport Table from '@/components/query-table'\nimport Button from '@/components/button'\nimport { useRadlexes } from '@/services/radlex'\nimport useTableRowSelection from '@/hooks/useTableRowSelection'\nimport useVisible from '@/hooks/useVisible'\nimport { ReportTemplateSetting } from '@/constants/types'\nconst { compose } = require('ramda')\n\ninterface RadlexProps {\n  onSelect?: (value: { radlexCode: string }) => void\n  field?: string | (string | number)[]\n  inline?: boolean\n  item?: ReportTemplateSetting\n}\n\nexport function useRadlex(onOk?: (value: { radlexCode: string }) => void) {\n  return (value: { radlexCode: string }) => {\n    if (onOk) {\n      onOk(value)\n    }\n  }\n}\n\nexport function Radlex({\n  onSelect,\n  inline = false,\n  field = 'text',\n  item,\n}: RadlexProps) {\n  const [radlexModalVisible, handleRadlexModalVisible] = useVisible()\n\n  const handleSelect = (radlex: { id: number; code: string }) => {\n    if (onSelect) {\n      onSelect(\n        ifElse(\n          is(Array),\n          ([, idx]: any[] = []) => {\n            return {\n              options: compose(\n                update(idx, {\n                  ...pathOr({}, ['options', idx])(item),\n                  radlexCode: radlex?.code,\n                } as any),\n                pathOr([], ['options'])\n              )(item),\n            }\n          },\n          always({ radlexCode: radlex?.code })\n        )(field)\n      )\n    }\n    handleRadlexModalVisible()\n  }\n\n  let radlexCode = ifElse(\n    is(Array),\n    ([, idx]: any[]) => {\n      return path(['options', idx, 'radlexCode'], item)\n    },\n    () => path(['radlexCode'], item)\n  )(field)\n\n  return (\n    <>\n      {radlexModalVisible && (\n        <RadlexListModal\n          selected={radlexCode}\n          onOk={handleSelect}\n          onCancel={handleRadlexModalVisible}\n        />\n      )}\n      <FormItem noStyle={inline} label=\"Text\" className=\"is--flex\">\n        <Form.Item noStyle name={field}>\n          <Input\n            className={cx({\n              'is--linked': !isNil(radlexCode),\n              'w-11/12': inline,\n            })}\n          />\n        </Form.Item>\n        <Form.Item noStyle>\n          <LinkOutlined\n            className=\"ml-2 cursor-pointer relative\"\n            style={{ top: -3 }}\n            onClick={handleRadlexModalVisible}\n          />\n        </Form.Item>\n      </FormItem>\n    </>\n  )\n}\n\ninterface RadlexModalProps extends Omit<ModalProps, 'onOk'> {\n  onOk(value: { code: string; id: number }): void\n  selected?: string\n}\n\nexport function RadlexListModal({\n  onOk,\n  onCancel,\n  selected,\n  ...props\n}: RadlexModalProps) {\n  const { dataSource, loading } = useRadlexes()\n\n  const [keyword, setKeyword] = React.useState<string>()\n\n  const { rowSelection, selectedRows } = useTableRowSelection({\n    multiple: false,\n    ...(selected\n      ? {\n          defaultRowKeys: ifElse(is(Array), identity, of)(selected),\n        }\n      : {}),\n  })\n\n  const columns: ColumnProps<{ code: number; value: string }>[] = [\n    {\n      title: 'SNOMED CT',\n      dataIndex: 'code',\n      render: (v, r) => `${r.value} (${r.code})`,\n    },\n  ]\n\n  const handleChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    setKeyword(evt.target.value)\n  }\n\n  const handleOk = () => {\n    onOk(head(selectedRows))\n  }\n\n  let _dataSource = {\n    ...dataSource,\n    content: dataSource.content.filter(x =>\n      keyword\n        ? `${x.code}`.includes(keyword) || `${x.value}`.includes(keyword)\n        : true\n    ),\n  }\n\n  return (\n    <Modal\n      {...props}\n      visible\n      title=\"選擇 SNOMED CT\"\n      bodyStyle={{\n        paddingTop: 48,\n        paddingLeft: 64,\n        paddingRight: 64,\n      }}\n      width={650}\n      footer={[\n        <Button key=\"btn-cancel\" color=\"outline\" onClick={onCancel}>\n          取消\n        </Button>,\n        <Button\n          key=\"btn-ok\"\n          color=\"primary\"\n          onClick={handleOk}\n          className=\"ml-3\">\n          確認\n        </Button>,\n      ]}\n      onCancel={onCancel}\n      keyboard={false}\n      maskClosable={false}>\n      <Row>\n        <Col span={24}>\n          關鍵字:\n          <Input\n            className=\"ml-2 w-2/3\"\n            placeholder=\"輸入 SNOMED CT\"\n            onChange={handleChange}\n          />\n        </Col>\n      </Row>\n      <Row className=\"mt-6\">\n        <Col span={24}>\n          <Table\n            rowKey=\"code\"\n            size=\"small\"\n            dataSource={_dataSource}\n            loading={loading}\n            columns={columns}\n            pagination={{ pageSize: 12 }}\n            rowSelection={rowSelection}\n          />\n        </Col>\n      </Row>\n    </Modal>\n  )\n}\n","import { pathOr, length } from 'ramda'\nimport useLazyQuery from '@/hooks/useQuery'\nimport { QueryVariables } from '@/constants/types'\n\nexport function useRadlexes(variables: QueryVariables = {}) {\n  const { data, ...rest } = useLazyQuery<string[]>(\n    `/api/v1/c/getCodeBooksByKeyword`,\n    {\n      variables,\n      method: 'POST',\n      lazy: false,\n    }\n  )\n\n  const _data = pathOr(\n    [\n      { code: 1, value: 'Couinaud hepatic segment II' },\n      { code: 2, value: 'Couinaud hepatic segment III' },\n      { code: 3, value: 'Couinaud hepatic segment VI' },\n      { code: 4, value: 'Couinaud hepatic segment V' },\n      { code: 5, value: 'Couinaud hepatic segment VI' },\n      { code: 6, value: 'Couinaud hepatic segment VII' },\n      { code: 7, value: 'Couinaud hepatic segment VIII' },\n      // { id: 8, code: 'RID12348' },\n      // { id: 9, code: 'RID12349' },\n    ],\n    [],\n    data\n  )\n\n  const dataSource = {\n    content: _data,\n    total: length(_data),\n    totalPages: Math.floor(length(_data) / 12) + 1,\n  }\n\n  return {\n    ...rest,\n    data,\n    dataSource,\n  }\n}\n","import React from 'react'\nimport { Form } from 'antd'\nimport { Input, TextArea } from '@/components/input'\nimport Checkbox from '@/components/checkbox'\nimport { Modal, ModalProps } from '@/components/snippet-template-modal'\nimport { Radlex, useRadlex } from '@/components/radlex-list-modal'\nimport { createFormItemLayout } from '@/utils/form'\nimport { ReportTemplateSetting, ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\n\ninterface Setting extends ReportTemplateSetting {\n  defaultValue?: string\n  multipleLine?: boolean\n}\n\nexport default function SnippetTemplateInputText(props: ReportTemplateProps) {\n  const { editModalVisible, handleEditModalVisible, onUpdate, item } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({ item, onUpdate })\n\n  const inputProps = {\n    bordered: false,\n    className: 'w-2/3',\n    placeholder: setting.tooltip,\n    defaultValue: setting.defaultValue,\n  }\n\n  return (\n    <>\n      {editModalVisible && (\n        <InputTextModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n        />\n      )}\n      <Form.Item noStyle name={['data', item.id]}>\n        {setting.multipleLine ? (\n          <TextArea {...inputProps} autoSize={{ minRows: 3 }} />\n        ) : (\n          <Input {...inputProps} />\n        )}\n      </Form.Item>\n    </>\n  )\n}\n\nfunction InputTextModal({\n  onOk,\n  onCancel,\n  item,\n  ...props\n}: ModalProps<Setting>) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(values => {\n      if (onOk) {\n        onOk(values)\n      }\n      onCancel()\n    })\n  }\n\n  const handleSelect = useRadlex(onOk)\n\n  return (\n    <Modal<Setting>\n      {...props}\n      title={\n        <>\n          <div>\n            Text\n            <div className=\"inline ml-2 text-sm text-gray-600\">\n              typically used for description something.\n            </div>\n          </div>\n        </>\n      }\n      onCancel={onCancel}\n      onOk={handleOk}>\n      <Form\n        {...createFormItemLayout(5, 16)}\n        labelAlign=\"left\"\n        form={form}\n        initialValues={item}>\n        <Radlex item={item} onSelect={handleSelect} />\n        <Form.Item label=\"Default Value\" name=\"defaultValue\">\n          <Input />\n        </Form.Item>\n        <Form.Item label=\"Tooltip\" name=\"tooltip\">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label=\"Multiple Lines\"\n          name=\"multipleLine\"\n          valuePropName=\"checked\">\n          <Checkbox />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\nimport { InputNumber } from 'antd'\nimport { InputNumberProps } from 'antd/lib/input-number'\nimport styled from 'styled-components'\nimport { RefProps } from '@/constants/types'\nimport { percent, currency, thosandSeprartor } from '@/utils/form'\n\ntype Props = RefProps & InputNumberProps & { bordered?: boolean }\n\nconst StyledInputNumber = styled(InputNumber).attrs({\n  min: 0 as any, // dont know why error\n})<Props>`\n  &.ant-input-number {\n    border-color: #d9d9d9;\n  }\n\n  &.ant-input-number-focused,\n  &.ant-input-number:focus,\n  &.ant-input-number:hover {\n    border-color: ${p => p.theme.primary};\n  }\n\n  &.ant-input-number-focused:not(.ant-input-number-borderless),\n  &.ant-input-number:focus:not(.ant-input-number-borderless) {\n    box-shadow: 0 0 0 1px ${p => p.theme.primary};\n  }\n\n  &.ant-input-number-borderless,\n  &.ant-input-number-borderless:hover,\n  &.ant-input-number-borderless:focus,\n  &.ant-input-number-borderless-focused,\n  &.ant-input-number-borderless-disabled,\n  &.ant-input-number-borderless[disabled] {\n    border: none;\n    border-bottom: 1px solid #d9d9d9;\n  }\n`\n\nexport const ThousandSeprartorInput = React.forwardRef<\n  typeof InputNumber,\n  Props\n>(({ ...props }, ref) => (\n  <StyledInputNumber forwardRef={ref} {...props} {...thosandSeprartor} />\n))\n\nexport const CurrencyInput = React.forwardRef<typeof InputNumber, Props>(\n  ({ ...props }, ref) => (\n    <StyledInputNumber forwardRef={ref} {...props} {...currency} />\n  )\n)\n\nexport const PercentInput = React.forwardRef<typeof InputNumber, Props>(\n  ({ ...props }, ref) => (\n    <StyledInputNumber forwardRef={ref} {...props} {...percent} />\n  )\n)\n\nThousandSeprartorInput.displayName = 'ThousandSeprartorInput'\n\nCurrencyInput.displayName = 'CurrencyInput'\n\nPercentInput.displayName = 'PercentInput'\n\nexport { StyledInputNumber as InputNumber }\n\nexport default StyledInputNumber\n","import React from 'react'\nimport { Form } from 'antd'\nimport Input from '@/components/input'\nimport InputNumber from '@/components/input-number'\nimport { Modal, ModalProps } from '@/components/snippet-template-modal'\nimport { Radlex, useRadlex } from '@/components/radlex-list-modal'\nimport { createFormItemLayout } from '@/utils/form'\nimport { ReportTemplateSetting, ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\nimport { getNumberFromString } from '@/utils/webHelper'\nimport { is } from 'ramda'\n\ninterface Setting extends ReportTemplateSetting {\n  defaultValue?: number\n  max?: number\n  min?: number\n  units?: string\n}\n\nexport default function SnippetTemplateInputNumber(props: ReportTemplateProps) {\n  const { editModalVisible, handleEditModalVisible, item, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({ item, onUpdate })\n\n  return (\n    <>\n      {editModalVisible && (\n        <InputNumberModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n        />\n      )}\n      <Form.Item\n        noStyle\n        name={['data', item.id]}\n        initialValue={setting.defaultValue}>\n        <InputNumber\n          style={{ width: '33.333333%' }}\n          className=\"ant-input-number-borderless\"\n          min={setting.min}\n          max={setting.max}\n          formatter={(value: any) => {\n            if (!setting.units) {\n              return value\n            }\n            if (value && is(String, value) && value.includes(setting.units)) {\n              return `${getNumberFromString(value)} ${setting.units}`\n            }\n            return `${value} ${setting.units}`\n          }}\n          parser={(value: any) =>\n            setting.units\n              ? value.replace(new RegExp(`/s${setting.units}/g`), '')\n              : value\n          }\n          placeholder={setting.tooltip}\n        />\n      </Form.Item>\n    </>\n  )\n}\n\nfunction InputNumberModal({ onOk, onCancel, item, ...props }: ModalProps) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(values => {\n      if (onOk) {\n        onOk(values)\n      }\n      onCancel()\n    })\n  }\n\n  const handleSelect = useRadlex(onOk)\n\n  return (\n    <Modal\n      {...props}\n      title={\n        <>\n          <div>\n            Number\n            <div className=\"inline ml-2 text-sm text-gray-600\">\n              typically used for input number.\n            </div>\n          </div>\n        </>\n      }\n      onOk={handleOk}\n      onCancel={onCancel}>\n      <Form\n        {...createFormItemLayout(5, 16)}\n        labelAlign=\"left\"\n        form={form}\n        initialValues={item}>\n        <Radlex item={item} onSelect={handleSelect} />\n        <Form.Item label=\"Default Value\" name=\"defaultValue\">\n          <Input />\n        </Form.Item>\n        <Form.Item label=\"Tooltip\" name=\"tooltip\">\n          <Input />\n        </Form.Item>\n        <Form.Item label=\"Minimum Value\" name=\"min\">\n          <InputNumber />\n        </Form.Item>\n        <Form.Item label=\"Maximum Value\" name=\"max\">\n          <InputNumber />\n        </Form.Item>\n        <Form.Item label=\"Units\" name=\"units\">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","// tslint:disable: quotemark no-implicit-dependencies no-shadowed-variable no-var-requires\nimport React from 'react'\nimport { TableProps } from 'antd/lib/table'\nimport { FormInstance } from 'antd/lib/form'\nimport Table from '@/components/table'\n\ntype EditableTableProps<T> = Omit<TableProps<T>, 'onChange'> & {\n  value?: T[]\n  form: FormInstance\n  onChange?(changedValue: T[] | null): void\n  onRowAdd: (form: FormInstance) => any\n  onRowDelete: (value: { id: React.Key; form: FormInstance }) => any\n}\n\nexport default function EditableTable<T = any>({\n  form,\n  value,\n  onChange,\n  onRowAdd,\n  onRowDelete,\n  ...props\n}: EditableTableProps<T>) {\n  const triggerChange = (changedValue: T[]) => {\n    if (onChange) {\n      onChange(changedValue)\n    }\n  }\n\n  const handleAdd = () => {\n    triggerChange(onRowAdd(form))\n  }\n\n  const handleDelete = (id: string) => {\n    triggerChange(onRowDelete({ id, form }))\n  }\n\n  return (\n    <Table\n      {...props}\n      rowKey=\"id\"\n      pagination={false}\n      size=\"small\"\n      dataSource={value as any}\n      onAddRowClick={handleAdd}\n      onDeleteRowClick={handleDelete}\n      editable={true}\n    />\n  )\n}\n","import React from 'react'\nimport { Form } from 'antd'\nimport { ColumnProps } from 'antd/lib/table'\nimport { FormInstance } from 'antd/lib/form'\nimport { concat, __, pathOr, invoker, filter } from 'ramda'\nimport Input from '@/components/input'\nimport Checkbox from '@/components/checkbox'\nimport EditableTable from '@/components/editable-table'\nimport { Radlex, useRadlex } from '@/components/radlex-list-modal'\nimport { uuid } from '@/utils/webHelper'\nimport { createFormItemLayout } from '@/utils/form'\nimport { ReportTemplateSetting } from '@/constants/types'\nimport { Modal, ModalProps } from './snippet-template-modal'\nconst { compose } = require('ramda')\n\nexport interface Setting extends ReportTemplateSetting {\n  options?: Option[]\n}\n\nexport type Option = {\n  id: React.Key\n  text?: string\n  selected?: boolean\n  freetext?: boolean\n}\n\nexport const defaultValue: Setting = {\n  options: [\n    {\n      id: uuid(),\n      text: 'default option 1',\n      selected: true,\n      freetext: false,\n    },\n    {\n      id: uuid(),\n      text: 'default option 2',\n      selected: true,\n      freetext: false,\n    },\n    {\n      id: uuid(),\n      text: 'default option 3',\n      selected: true,\n      freetext: false,\n    },\n  ],\n}\n\ninterface Props extends ModalProps {\n  freetextVisible?: boolean\n}\n\nexport function SnippetTemplateSelectionModal({\n  onCancel,\n  onOk,\n  item,\n  freetextVisible = true,\n  title,\n  ...props\n}: Props) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(values => {\n      if (onOk) {\n        onOk(values)\n      }\n      onCancel()\n    })\n  }\n\n  const handleSelect = useRadlex(onOk)\n\n  const handleRowAdd = (form: FormInstance) => {\n    return compose(\n      concat(__, [\n        {\n          id: uuid(),\n          text: undefined,\n          radlexCode: undefined,\n          selected: true,\n          freetext: false,\n        },\n      ]),\n      pathOr([], ['options']),\n      invoker(0, 'getFieldsValue')()\n    )(form)\n  }\n\n  const handleRowDelete = ({\n    id,\n    form,\n  }: {\n    id: React.Key\n    form: FormInstance\n  }) => {\n    return compose(\n      filter((x: any) => x.id !== id),\n      pathOr([], ['options']),\n      invoker(0, 'getFieldsValue')()\n    )(form)\n  }\n\n  const columns: ColumnProps<Option>[] = [\n    {\n      title: '選項名稱',\n      render: (v, r, idx) => (\n        <Radlex\n          inline\n          item={item}\n          field={['options', idx, 'text']}\n          onSelect={handleSelect}\n        />\n      ),\n    },\n    {\n      title: '是否可選',\n      align: 'center',\n      render: (v, r, idx) => (\n        <Form.Item\n          noStyle\n          name={['options', idx, 'selected']}\n          valuePropName=\"checked\">\n          <Checkbox />\n        </Form.Item>\n      ),\n    },\n    ...((freetextVisible\n      ? [\n          {\n            title: '是否可輸入',\n            align: 'center',\n            render: (v, r, idx) => (\n              <Form.Item\n                noStyle\n                name={['options', idx, 'freetext']}\n                valuePropName=\"checked\">\n                <Checkbox />\n              </Form.Item>\n            ),\n          },\n        ]\n      : []) as ColumnProps<Option>[]),\n  ]\n\n  React.useEffect(() => {\n    form.setFieldsValue(item)\n  }, [JSON.stringify(item)]) // eslint-disable-line\n\n  return (\n    <Modal\n      {...props}\n      title={\n        title || (\n          <>\n            <div>Single Selection List</div>\n            <div className=\"mt-1 text-sm text-gray-600\">\n              Typically used for shorter lists so that all responses are visible\n              as radio buttons. Only allow a single selection.\n            </div>\n          </>\n        )\n      }\n      onCancel={onCancel}\n      onOk={handleOk}>\n      <Form\n        {...createFormItemLayout(3, 16)}\n        labelAlign=\"left\"\n        form={form}\n        initialValues={item}>\n        <Radlex item={item} onSelect={handleSelect} />\n        <Form.Item label=\"Tooltip\" name=\"tooltip\">\n          <Input />\n        </Form.Item>\n        <Form.Item label=\"Options\" />\n        <Form.Item noStyle name=\"options\">\n          <EditableTable\n            columns={columns}\n            form={form}\n            onRowAdd={handleRowAdd}\n            onRowDelete={handleRowDelete}\n          />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\nimport { Form } from 'antd'\nimport cx from 'classnames'\nimport { pathOr } from 'ramda'\nimport { Checkbox, CheckboxGroup } from '@/components/checkbox'\nimport Input from '@/components/input'\nimport {\n  SnippetTemplateSelectionModal,\n  Setting,\n  Option,\n  defaultValue,\n} from '@/components/snippet-template-selection-modal'\nimport { mapIndexed } from '@/utils/webHelper'\nimport { ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\nconst { compose } = require('ramda')\n\nfunction SnippetTemplateMultipleSelection(props: ReportTemplateProps) {\n  const { item, editModalVisible, handleEditModalVisible, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({\n    item,\n    onUpdate,\n    defaultValue,\n  })\n\n  return (\n    <>\n      {editModalVisible && (\n        <SnippetTemplateSelectionModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n          title={\n            <>\n              <div>Multiple Selection List</div>\n              <div className=\"mt-1 text-sm text-gray-600\">\n                typically used for shorter lists so that all responses are\n                visible as checkboxes. Allows Multiple selections.\n              </div>\n            </>\n          }\n        />\n      )}\n      <Form.Item noStyle name={['data', item.id]}>\n        <CheckboxGroup>\n          {compose(\n            mapIndexed((x: Option, idx: number) => (\n              <Checkbox\n                key={x.id}\n                className={cx('block ml-0', { 'mt-1': idx > 0 })}\n                defaultChecked={false}\n                value={x.text}>\n                {x.text}\n                {x.freetext && (\n                  <Input\n                    bordered={false}\n                    size=\"small\"\n                    placeholder=\"輸入備註\"\n                    className=\"ml-4 w-full\"\n                  />\n                )}\n              </Checkbox>\n            )),\n            pathOr([], ['options'])\n          )(setting)}\n        </CheckboxGroup>\n      </Form.Item>\n    </>\n  )\n}\n\nexport default SnippetTemplateMultipleSelection\n","import React from 'react'\nimport cx from 'classnames'\nimport { Form } from 'antd'\nimport { pathOr } from 'ramda'\nimport Radio from '@/components/radio'\nimport Input from '@/components/input'\nimport {\n  SnippetTemplateSelectionModal,\n  Setting,\n  Option,\n  defaultValue,\n} from '@/components/snippet-template-selection-modal'\nimport { mapIndexed } from '@/utils/webHelper'\nimport { ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\nconst { compose } = require('ramda')\n\nfunction SnippetTemplateSingleSelection(props: ReportTemplateProps) {\n  const { item, editModalVisible, handleEditModalVisible, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({\n    item,\n    onUpdate,\n    defaultValue,\n  })\n\n  return (\n    <>\n      {editModalVisible && (\n        <SnippetTemplateSelectionModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n        />\n      )}\n      <Form.Item noStyle name={['data', item.id]}>\n        <Radio.Group>\n          {compose(\n            mapIndexed((x: Option, idx: number) => (\n              <Radio\n                key={x.id}\n                className={cx('block', { 'mt-1': idx > 0 })}\n                defaultChecked={false}\n                value={x.text}>\n                {x.text || '預設選項'}\n                {x.freetext && (\n                  <Input\n                    size=\"small\"\n                    bordered={false}\n                    placeholder=\"輸入備註\"\n                    className=\"ml-3 w-full\"\n                  />\n                )}\n              </Radio>\n            )),\n            pathOr([], ['options'])\n          )(setting)}\n        </Radio.Group>\n      </Form.Item>\n    </>\n  )\n}\n\nexport default SnippetTemplateSingleSelection\n","import React from 'react'\nimport { Form } from 'antd'\nimport Input from '@/components/input'\nimport DatePicker from '@/components/datepicker'\nimport { Modal, ModalProps } from '@/components/snippet-template-modal'\nimport { Radlex, useRadlex } from '@/components/radlex-list-modal'\nimport { createFormItemLayout } from '@/utils/form'\nimport { ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\n\ntype Setting = {\n  text?: string\n  defaultValue?: moment.Moment\n  tooltip?: string\n}\n\nexport default function SnippetTemplateDate(props: ReportTemplateProps) {\n  const { editModalVisible, handleEditModalVisible, item, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({ item, onUpdate })\n\n  return (\n    <>\n      {editModalVisible && (\n        <InputDateModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n        />\n      )}\n      <Form.Item\n        noStyle\n        name={['data', item.id]}\n        initialValue={setting.defaultValue}>\n        <DatePicker\n          bordered={false}\n          className=\"w-1/3\"\n          placeholder={setting.tooltip}\n        />\n      </Form.Item>\n    </>\n  )\n}\n\nfunction InputDateModal({\n  onOk,\n  onCancel,\n  item,\n  ...props\n}: ModalProps<Setting>) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(values => {\n      if (onOk) {\n        onOk(values)\n      }\n      onCancel()\n    })\n  }\n\n  const handleSelect = useRadlex(onOk)\n\n  return (\n    <Modal<Setting>\n      {...props}\n      title={\n        <>\n          <div>\n            Date\n            <div className=\"inline ml-2 text-sm text-gray-600\">\n              typically used for target date.\n            </div>\n          </div>\n        </>\n      }\n      onCancel={onCancel}\n      onOk={handleOk}>\n      <Form\n        {...createFormItemLayout(5, 16)}\n        labelAlign=\"left\"\n        form={form}\n        initialValues={item}>\n        <Radlex item={item} onSelect={handleSelect} />\n        <Form.Item label=\"Default Value\" name=\"defaultValue\">\n          <DatePicker allowClear picker=\"date\" className=\"w-full\" />\n        </Form.Item>\n        <Form.Item label=\"Tooltip\" name=\"tooltip\">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\nimport { Form } from 'antd'\nimport Input from '@/components/input'\nimport { TimePicker } from '@/components/datepicker'\nimport { Modal, ModalProps } from '@/components/snippet-template-modal'\nimport { Radlex, useRadlex } from '@/components/radlex-list-modal'\nimport { createFormItemLayout } from '@/utils/form'\nimport { ReportTemplateSetting, ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\n\ninterface Setting extends ReportTemplateSetting {\n  defaultValue?: moment.Moment\n}\n\nexport default function ReportTemplateTime(props: ReportTemplateProps) {\n  const { editModalVisible, handleEditModalVisible, item, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({ item, onUpdate })\n\n  return (\n    <>\n      {editModalVisible && (\n        <InputTimeModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n        />\n      )}\n      <Form.Item\n        noStyle\n        name={['data', item.id]}\n        initialValue={setting.defaultValue}>\n        <TimePicker\n          bordered={false}\n          className=\"w-1/3\"\n          placeholder={setting.tooltip}\n        />\n      </Form.Item>\n    </>\n  )\n}\n\nfunction InputTimeModal({\n  onOk,\n  onCancel,\n  item,\n  ...props\n}: ModalProps<Setting>) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(values => {\n      if (onOk) {\n        onOk(values)\n      }\n      onCancel()\n    })\n  }\n\n  const handleSelect = useRadlex(onOk)\n\n  return (\n    <Modal<Setting>\n      {...props}\n      title={\n        <>\n          <div>\n            Time\n            <div className=\"inline ml-2 text-sm text-gray-600\">\n              typically used for target time.\n            </div>\n          </div>\n        </>\n      }\n      onCancel={onCancel}\n      onOk={handleOk}>\n      <Form\n        {...createFormItemLayout(5, 16)}\n        labelAlign=\"left\"\n        form={form}\n        initialValues={item}>\n        <Radlex item={item} onSelect={handleSelect} />\n        <Form.Item label=\"Default Value\" name=\"defaultValue\">\n          <TimePicker allowClear format=\"HH:mm\" className=\"w-full\" />\n        </Form.Item>\n        <Form.Item label=\"Tooltip\" name=\"tooltip\">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\nimport { pathOr, map } from 'ramda'\nimport { Form } from 'antd'\nimport Select from '@/components/select'\nimport {\n  SnippetTemplateSelectionModal,\n  Option,\n  defaultValue,\n} from '@/components/snippet-template-selection-modal'\nimport { ReportTemplateSetting, ReportTemplateProps } from '@/constants/types'\nimport { useUpdateSnippet } from '@/services/report-template'\nconst { compose } = require('ramda')\n\ninterface Setting extends ReportTemplateSetting {\n  options?: Option[]\n  selectionType?: 'single' | 'multiple'\n}\n\nexport default function SnippetTemplateSelect(props: ReportTemplateProps) {\n  const { item, editModalVisible, handleEditModalVisible, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({\n    item,\n    onUpdate,\n    defaultValue,\n  })\n\n  return (\n    <>\n      {editModalVisible && (\n        <SnippetTemplateSelectionModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n          freetextVisible={false}\n          title={\n            <>\n              <div>Drop-down List</div>\n              <div className=\"mt-1 text-sm text-gray-600\">\n                typically used for lists of greater than 6 or 7 options.\n              </div>\n            </>\n          }\n        />\n      )}\n      <Form.Item noStyle name={['data', item.id]}>\n        <Select\n          allowClear\n          bordered={false}\n          className=\"w-2/3\"\n          placeholder={setting.tooltip}>\n          {compose(\n            map((x: Option) => (\n              <Select.Option key={x.id} value={x.text || ''}>\n                {x.text || ''}\n              </Select.Option>\n            )),\n            pathOr([], ['options'])\n          )(setting)}\n        </Select>\n      </Form.Item>\n    </>\n  )\n}\n","import React from 'react'\nimport { Form } from 'antd'\nimport Input from '@/components/input'\nimport { Modal, ModalProps } from '@/components/snippet-template-modal'\nimport { createFormItemLayout } from '@/utils/form'\nimport { useUpdateSnippet } from '@/services/report-template'\nimport { ReportTemplateSetting, ReportTemplateProps } from '@/constants/types'\n\ninterface Setting extends ReportTemplateSetting {}\n\nexport default function TemplateSectionHeader(props: ReportTemplateProps) {\n  const { item, editModalVisible, handleEditModalVisible, onUpdate } = props\n\n  const { setting, handleOk } = useUpdateSnippet<Setting>({\n    item,\n    onUpdate,\n  })\n\n  return (\n    <>\n      {editModalVisible && (\n        <InputTextModal\n          item={setting}\n          onCancel={handleEditModalVisible}\n          onOk={handleOk}\n        />\n      )}\n    </>\n  )\n}\n\nfunction InputTextModal({\n  onOk,\n  onCancel,\n  item,\n  ...props\n}: ModalProps<Setting>) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(values => {\n      if (onOk) {\n        onOk(values)\n      }\n      onCancel()\n    })\n  }\n\n  return (\n    <Modal<Setting>\n      {...props}\n      title={\n        <>\n          <div>\n            Section Header\n            <div className=\"inline ml-2 text-sm text-gray-600\">\n              typically used for section.\n            </div>\n          </div>\n        </>\n      }\n      onCancel={onCancel}\n      onOk={handleOk}>\n      <Form\n        {...createFormItemLayout(5, 16)}\n        labelAlign=\"left\"\n        form={form}\n        initialValues={item}>\n        <Form.Item label=\"Text\" name=\"text\">\n          <Input />\n        </Form.Item>\n        <Form.Item label=\"Tooltip\" name=\"tooltip\">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\n\nfunction SnippetTemplateCloze() {\n  return <div></div>\n}\n\nexport const html = `\n  <span style=\"color: grey;\">(提示字，請自行刪除) 請在此輸入文字</span>\n`\n\nexport const Component = SnippetTemplateCloze\n\nexport default SnippetTemplateCloze\n","import { map, mergeAll, pathOr, path, keys } from 'ramda'\nimport {\n  CalendarOutlined,\n  ClockCircleOutlined,\n  OrderedListOutlined,\n  UnorderedListOutlined,\n  FontSizeOutlined,\n  DatabaseOutlined,\n  NumberOutlined,\n  BoldOutlined,\n  FontColorsOutlined,\n} from '@ant-design/icons'\nimport { uuid } from '@/utils/webHelper'\nimport TemplateInputText from '@/components/snippet-template-input-text'\nimport TemplateInputNumber from '@/components/snippet-template-input-number'\nimport TemplateMultipleSelection from '@/components/snippet-template-multiple-selection'\nimport TemplateSingleSelection from '@/components/snippet-template-single-selection'\nimport TemplateDate from '@/components/snippet-template-date'\nimport TemplateTime from '@/components/snippet-template-time'\nimport TemplateSelect from '@/components/snippet-template-select'\nimport TempldateSectionHeader from '@/components/snippet-template-section-header'\nimport * as Cloze from '@/components/snippet-template-cloze'\nimport { SnippetProps, ReportTemplate, PhraseTemplate } from '@/constants/types'\nimport { defaultOptions } from '@/components/snippet-utils'\nconst { compose } = require('ramda')\n\ninterface SnippetTemplateListItem {\n  id: React.Key\n  type: string\n  name: string\n  Component: React.Component\n  inline: boolean\n}\n\nexport const snippetTypes = {\n  HEADER: 'TemplateSectionHeader',\n  TEXT: 'TemplateInputText',\n  NUMBER: 'TemplateInputNumber',\n  SELECT: 'TemplateSelect',\n  MULTIPLE_SELECTION: 'TemplateMultipleSelection',\n  SINGLE_SELECTION: 'TemplateSingleSelection',\n  DATE: 'TemplateDate',\n  TIME: 'TemplateTime',\n  CLOZE: 'TemplateCloze',\n}\n\nconst snippetTemplateList = [\n  {\n    id: uuid(),\n    type: snippetTypes.HEADER,\n    name: 'Section Header',\n    inline: false,\n    icon: BoldOutlined,\n    Component: TempldateSectionHeader,\n    setting: {\n      text: 'Section Header - typically used for section.',\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.TEXT,\n    name: 'Text',\n    inline: false,\n    icon: FontSizeOutlined,\n    Component: TemplateInputText,\n    setting: {\n      text: 'Text - typically used for description something.',\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.NUMBER,\n    name: 'Number',\n    inline: false,\n    icon: NumberOutlined,\n    Component: TemplateInputNumber,\n    setting: {\n      text: 'Number - typically used for input number.',\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.SELECT,\n    name: 'Drop-down List',\n    inline: false,\n    icon: DatabaseOutlined,\n    Component: TemplateSelect,\n    setting: {\n      text:\n        'Drop-down List - typically used for lists of greater than 6 or 7 options.',\n      options: defaultOptions,\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.MULTIPLE_SELECTION,\n    name: 'Multiple Selection List',\n    inline: false,\n    icon: UnorderedListOutlined,\n    Component: TemplateMultipleSelection,\n    setting: {\n      text:\n        'Multiple Selection List | typically used for shorter lists so that all responses are visible as checkboxes. Allows Multiple selections.',\n      options: defaultOptions,\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.SINGLE_SELECTION,\n    name: 'Single Selection List',\n    inline: false,\n    icon: OrderedListOutlined,\n    Component: TemplateSingleSelection,\n    setting: {\n      text:\n        'Single Selection List | Typically used for shorter lists so that all responses are visible as radio buttons. Only allow a single selection.',\n      options: defaultOptions,\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.DATE,\n    name: 'Date',\n    inline: false,\n    icon: CalendarOutlined,\n    Component: TemplateDate,\n    setting: {\n      text: 'Date - typically used for target date.',\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.TIME,\n    name: 'Time',\n    inline: false,\n    icon: ClockCircleOutlined,\n    Component: TemplateTime,\n    setting: {\n      text: 'Time - typically used for target time.',\n    },\n  },\n  {\n    id: uuid(),\n    type: snippetTypes.CLOZE,\n    name: 'Cloze',\n    inline: true,\n    icon: FontColorsOutlined,\n    html: Cloze.html,\n    Component: Cloze.Component,\n  },\n]\n\nexport const snippetTemplateById = compose(\n  mergeAll,\n  map((x: SnippetTemplateListItem) => ({ [x.type]: x }))\n)(snippetTemplateList)\n\nexport const setComponentByTab = compose(\n  map((x: ReportTemplate) => ({\n    ...x,\n    setting: compose(\n      mergeAll,\n      map((key: string) => ({\n        [key]: compose(\n          map((s: SnippetProps) => ({\n            ...s,\n            Component: path([s?.type, 'Component'])(snippetTemplateById),\n          })),\n          pathOr([], ['setting', key])\n        )(x),\n      })),\n      keys,\n      pathOr({}, ['setting'])\n    )(x),\n  })),\n  pathOr([], [])\n)\n\nexport const setComponent = compose(\n  map((x: PhraseTemplate) => ({\n    ...x,\n    setting: compose(\n      map((s: SnippetProps) => ({\n        ...s,\n        Component: path([s.type, 'Component'])(snippetTemplateById),\n      })),\n      pathOr([], ['setting'])\n    )(x),\n  })),\n  pathOr([], [])\n)\n\nexport default snippetTemplateList\n","import { ReactText } from 'react'\n\nexport const createFormItemLayout = (label: number = 3, wrapper?: number) => ({\n  labelCol: {\n    xs: { span: label },\n    sm: { span: label },\n  },\n  wrapperCol: {\n    xs: { span: wrapper || 24 - label },\n    sm: { span: wrapper || 24 - label },\n  },\n})\n\nexport const thosandSeprartor = {\n  formatter: (value: number | string | undefined) => {\n    if (!value) {\n      return value as string\n    }\n    return `${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n  },\n  parser: (value: string | undefined) =>\n    (value ? value.replace(/\\$\\s?|(,*)/g, '') : value) as ReactText,\n}\n\nexport const currency = {\n  formatter: (value: number | string | undefined) => {\n    if (!value) {\n      return value as string\n    }\n    return `$ ${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n  },\n  parser: (value: string | undefined) =>\n    (value ? value.replace(/\\$\\s?|(,*)/g, '') : value) as ReactText,\n}\n\nexport const percent = {\n  // min: 0,\n  max: 100,\n  formatter: (value: number | string | undefined) => {\n    if (!value) {\n      return value as string\n    }\n    return `${value}%`\n  },\n  parser: (value: string | undefined) =>\n    (value ? value.replace('%', '') : value) as ReactText,\n}\n\nexport const rules = {\n  required: { required: true, message: '此欄位必填' },\n  number: {\n    required: false,\n    type: 'number',\n    message: '請填寫數字',\n    transform(value: any) {\n      if (!value) {\n        return value\n      }\n      return Number(value)\n    },\n  },\n  account: {\n    required: true,\n    message: '欄位長度為8~128字元,特殊符號-,_',\n    pattern: new RegExp(/^.{8,128}$/),\n  },\n  password: {\n    required: true,\n    message: '密碼長度為6~128字元',\n    pattern: new RegExp(/^.{6,128}$/),\n  },\n}\n","const preserveCamelCase = (string: string) => {\n  let isLastCharLower = false\n  let isLastCharUpper = false\n  let isLastLastCharUpper = false\n\n  for (let i = 0; i < string.length; i++) {\n    const character = string[i]\n\n    if (\n      isLastCharLower &&\n      /[a-zA-Z]/.test(character) &&\n      character.toUpperCase() === character\n    ) {\n      string = string.slice(0, i) + '-' + string.slice(i)\n      isLastCharLower = false\n      isLastLastCharUpper = isLastCharUpper\n      isLastCharUpper = true\n      i++\n    } else if (\n      isLastCharUpper &&\n      isLastLastCharUpper &&\n      /[a-zA-Z]/.test(character) &&\n      character.toLowerCase() === character\n    ) {\n      string = string.slice(0, i - 1) + '-' + string.slice(i - 1)\n      isLastLastCharUpper = isLastCharUpper\n      isLastCharUpper = false\n      isLastCharLower = true\n    } else {\n      isLastCharLower =\n        character.toLowerCase() === character &&\n        character.toUpperCase() !== character\n      isLastLastCharUpper = isLastCharUpper\n      isLastCharUpper =\n        character.toUpperCase() === character &&\n        character.toLowerCase() !== character\n    }\n  }\n\n  return string\n}\n\nconst camelCase = (\n  input: string | string[],\n  options: { pascalCase?: boolean } = {}\n) => {\n  if (!(typeof input === 'string' || Array.isArray(input))) {\n    throw new TypeError('Expected the input to be `string | string[]`')\n  }\n\n  options = Object.assign(\n    {\n      pascalCase: false,\n    },\n    options\n  )\n\n  const postProcess = (x: string) =>\n    options.pascalCase ? x.charAt(0).toUpperCase() + x.slice(1) : x\n\n  if (Array.isArray(input)) {\n    input = input\n      .map(x => x.trim())\n      .filter(x => x.length)\n      .join('-')\n  } else {\n    input = input.trim()\n  }\n\n  if (input.length === 0) {\n    return ''\n  }\n\n  if (input.length === 1) {\n    return options.pascalCase ? input.toUpperCase() : input.toLowerCase()\n  }\n\n  const hasUpperCase = input !== input.toLowerCase()\n\n  if (hasUpperCase) {\n    input = preserveCamelCase(input)\n  }\n\n  input = input\n    .replace(/^[_.\\- ]+/, '')\n    .toLowerCase()\n    .replace(/[_.\\- ]+(\\w|$)/g, (_, p1) => p1.toUpperCase())\n    .replace(/\\d+(\\w|$)/g, m => m.toUpperCase())\n\n  return postProcess(input)\n}\n\nexport default camelCase\n","import React from 'react'\nimport Store from 'store'\nimport { message } from 'antd'\nimport {\n  keys,\n  filter,\n  join,\n  map,\n  merge,\n  includes,\n  isNil,\n  always,\n  T,\n  path,\n  ifElse,\n  invoker,\n  identity,\n  mergeDeepRight,\n  is,\n  hasPath,\n  allPass,\n} from 'ramda'\n// import message, { error } from '@/utils/message'\nimport { MutationOptions } from '@/constants/types'\nimport envStore from '@/constants/env'\nimport camelcase from '@/utils/camelcase'\nconst { compose, cond } = require('ramda')\n\nmessage.config({ maxCount: 1 })\n\n/**\n * 替換Url中的變數，例如/v1/api/user/{id} 轉換成 /v1/api/user/5\n * @param url API Url\n * @param body Query Parameters\n */\nexport function format(url: string, params: { [key: string]: any } = {}) {\n  const regex = /(\\{.+?\\})/gi\n  const _params = { ...params }\n\n  const _url = url.replace(regex, v => {\n    const replacable = v[0] === '{'\n\n    if (!replacable) {\n      return v\n    }\n\n    const propName = v.slice(1, -1)\n    const replacedValue = _params[propName]\n\n    _params[propName] = undefined\n\n    return replacedValue\n  })\n\n  return { fullUrl: _url, params: _params }\n}\n\nexport function toQueryString(\n  paramsObject: {\n    [key: string]: any\n  } = {}\n) {\n  if (!paramsObject) {\n    return ''\n  }\n\n  return compose(\n    join('&'),\n    map((key: string) =>\n      Array.isArray(paramsObject[key])\n        ? // convert to key=val1,val2,val3 string\n          `${key}=${paramsObject[key]\n            .map((val: string | number) => `${encodeURIComponent(val)}`)\n            .join(',')}`\n        : // convert to key=val string\n          `${key}=${encodeURIComponent(paramsObject[key])}`\n    ),\n    filter(\n      (key: string) =>\n        paramsObject[key] !== '' &&\n        paramsObject[key] !== null &&\n        typeof paramsObject[key] !== 'undefined'\n    ),\n    keys\n  )(paramsObject)\n}\n\nexport interface RequestInit\n  extends Omit<MutationOptions, 'onError' | 'onCompleted' | 'refetchQueries'> {\n  body?: any\n  credentials?: RequestCredentials_\n  headers?: HeadersInit_\n  integrity?: string\n  keepalive?: boolean\n  method?: 'DELETE' | 'PUT' | 'PATCH' | 'GET' | 'POST'\n  mode?: RequestMode_\n  referrer?: string\n  window?: any\n  errorMsg?: boolean\n  throwable?: boolean\n  withToken?: boolean\n  endpoint?: 'apiBaseUrl' | 'fakeApiBaseUrl'\n  onError?: (err: Error) => any\n  onCompleted?: (data: any) => any\n}\n\nexport function useMeta() {\n  const [loading, setIsLoading] = React.useState(false)\n\n  const withMeta = React.useCallback((handler: any) => {\n    setIsLoading(true)\n\n    return handler().then((response: any) => {\n      setIsLoading(false)\n\n      return response\n    })\n  }, [])\n\n  return [loading, withMeta] as [boolean, (handler: any) => any]\n}\n\ninterface UseRequestOptions extends RequestInit {\n  lazy?: boolean\n  variables?: { [key: string]: any }\n}\n\nexport function useRequest<T = any>(\n  url: string,\n  { lazy = true, variables = {}, ..._options }: UseRequestOptions = {}\n) {\n  const called = React.useRef(false)\n\n  const [loading, withMeta] = useMeta()\n\n  const [data, setData] = React.useState<T>()\n\n  const [error, setError] = React.useState<Error>()\n\n  const _refetch = (data: { [key: string]: any } = {}) => {\n    let { fullUrl, params } = format(url, mergeDeepRight(variables, data))\n\n    if (_options.method === 'GET') {\n      fullUrl = `${fullUrl}?${toQueryString(params)}`\n    }\n\n    return withMeta(async () => {\n      const response = await request<T>(fullUrl, {\n        ..._options,\n        ...(_options.method !== 'GET' ? { body: data } : {}),\n        onCompleted: response => {\n          if (_options.onCompleted) {\n            _options.onCompleted({ data, response })\n          }\n\n          setData(response)\n        },\n        onError: error => {\n          if (_options.onError) {\n            _options.onError(error)\n          }\n\n          setError(error)\n        },\n      })\n\n      return response\n    })\n  }\n\n  React.useEffect(() => {\n    if (!lazy && !called.current) {\n      _refetch()\n\n      called.current = true\n    }\n  }, [lazy, called]) // eslint-disable-line\n\n  return {\n    loading,\n    mutate: _refetch as (\n      v?: { [key: string]: any } | { [key: string]: any }[]\n    ) => Promise<T>,\n    data,\n    error,\n    called,\n  }\n}\n\nconst contentTypeIs = (s: string) => {\n  return compose(\n    ifElse(isNil, identity, (c = '') => c.includes(s)),\n    invoker(1, 'get')('content-type'),\n    path(['headers'])\n  )\n}\n\nconst convertObjectKeys: any = (\n  object: any[] | { [key: string]: any },\n  keypath: string[] = []\n) => {\n  if (!object || typeof object !== 'object') {\n    return object\n  }\n\n  if (Array.isArray(object)) {\n    return object.map((o, index) =>\n      convertObjectKeys(o, [...keypath, String(index)])\n    )\n  }\n\n  return Object.keys(object).reduce((acc: any, key: string) => {\n    let value = object[key]\n\n    const nestedKeyPath = [...keypath, key]\n\n    acc[camelcase(key)] = convertObjectKeys(value, nestedKeyPath)\n    return acc\n  }, {})\n}\n\nexport function request<T = any>(\n  url: string,\n  {\n    body,\n    headers,\n    msg = true,\n    errorMsg = true,\n    withToken = true,\n    throwable = false,\n    successMessage,\n    onCompleted,\n    onError,\n    endpoint,\n    ...options\n  }: RequestInit = {}\n): Promise<T> {\n  const fullUrl = cond([\n    [includes('http'), always(url)],\n    [T, always(envStore.apiBaseUrl + url)],\n  ])(url)\n\n  return fetch(fullUrl, {\n    ...options,\n    body: body instanceof FormData ? body : JSON.stringify(body),\n    headers: merge(\n      {\n        ...(withToken\n          ? {\n              Authorization: `Bearer ${Store.get(\n                'sctc_token'\n              )}` as NonNullable<string>,\n            }\n          : {}),\n      },\n      headers\n        ? { ...headers }\n        : { 'Content-Type': 'application/json', Accept: 'application/json' }\n    ) as Record<string, string>,\n  })\n    .then(async (response: Response) => {\n      // if (\n      //   compose(\n      //     and(msg),\n      //     allPass([compose(not, isNil), compose(not, equals(__, 'GET'))]),\n      //     path(['method'])\n      //   )(options)\n      // ) {\n      //   message({\n      //     content: successMessage || '資料已更新成功',\n      //     type: 'success',\n      //   })\n      // }\n\n      let result: any\n\n      if (response.status === 404) {\n        return Promise.reject(response.statusText)\n      }\n\n      if (contentTypeIs('application/json')(response)) {\n        result = await response.json()\n\n        if (!response.ok) {\n          return Promise.reject(result)\n        }\n\n        result = convertObjectKeys(result)\n      }\n\n      if (contentTypeIs('sheet')(response)) {\n        result = await response.blob()\n      }\n\n      if (isNil(result)) {\n        result = await response.text()\n      }\n\n      if (onCompleted) {\n        onCompleted(result)\n      }\n\n      return result\n    })\n    .catch((err: Error) => {\n      let msg = cond([\n        [\n          allPass([\n            compose(is(String), path(['message'])),\n            hasPath(['message']),\n          ]),\n          path(['message']),\n        ],\n        [\n          allPass([\n            compose(is(String), path(['message', 'sqlMessage'])),\n            hasPath(['message', 'sqlMessage']),\n          ]),\n          path(['message', 'sqlMessage']),\n        ],\n        [is(String), identity],\n        [T, always('Server Error')],\n      ])(err)\n\n      if (errorMsg) {\n        message.error(msg)\n      }\n\n      if (onError) {\n        onError(err)\n      }\n\n      if (throwable) {\n        throw new Error(msg)\n      }\n\n      return err\n    })\n}\n\nexport default request\n","import { History, createHashHistory } from 'history'\nimport { envStore } from '@/constants/env'\n\nconst history = createHashHistory({ basename: envStore.appBaseName })\n\nexport default history as NonNullable<History>\n"],"sourceRoot":""}
{"version":3,"sources":["components/snippet-preview-modal.tsx","hooks/useModal.tsx","components/input-file-upload.js","components/import-template-modal.tsx","containers/phrase-list/phrase-list.tsx"],"names":["compose","require","SnippetPreviewWrapper","styled","div","SnippetPreviewModal","item","onCancel","useForm","form","snippetList","pathOr","visible","style","top","maskClosable","className","keyboard","width","footer","key","color","onClick","is","Array","renderSnippets","map","gt","__","length","background","theme","darkGrey","keys","useModal","content","onToggle","ownState","React","useState","editModalVisible","setEditModalVisible","setItem","findItem","useCallback","evt","find","x","path","currentTarget","dataset","handleModalToggle","prev","hasValue","has","marginRight","FileUpload","props","triggerChange","changedValue","onChange","onRemove","setState","state","fileList","customRequest","info","fileReader","FileReader","addEventListener","file","uid","uuid","name","url","result","status","readAsDataURL","value","this","accept","beforeUpload","placeholder","hasFile","readOnly","startsWith","suffix","title","type","data-uid","icon","CloseOutlined","StyledUpload","multiple","UploadOutlined","nextProps","Component","formItemLayout","createFormItemLayout","ImportTemplateModal","onOk","bodyStyle","paddingLeft","paddingRight","validateFields","then","values","a","rest","readFile","JSON","parse","hideRequiredMark","colon","Item","label","rules","required","PhraseList","useTitle","useBreadcrumb","data","usePhraseList","previewModalVisible","handlePreviewModalVisible","useReportPreview","setIsPreview","handlePreview","useVisible","importModalVisible","handleImportModalVisible","useAddNewPhrase","onCompleted","success","handleAdd","handleTo","pathname","history","push","_handleRemove","id","confirm","handleRemove","useRemovePhrase","columns","dataIndex","render","v","r","record","replace","routes","align","_","data-id","minHeight","justify","span","rowKey","dataSource"],"mappings":"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","file":"static/js/2.5e793289.chunk.js","sourcesContent":["import React from 'react'\nimport { Form } from 'antd'\nimport { ModalProps } from 'antd/lib/modal'\nimport styled from 'styled-components'\nimport { length, __, gt, keys, map, pathOr, is } from 'ramda'\nimport Modal from '@/components/modal'\nimport { ReportTemplate, PhraseTemplate, SnippetProps } from '@/constants/types'\nimport { renderSnippets } from '@/components/snippet-utils'\nimport Button from '@/components/button'\nimport theme from '../theme'\nconst { compose } = require('ramda')\n\ninterface Props extends ModalProps {\n  item?: ReportTemplate | PhraseTemplate | null\n}\n\nconst SnippetPreviewWrapper = styled.div`\n  .ant-card-head {\n    min-height: auto;\n  }\n\n  .ant-card-head-title {\n    padding-top: 0;\n  }\n\n  .ant-card-body {\n    padding-top: 12px;\n    padding-bottom: 8px;\n  }\n`\n\nexport default function SnippetPreviewModal({ item, onCancel }: Props) {\n  const [form] = Form.useForm()\n\n  const snippetList = pathOr({}, ['setting'], item)\n\n  return (\n    <Modal\n      visible\n      style={{ top: 30 }}\n      maskClosable={false}\n      className=\"ant-modal-header--border-none\"\n      keyboard={false}\n      width=\"65%\"\n      onCancel={onCancel}\n      footer={[\n        <Button key=\"btn-cancel\" color=\"outline\" onClick={onCancel}>\n          確認\n        </Button>,\n      ]}>\n      <Form form={form}>\n        <SnippetPreviewWrapper>\n          {is(Array, snippetList)\n            ? renderSnippets()(snippetList as SnippetProps[])\n            : compose(\n                map((key: string) => (\n                  <div key={key}>\n                    {compose(\n                      gt(__, 0),\n                      length,\n                      pathOr([], [key])\n                    )(snippetList) && (\n                      <h2\n                        style={{ background: theme.darkGrey, width: '50%' }}\n                        className=\"bg-darkGrey text-white pl-3 my-2\">\n                        {key}\n                      </h2>\n                    )}\n                    {compose(renderSnippets(), pathOr([], [key]))(snippetList)}\n                  </div>\n                )),\n                keys\n              )(snippetList)}\n        </SnippetPreviewWrapper>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\nimport { find, path } from 'ramda'\n\nexport default function useModal<T, TDetail = T>({\n  content,\n  key = 'id',\n  onToggle,\n  ownState,\n}: {\n  content: T[]\n  key?: string\n  ownState?: [T | null, React.Dispatch<React.SetStateAction<T | null>>]\n  onToggle?: (item: T) => any\n}) {\n  const [editModalVisible, setEditModalVisible] = React.useState(false)\n  const [item, setItem] = ownState || React.useState<T | null>(null) // eslint-disable-line\n\n  const findItem = React.useCallback(\n    (evt: React.MouseEvent<HTMLElement>) => {\n      return find(\n        x =>\n          `${path([key], x)}` ===\n          (evt.currentTarget as HTMLElement).dataset['id']\n      )(content)\n    },\n    [content, key]\n  )\n\n  const handleModalToggle = (evt?: React.MouseEvent<HTMLElement>) => {\n    if (!evt) {\n      return\n    }\n\n    const item = findItem(evt)\n\n    if (!item) {\n      setItem(null)\n    }\n\n    if (item) {\n      setItem(item as T)\n    }\n\n    if (onToggle) {\n      onToggle(item as T)\n    }\n  }\n\n  const handleEditModalVisible = (evt?: React.MouseEvent<HTMLElement>) => {\n    setEditModalVisible(prev => !prev)\n    handleModalToggle(evt)\n  }\n\n  return [\n    editModalVisible,\n    handleEditModalVisible,\n    {\n      item,\n      handleModalToggle,\n      setItem,\n    },\n  ] as [\n    boolean,\n    (evt?: React.MouseEvent<HTMLElement, MouseEvent> | undefined) => void,\n    {\n      item: T | null\n      setItem: (value: React.SetStateAction<T | null>) => void\n      handleModalToggle: (\n        evt?: React.MouseEvent<HTMLElement, MouseEvent> | undefined\n      ) => void\n      itemDetail: TDetail\n    }\n  ]\n}\n","import React from 'react'\nimport { Upload, Tooltip, Button } from 'antd'\nimport styled from 'styled-components'\nimport { CloseOutlined, UploadOutlined } from '@ant-design/icons'\nimport { has } from 'ramda'\nimport { uuid } from '@/utils/webHelper'\nimport Input from '@/components/input'\n\nconst hasValue = has('value')\n\nclass FileUpload extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      fileList: props.value ? [{ uid: uuid(), url: props.value }] : [],\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps) {\n    if (hasValue(nextProps)) {\n      // Should be a controlled component.\n      if ('value' in nextProps) {\n        return typeof nextProps.value === 'string'\n          ? { value: nextProps.value }\n          : {\n              ...(nextProps.value || {}),\n            }\n      }\n    }\n\n    return null\n  }\n\n  triggerChange = changedValue => {\n    // Should provide an event to pass value to Form.\n    const { onChange } = this.props\n    if (onChange) {\n      onChange(changedValue)\n    }\n  }\n\n  onRemove = () => {\n    this.setState(\n      state => ({\n        fileList: [],\n      }),\n      () => this.triggerChange(null)\n    )\n  }\n\n  customRequest = info => {\n    const fileReader = new FileReader()\n    fileReader.addEventListener('load', () => {\n      const file = {\n        uid: uuid(),\n        name: info.file.name,\n        url: fileReader.result,\n        status: 'done',\n        file: info.file,\n      }\n\n      this.setState(\n        state => ({ fileList: [...state.fileList, file] }),\n        () => this.triggerChange(this.state.fileList[0])\n      )\n    })\n    fileReader.readAsDataURL(info.file)\n  }\n\n  render() {\n    const {\n      props: { accept, beforeUpload, placeholder },\n      state: { fileList = [] },\n    } = this\n\n    const hasFile = fileList.length > 0\n    const [file] = fileList\n\n    return !hasFile ? (\n      <StyledUpload\n        multiple={false}\n        accept={accept}\n        fileList={fileList}\n        beforeUpload={beforeUpload}\n        onRemove={this.onRemove}\n        customRequest={this.customRequest}>\n        <Input\n          placeholder={placeholder}\n          readOnly\n          suffix={\n            <Tooltip title=\"點擊選擇上傳檔案\">\n              <Button\n                icon={<UploadOutlined />}\n                type=\"link\"\n                css={{ marginRight: -10, color: `rgb(183, 183, 183)` }}\n              />\n            </Tooltip>\n          }\n        />\n      </StyledUpload>\n    ) : (\n      <Input\n        placeholder={placeholder}\n        readOnly\n        value={file.url.startsWith('data:') ? file.name : file.url}\n        suffix={\n          <Tooltip title=\"刪除上傳檔案\">\n            <Button\n              type=\"link\"\n              css={{ marginRight: -10, color: `rgb(183, 183, 183)` }}\n              data-uid={file.uid}\n              icon={<CloseOutlined />}\n              onClick={this.onRemove}\n            />\n          </Tooltip>\n        }\n      />\n    )\n  }\n}\n\nconst StyledUpload = styled(Upload)`\n  .ant-upload {\n    width: 100%;\n  }\n\n  .ant-input-affix-wrapper {\n    padding-top: 0;\n    padding-bottom: 0;\n  }\n`\n\nexport default FileUpload\n","import React from 'react'\nimport { Form } from 'antd'\nimport { ModalProps } from 'antd/lib/modal'\nimport Modal from '@/components/modal'\nimport Button from '@/components/button'\nimport Input from '@/components/input'\nimport FileUpload from '@/components/input-file-upload'\nimport { ReportTemplate } from '@/constants/types'\nimport { rules, createFormItemLayout } from '@/utils/form'\nimport { readFile } from '@/utils/webHelper'\n\ninterface Props extends Omit<ModalProps, 'onOk'> {\n  onOk: (values: ReportTemplate) => void\n}\n\nconst formItemLayout = createFormItemLayout(4)\n\nexport default function ImportTemplateModal({\n  onCancel,\n  onOk,\n  ...props\n}: Props) {\n  const [form] = Form.useForm()\n\n  const handleOk = () => {\n    form.validateFields().then(async values => {\n      const { file, ...rest } = values\n\n      const result = await readFile<string>(file.file)\n\n      onOk({ ...JSON.parse(result), ...rest } as ReportTemplate)\n    })\n  }\n\n  return (\n    <Modal\n      {...props}\n      visible\n      title=\"匯入模版\"\n      maskClosable={false}\n      keyboard={false}\n      bodyStyle={{\n        paddingLeft: 48,\n        paddingRight: 48,\n      }}\n      width={560}\n      footer={[\n        <Button\n          key=\"btn-cancel\"\n          color=\"outline\"\n          onClick={onCancel}\n          className=\"mr-3\">\n          取消\n        </Button>,\n        <Button key=\"btn-ok\" color=\"primary\" onClick={handleOk}>\n          確認\n        </Button>,\n      ]}\n      onCancel={onCancel}>\n      <Form hideRequiredMark={false} form={form} colon={false}>\n        <Form.Item\n          {...formItemLayout}\n          label=\"選擇檔案\"\n          name=\"file\"\n          rules={[rules.required]}>\n          <FileUpload accept=\".json\" placeholder=\"選擇模版JSON檔案\" />\n        </Form.Item>\n        <Form.Item\n          {...formItemLayout}\n          label=\"名稱\"\n          name=\"name\"\n          rules={[rules.required]}>\n          <Input />\n        </Form.Item>\n        <Form.Item\n          {...formItemLayout}\n          label=\"創作者\"\n          name=\"author\"\n          rules={[rules.required]}>\n          <Input />\n        </Form.Item>\n        <Form.Item {...formItemLayout} label=\"描述\" name=\"description\">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n","import React from 'react'\nimport { replace } from 'ramda'\nimport { Row, Col, Tooltip, message } from 'antd'\nimport { ColumnProps } from 'antd/lib/table'\nimport { EyeOutlined, DeleteOutlined } from '@ant-design/icons'\nimport { Page } from '@/components/layout'\nimport Button from '@/components/button'\nimport Table from '@/components/query-table'\nimport ImportTemplateModal from '@/components/import-template-modal'\nimport SnippetPreviewModal from '@/components/snippet-preview-modal'\nimport ReactDndProvider from '@/components/snippet-scrollable-container'\nimport history from '@/utils/history'\nimport { confirm } from '@/utils/message'\nimport useTitle from '@/hooks/useTitle'\nimport useVisible from '@/hooks/useVisible'\nimport useModal from '@/hooks/useModal'\nimport { useReportPreview } from '@/data/useReportTemplate'\nimport {\n  usePhraseList,\n  useAddNewPhrase,\n  useRemovePhrase,\n} from '@/services/phrase'\nimport { PhraseTemplate, ReportTemplate } from '@/constants/types'\nimport { useBreadcrumb } from '@/hooks/useApp'\nimport * as routes from '@/constants/routes'\n\nexport default function PhraseList() {\n  useTitle('片語模版')\n\n  useBreadcrumb([{ name: '報告模版' }, { name: '片語模版' }])\n\n  const { data } = usePhraseList()\n\n  const [previewModalVisible, handlePreviewModalVisible, { item }] = useModal({\n    content: data.content,\n  })\n\n  const [, setIsPreview] = useReportPreview()\n\n  const handlePreview = (evt: React.MouseEvent<HTMLElement>) => {\n    setIsPreview()\n    handlePreviewModalVisible(evt)\n  }\n\n  const [importModalVisible, handleImportModalVisible] = useVisible()\n\n  const [, handleAdd] = useAddNewPhrase({\n    onCompleted: () => {\n      message.success('片語模版已匯入成功')\n      handleImportModalVisible()\n    },\n  })\n\n  const handleImport = (values: ReportTemplate) => {\n    handleAdd(values)\n  }\n\n  const handleTo = (pathname: string) => () => {\n    history.push(pathname)\n  }\n\n  const handleToEditPage = (record: PhraseTemplate) => () => {\n    handleTo(replace(':id', `${record.id}`)(routes.PHRASE_EDIT))()\n  }\n\n  const _handleRemove = (evt: React.MouseEvent<HTMLElement>) => {\n    let id = evt.currentTarget.dataset.id\n    confirm({\n      title: '確認要刪除嗎？',\n      onOk: () => handleRemove({ id }),\n    })\n  }\n\n  const [, handleRemove] = useRemovePhrase({\n    onCompleted: () => {\n      message.success('片語模版已刪除')\n    },\n  })\n\n  const columns: ColumnProps<PhraseTemplate>[] = [\n    {\n      title: '模版名稱',\n      dataIndex: 'name',\n      render: (v, r) => (\n        <Button type=\"link\" onClick={handleToEditPage(r)}>\n          {v}\n        </Button>\n      ),\n    },\n    {\n      title: '創作者',\n      dataIndex: 'author',\n    },\n    {\n      title: '狀態',\n      dataIndex: 'statusName',\n    },\n    {\n      title: '創作時間',\n      dataIndex: 'createdAtStr',\n    },\n    {\n      title: '上次修改時間',\n      dataIndex: 'updatedAtStr',\n    },\n    {\n      title: '模版描述',\n      dataIndex: 'description',\n    },\n    {\n      title: 'actions',\n      dataIndex: 'delete',\n      align: 'center',\n      render: (_, r) => (\n        <>\n          <Tooltip title=\"檢視\">\n            <EyeOutlined\n              data-id={r.id}\n              className=\"c-icon text-lg cursor-pointer mr-3\"\n              onClick={handlePreview}\n            />\n          </Tooltip>\n          <Tooltip title=\"刪除\">\n            <DeleteOutlined\n              data-id={r.id}\n              className=\"c-icon text-lg cursor-pointer\"\n              onClick={_handleRemove}\n            />\n          </Tooltip>\n        </>\n      ),\n    },\n  ]\n\n  return (\n    <ReactDndProvider className=\"is--preview\">\n      {previewModalVisible && (\n        <SnippetPreviewModal item={item} onCancel={handlePreview} />\n      )}\n      {importModalVisible && (\n        <ImportTemplateModal\n          onOk={handleImport}\n          onCancel={handleImportModalVisible}\n        />\n      )}\n      <Page style={{ minHeight: 'calc(100vh - 203px)' }}>\n        <Row justify=\"center\">\n          <Col span={22}>\n            <div>\n              <div className=\"flex justify-end items-center mb-4\">\n                <Button color=\"outline\" onClick={handleImportModalVisible}>\n                  匯入\n                </Button>\n                <Button\n                  color=\"outline\"\n                  className=\"ml-4\"\n                  onClick={handleTo(routes.PHRASE_CREATE)}>\n                  新增\n                </Button>\n              </div>\n            </div>\n            <Table rowKey=\"id\" columns={columns} dataSource={data} />\n          </Col>\n        </Row>\n      </Page>\n    </ReactDndProvider>\n  )\n}\n"],"sourceRoot":""}